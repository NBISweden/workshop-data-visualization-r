[
  {
    "objectID": "topics/ggplot/lab_gg1.html",
    "href": "topics/ggplot/lab_gg1.html",
    "title": "Basics in ggplot",
    "section": "",
    "text": "We will use R in this course for generating plots from different biological data that are of higher quality and standard for publications. To do this, you will brush-up your memory on some important aspects of R that are important for this course below:"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#wide-format",
    "href": "topics/ggplot/lab_gg1.html#wide-format",
    "title": "Basics in ggplot",
    "section": "1.1 Wide format",
    "text": "1.1 Wide format\nA quick preview:\nCounts Table\n\n\n\n\n\n\nSample_1\nSample_2\nSample_3\nSample_4\n\n\n\n\nENSG00000000003\n321\n303\n204\n492\n\n\nENSG00000000005\n0\n0\n0\n0\n\n\nENSG00000000419\n696\n660\n472\n951\n\n\nENSG00000000457\n59\n54\n44\n109\n\n\nENSG00000000460\n399\n405\n236\n445\n\n\nENSG00000000938\n0\n0\n0\n0\n\n\n\n\n\n\n\nAnd we usually have our metadata related to the samples in another table like below:\nMetadata Table\n\n\n\n\n\nSample_ID\nSample_Name\nTime\nReplicate\nCell\n\n\n\n\nSample_1\nt0_A\nt0\nA\nA431\n\n\nSample_2\nt0_B\nt0\nB\nA431\n\n\nSample_3\nt0_C\nt0\nC\nA431\n\n\nSample_4\nt2_A\nt2\nA\nA431\n\n\n\n\n\n\n\n\nWide format data is called “wide” because it typically has a lot of columns which stretch widely across the page or your computer screen.\nMost of us are familiar with looking at wide format data\n\nIt is convenient and we are more used to looking at data this way in our Excel sheets.\nIt often lets you see more of the data, at one time, on your screen"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#long-format",
    "href": "topics/ggplot/lab_gg1.html#long-format",
    "title": "Basics in ggplot",
    "section": "1.2 Long format",
    "text": "1.2 Long format\nBelow is glimpse how the long format of the same data look like:\n\n\n\n\n\nGene\nSamples\ncount\n\n\n\n\nENSG00000000003\nSample_1\n321\n\n\nENSG00000000005\nSample_1\n0\n\n\nENSG00000000419\nSample_1\n696\n\n\nENSG00000000457\nSample_1\n59\n\n\nENSG00000000460\nSample_1\n399\n\n\nENSG00000000938\nSample_1\n0\n\n\nENSG00000000003\nSample_2\n303\n\n\nENSG00000000005\nSample_2\n0\n\n\nENSG00000000419\nSample_2\n660\n\n\nENSG00000000457\nSample_2\n54\n\n\n\n\n\n\n\nOr to be even more complete and precise:\n\n\n\n\n\nSample_ID\nSample_Name\nTime\nReplicate\nCell\nGene\ncount\n\n\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000003\n321\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000005\n0\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000419\n696\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000457\n59\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000460\n399\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000938\n0\n\n\nSample_2\nt0_B\nt0\nB\nA431\nENSG00000000003\n303\n\n\nSample_2\nt0_B\nt0\nB\nA431\nENSG00000000005\n0\n\n\nSample_2\nt0_B\nt0\nB\nA431\nENSG00000000419\n660\n\n\nSample_2\nt0_B\nt0\nB\nA431\nENSG00000000457\n54\n\n\n\n\n\n\n\n\nLong format data is typically less familiar to most humans\n\nIt seems awfully hard to get a good look at all (or most) of it\nIt seems like it would require more storage on your hard disk\nIt seems like it would be harder to enter data in a long format"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#which-is-better",
    "href": "topics/ggplot/lab_gg1.html#which-is-better",
    "title": "Basics in ggplot",
    "section": "1.3 Which is better?",
    "text": "1.3 Which is better?\n\nWell, there are some contexts where putting things in wide format is computationally efficient because you can treat data in a matrix format and to efficient matrix calculations on it.\nHowever, adding data to wide format data sets is very hard:\n\nIt is very difficult to conceive of analytic schemes that apply generally across all wide-format data sets.\nMany tools in R want data in long format like ggplot\nThe long format for data corresponds to the relational model for storing data, which is the model used in most modern data bases like the SQL family of data base systems.\n\nA more technical treatment of wide versus long data requires some terminology:\n\nIdentifier variables are often categorical things that cross-classify observations into categories.\nMeasured variables are the names given to properties or characteristics that you can go out and measure.\nValues are the values that you measure are record for any particular measured variable.\n\nIn any particular data set, what you might want to call an Identifier variables versus a Measured variables can not always be entirely clear.\n\nOther people might choose to define things differently.\n\nHowever, to my mind, it is less important to be able to precisely recognize these three entities in every possible situation (where there might be some fuzziness about which is which)\nAnd it is more important to understand how Identifier variables, Measured variables, and Values interact and behave when we are transforming data between wide and long formats."
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#using-reshape2",
    "href": "topics/ggplot/lab_gg1.html#using-reshape2",
    "title": "Basics in ggplot",
    "section": "2.1 Using reshape2",
    "text": "2.1 Using reshape2\nBy using the melt() function from the reshape2 package we can convert the wide-formatted data into long-formatted data! Here, to combine the metadata table to the gene counts table, we will also use the merge() function like we did before!\n\nlibrary(reshape2)\ngc &lt;- read.table(\"../../data/counts_raw.txt\", header = T, row.names = 1, sep = \"\\t\")\nmd &lt;- read.table(\"../../data/metadata.csv\", header = T, sep = \";\")\nrownames(md) &lt;- md$Sample_ID\n\n#merging gene counts table with metadata\nmerged_data_wide &lt;- merge(md, t(gc), by = 0)\n#removing redundant columns\nmerged_data_wide$Row.names &lt;- NULL\n\nmerged_data_long &lt;- melt(merged_data_wide, id.vars = c(\"Sample_ID\",\"Sample_Name\",\"Time\",\"Replicate\",\"Cell\"), variable.name = \"Gene\", value.name = \"count\")  \nhead(merged_data_long)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#using-tidyr",
    "href": "topics/ggplot/lab_gg1.html#using-tidyr",
    "title": "Basics in ggplot",
    "section": "2.2 Using tidyr",
    "text": "2.2 Using tidyr\nIf you are more familiar with using tidyverse or tidyr packages, you can combine tables by join() and then use gather() to make long formatted data in the same command. This is a powerful and more cleaner way of dealing with data in R.\n\nlibrary(tidyverse)\ngc_long &lt;- gc %&gt;%\n  rownames_to_column(var = \"Gene\") %&gt;%\n  gather(Sample_ID, count, -Gene) %&gt;% \n  full_join(md, by = \"Sample_ID\") %&gt;% \n  select(Sample_ID, everything()) %&gt;% \n  select(-c(Gene,count), c(Gene,count)) \ngc_long %&gt;%\n  head(10)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#base",
    "href": "topics/ggplot/lab_gg1.html#base",
    "title": "Basics in ggplot",
    "section": "4.1 Base",
    "text": "4.1 Base\nR is an excellent tool for creating graphs and plots. The graphic capabilities and functions provided by the base R installation is called the base R graphics. Numerous packages exist to extend the functionality of base graphics.\nWe can try out plotting a few of the common plot types. Let’s start with a scatterplot. First we create a data.frame as this is the most commonly used data object.\n\ndfr &lt;- data.frame(a=sample(1:100,10),b=sample(1:100,10))\n\nNow we have a dataframe with two continuous variables that can be plotted against each other.\n\nplot(dfr$a,dfr$b)\n\n\n\n\n\n\n\n\nThis is probably the simplest and most basic plots. We can modify the x and y axis labels.\n\nplot(dfr$a,dfr$b,xlab=\"Variable a\",ylab=\"Variable b\")\n\n\n\n\n\n\n\n\nWe can change the point to a line.\n\nplot(dfr$a,dfr$b,xlab=\"Variable a\",ylab=\"Variable b\",type=\"b\")\n\n\n\n\n\n\n\n\nLet’s add a categorical column to our dataframe.\n\ndfr$cat &lt;- rep(c(\"C1\",\"C2\"),each=5)\n\nAnd then colour the points by category.\n\n# subset data\ndfr_c1 &lt;- subset(dfr,dfr$cat == \"C1\")\ndfr_c2 &lt;- subset(dfr,dfr$cat == \"C2\")\n\nplot(dfr_c1$a,dfr_c1$b,xlab=\"Variable a\",ylab=\"Variable b\",col=\"red\",pch=1)\npoints(dfr_c2$a,dfr_c2$b,col=\"blue\",pch=2)\n\nlegend(x=\"topright\",legend=c(\"C1\",\"C2\"),\n       col=c(\"red\",\"blue\"),pch=c(1,2))\n\n\n\n\n\n\n\n\nLet’s create a barplot.\n\nldr &lt;- data.frame(a=letters[1:10],b=sample(1:50,10))\nbarplot(ldr$b,names.arg=ldr$a)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#grid",
    "href": "topics/ggplot/lab_gg1.html#grid",
    "title": "Basics in ggplot",
    "section": "4.2 Grid",
    "text": "4.2 Grid\nGrid graphics have a completely different underlying framework compared to base graphics. Generally, base graphics and grid graphics cannot be plotted together. The most popular grid-graphics based plotting library is ggplot2.\nLet’s create the same plot as before using ggplot2. Make sure you have the package installed.\n\nlibrary(ggplot2)\n\nggplot(dfr)+\n  geom_point(mapping = aes(x=a,y=b,colour=cat))+\n  labs(x=\"Variable a\",y=\"Variable b\")\n\n\n\n\n\n\n\n\nIt is generally easier and more consistent to create plots using the ggplot2 package compared to the base graphics.\nLet’s create a barplot as well.\n\nggplot(ldr,aes(x=a,y=b))+\n  geom_col()"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#saving-images",
    "href": "topics/ggplot/lab_gg1.html#saving-images",
    "title": "Basics in ggplot",
    "section": "4.3 Saving images",
    "text": "4.3 Saving images\nLet’s take a look at saving plots.\n\n\n\n\n\n\nNote\n\n\n\nThis part is just to give you a quick look into how you can save images from R terminal quickly. The different format of images will be explained in a lecture later.\n\n\n\n4.3.1 Base graphics\nThe general idea for saving plots is open a graphics device, create the plot and then close the device. We will use png here. Check out ?png for the arguments and other devices.\n\ndfr &lt;- data.frame(a=sample(1:100,10),b=sample(1:100,10))\n\npng(filename=\"plot-base.png\")\nplot(dfr$a,dfr$b)\ndev.off()\n\n\n\n4.3.2 ggplot2\nThe same idea can be applied to ggplot2, but in a slightly different way. First save the file to a variable, and then export the plot.\n\np &lt;- ggplot(dfr,aes(a,b)) + geom_point()\n\npng(filename=\"plot-ggplot-1.png\")\nprint(p)\ndev.off()\n\n\n\n\n\n\n\nTip\n\n\n\nggplot2 also has another easier helper function to export images.\n\nggsave(filename=\"plot-ggplot-2.png\",plot=p)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#geoms",
    "href": "topics/ggplot/lab_gg1.html#geoms",
    "title": "Basics in ggplot",
    "section": "5.1 Geoms",
    "text": "5.1 Geoms\nIn the previous section we saw very quickly how to use ggplot. Let’s take a look at it again a bit more carefully. For this let’s first look into a simple data that is available in R. We use the iris data for this to start with.\nThis dataset has four continuous variables and one categorical variable. It is important to remember about the data type when plotting graphs\n\ndata(\"iris\")\nhead(iris)\n\n\n  \n\n\n\nWhen we initiate the ggplot object using the data, it just creates a blank plot!\n\nggplot(iris) \n\n\n\n\n\n\n\n\nNow we can specify what we want on the x and y axes using aesthetic mapping. And we specify the geometric using geoms.\n\n\n\n\n\n\nNote\n\n\n\nthat the variable names do not have double quotes \"\" like in base plots.\n\n\n\nggplot(data=iris)+\n  geom_point(mapping=aes(x=Petal.Length,y=Petal.Width))\n\n\n\n\n\n\n\n\n\n5.1.1 Multiple geoms\nFurther geoms can be added. For example let’s add a regression line. When multiple geoms with the same aesthetics are used, they can be specified as a common mapping.\n\n\n\n\n\n\nNote\n\n\n\nthat the order in which geoms are plotted depends on the order in which the geoms are supplied in the code. In the code below, the points are plotted first and then the regression line.\n\n\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point()+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\nThere are many other geoms and you can find most of them here in this cheatsheet\n\n\n5.1.2 Gene counts data\nLet’s also try to use ggplot for a “more common” gene counts dataset. Let’s use the merged_data_long or the gc_long object we created in the earlier session.\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count +1)))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nYou can notice that the ggplot sorts the factors or variables alpha-numerically, like in the case above with Sample_Name.\n\n\n\n\n\n\n\n\nTip\n\n\n\nThere is a trick that you can use to give the order of variables manually. The example is shown below:\n\ngc_long$Sample_Name &lt;- factor(gc_long$Sample_Name, levels = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1)))"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#colors",
    "href": "topics/ggplot/lab_gg1.html#colors",
    "title": "Basics in ggplot",
    "section": "5.2 Colors",
    "text": "5.2 Colors\n\n5.2.1 Iris data\nFirst, if we look at the iris data, we can use the categorical column Species to color the points. The color aesthetic is used by geom_point and geom_smooth. Three different regression lines are now drawn. Notice that a legend is automatically created\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width,color=Species))+\n  geom_point()+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\nIf we wanted to keep a common regression line while keeping the colors for the points, we could specify color aesthetic only for geom_point.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\n\n\n5.2.2 GC data\nSimilarly, we can do the same with the gene counts data.\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), color = Time))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nWe can also use the fill aesthetic to give it a better look.\n\n\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), fill = Time))\n\n\n\n\n\n\n\n\n\n\n5.2.3 Discrete colors\nWe can change the default colors by specifying new values inside a scale.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  geom_smooth(method=\"lm\")+\n  scale_color_manual(values=c(\"red\",\"blue\",\"green\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nTo specify manual colors, you could specify by their names or their hexadecimal codes. For example, you can choose the colors based on names from an online source like in this cheatsheet or you can use the hexadecimal code and choose it from a source like here. I personally prefer the hexa based options for manual colors.\n\n\n\n\n5.2.4 Continuous colors\nWe can also map the colors to a continuous variable. This creates a color bar legend item.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Sepal.Width))+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nHere, you can also choose different palettes for choosing the right continuous palette. There are some common packages of palettes that are used very often. RColorBrewer and wesanderson, if you are a fan of his choice of colors. 😉\n\n\n\nlibrary(wesanderson)\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Sepal.Width))+\n  geom_smooth(method=\"lm\") +\n  scale_color_gradientn(colours = wes_palette(\"Moonrise3\"))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nYou can also use simple R base color palettes like rainbow() or terrain.colors(). Use ? and look at these functions to see, how to use them."
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#aesthetics",
    "href": "topics/ggplot/lab_gg1.html#aesthetics",
    "title": "Basics in ggplot",
    "section": "5.3 Aesthetics",
    "text": "5.3 Aesthetics\n\n5.3.1 Aesthetic parameter\nWe can change the size of all points by a fixed amount by specifying size outside the aesthetic parameter.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species),size=3)+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\n\n\n5.3.2 Aesthetic mapping\nWe can map another variable as size of the points. This is done by specifying size inside the aesthetic mapping. Now the size of the points denote Sepal.Width. A new legend group is created to show this new aesthetic.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species,size=Sepal.Width))+\n  geom_smooth(method=\"lm\")"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#density",
    "href": "topics/ggplot/lab_gg1.html#density",
    "title": "Basics in ggplot",
    "section": "6.1 Density",
    "text": "6.1 Density\nLet’s look at the sample plot in density.\n\nggplot(data=iris,mapping=aes(x=Sepal.Length))+\n  geom_density()\n\n\n\n\n\n\n\n\nThe above plot is not very informative, let’s see how the different species contribute:\n\nggplot(data=iris,mapping=aes(x=Sepal.Length))+\n  geom_density(aes(fill = Species), alpha = 0.8)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe alpha option inside geom_density controls the transparency of the plot."
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#with-wrap",
    "href": "topics/ggplot/lab_gg1.html#with-wrap",
    "title": "Basics in ggplot",
    "section": "8.1 With wrap",
    "text": "8.1 With wrap\nWe can create subplots using the faceting functionality.\n\nplot &lt;- ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Sepal.Width))+\n  geom_smooth(method=\"lm\") + \n  facet_wrap(~Species)\nplot\n\n\n\n\n\n\n\n\nIf we try the same with the gene counts data faceted by time.\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), color = Time)) +\n  facet_wrap(~Time)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#with-grid",
    "href": "topics/ggplot/lab_gg1.html#with-grid",
    "title": "Basics in ggplot",
    "section": "8.2 With grid",
    "text": "8.2 With grid\nHere in the above plot, you see some empty samples in each facet. In this case, you could use facet_grid together with space and scales options to make it look neat and intuitive. You can use ?facet_grid and ?facet_wrap to figure out the exact difference between the two.\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), color = Time)) +\n  facet_grid(~Time , scales = \"free\", space = \"free\")\n\n\n\n\n\n\n\n\nYou can also make grid with different variables one might have using vars() function together with rows and cols options!\n\nggplot(data = gc_long) +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), color = Time)) +\n  facet_grid(rows = vars(Time), cols = vars(Replicate), scales = \"free\", space = \"free\")"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#labels",
    "href": "topics/ggplot/lab_gg1.html#labels",
    "title": "Basics in ggplot",
    "section": "9.1 Labels",
    "text": "9.1 Labels\nHere, we will quickly mention, how one can add labels to the plots. Items on the plot can be labelled using the geom_text or geom_label geoms.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  geom_text(aes(label=Species,hjust=0),nudge_x=0.5,size=3)\n\n\n\n\n\n\n\n\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  geom_label(aes(label=Species,hjust=0),nudge_x=0.5,size=3)\n\n\n\n\n\n\n\n\nThe R package ggrepel allows for non-overlapping labels.\n\nlibrary(ggrepel)\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  geom_text_repel(aes(label=Species),size=3)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#annotations",
    "href": "topics/ggplot/lab_gg1.html#annotations",
    "title": "Basics in ggplot",
    "section": "9.2 Annotations",
    "text": "9.2 Annotations\nCustom annotations of any geom can be added arbitrarily anywhere on the plot.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species))+\n  annotate(\"text\",x=2.5,y=2.1,label=\"There is a random line here\")+\n  annotate(\"segment\",x=2,xend=4,y=1.5,yend=2)"
  },
  {
    "objectID": "topics/ggplot/lab_gg1.html#flip-coordinates",
    "href": "topics/ggplot/lab_gg1.html#flip-coordinates",
    "title": "Basics in ggplot",
    "section": "10.1 Flip coordinates",
    "text": "10.1 Flip coordinates\nOne can also easily just flip the x and y axis.\n\ngc_long %&gt;% \n  group_by(Time) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%\n  ggplot(aes(x=Time, y=mean)) + \n  geom_col() +\n  coord_flip()"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html",
    "href": "topics/ggplot/lab_sc.html",
    "title": "Single-cell Visualizations",
    "section": "",
    "text": "The visualization tutorial here is inspired from the NBIS workshop on Single-cell RNA-seq Analysis. The visualization tutorial here are part of the single-cell workshop as well."
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#plot-qc",
    "href": "topics/ggplot/lab_sc.html#plot-qc",
    "title": "Single-cell Visualizations",
    "section": "2.1 Plot QC",
    "text": "2.1 Plot QC\nTo plot the raw QC of the dataset, we will use the function VlnPlot(). This is a function from the Seurat package and it basically generates a ggplot2 object from the Seurat object. Violin plots are a different way of looking at boxplot.\n\nfeats &lt;- c(\"nFeature_RNA\", \"nCount_RNA\", \"percent_mito\", \"percent_ribo\", \"percent_hb\", \"percent_plat\")\nVlnPlot(covid_raw, group.by = \"orig.ident\", split.by = \"type\", features = feats, pt.size = 0.1, ncol = 3)\n\n\nAs you can see, there is quite some difference in quality for these samples, with for instance the covid_15 and covid_16 samples having cells with fewer detected genes and more mitochondrial content. As the ribosomal proteins are highly expressed they will make up a larger proportion of the transcriptional landscape when fewer of the lowly expressed genes are detected. We can also plot the different QC-measures as scatter plots.\n\nFeatureScatter(covid_raw, \"nCount_RNA\", \"nFeature_RNA\", group.by = \"orig.ident\", pt.size = .5)"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#plot-genes",
    "href": "topics/ggplot/lab_sc.html#plot-genes",
    "title": "Single-cell Visualizations",
    "section": "2.2 Plot Genes",
    "text": "2.2 Plot Genes\nExtremely high number of detected genes could indicate doublets. However, depending on the cell type composition in your sample, you may have cells with higher number of genes (and also higher counts) from one cell type. Additionally, we can also see which genes contribute the most to such reads. We can for instance plot the percentage of counts per gene.\n\n# Compute the proportion of counts of each gene per cell\n# Use sparse matrix operations, if your dataset is large, doing matrix divisions the regular way will take a very long time.\n\nC &lt;- covid_raw[[\"RNA\"]]$counts\nC@x &lt;- C@x / rep.int(colSums(C), diff(C@p)) * 100\nmost_expressed &lt;- order(Matrix::rowSums(C), decreasing = T)[20:1]\n\nmost_exp_long &lt;- as.data.frame(t(C[most_expressed, ])) %&gt;%\n    rownames_to_column(var = \"Cell\") %&gt;%\n    gather(Gene, count, -Cell)\n\nggplot(most_exp_long) +\n    geom_boxplot(aes(factor(Gene, levels = row.names(C[most_expressed, ])), count, fill = factor(Gene, levels = row.names(C[most_expressed, ])))) +\n    coord_flip() +\n    ylab(\"Percent counts per cell\") +\n    xlab((\"\")) +\n    theme_classic() +\n    theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe above plot and the code for the plot is very loaded. It is advised to go through them a bit carefully.\n\n\nAs you can see from the plot, the genes like MALAT1, the haemoglobin gene HBB and HBA2 and the several mitochondrial genes MT- are technical artifacts that needs to be removed."
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#sample-sex",
    "href": "topics/ggplot/lab_sc.html#sample-sex",
    "title": "Single-cell Visualizations",
    "section": "3.1 Sample Sex",
    "text": "3.1 Sample Sex\nWhen working with human or animal samples, you should ideally constrain your experiments to a single sex to avoid including sex bias in the conclusions. However this may not always be possible. By looking at reads from chromosomeY (males) and XIST (X-inactive specific transcript) expression (mainly female) it is quite easy to determine per sample which sex it is. It can also be a good way to detect if there has been any mislabelling in which case, the sample metadata sex does not agree with the computational predictions.\nFor your convenience, the percentage of ChrY genes were calculated in each cell. These are present in the covid_final object. We can sanity check our samples by plotting both scatter plots and violin plots.\n\nFeatureScatter(covid_final, feature1 = \"XIST\", feature2 = \"pct_chrY\", group.by = \"orig.ident\", pt.size = .5)\n\n\nAs you can see, the samples are clearly on either side, even if some cells do not have detection of either. Now let us plot this as violins to see which exact patients are Male and Female.\n\nVlnPlot(covid_final, group.by = \"orig.ident\", split.by = \"type\", features = c(\"XIST\", \"pct_chrY\"))\n\n\nYou can clearly tell from the above image that the samples covid_1, covid_17 and ctrl_19 are Male and the rest are Female. ## Cell cycle state\nThe cell cycle state of each was determined using CellCycleScoring() function. Cell cycle scoring adds three slots in the metadata, a score for S phase, a score for G2M phase and the predicted cell cycle phase.\n\nVlnPlot(covid_final, features = c(\"S.Score\", \"G2M.Score\"), group.by = \"orig.ident\", ncol = 2, pt.size = .1)\n\n\nIn this case it looks like we only have a few cycling cells in these datasets. We can also use the scatter plot and the prediction cell cycle phase.\n\nFeatureScatter(covid_final, \"S.Score\", \"G2M.Score\", group.by = \"Phase\")\n\n\nThese are all the QC checks one usually does on a single-cell analysis. Now, let us also compare the number of cells present from each patient\n\n&gt; table(covid_raw$orig.ident)\n\n covid_1 covid_15 covid_16 covid_17  ctrl_13  ctrl_14  ctrl_19   ctrl_5 \n    1500     1500     1500     1500     1500     1500     1500     1500 \n\n&gt; table(covid_final$orig.ident)\n\n covid_1 covid_15 covid_16 covid_17  ctrl_13  ctrl_14  ctrl_19   ctrl_5 \n     875      549      357     1057     1126      996     1141     1033"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#pca",
    "href": "topics/ggplot/lab_sc.html#pca",
    "title": "Single-cell Visualizations",
    "section": "4.1 PCA",
    "text": "4.1 PCA\nNow let us look into plotting PCA plots of this expression data. The object covid_final already has the data scaled with Z-score normalization in combination with regression to remove any unwanted sources of variation from the dataset, such as cell cycle, sequencing depth, percent mitochondria etc. PCA object was generated and stored in covid_final using the function RunPCA(). Below is how you would visualize the plots, for the sake of comparisons, 3 different PCA plots with the first six components are plotted:\n\nwrap_plots(\n    DimPlot(covid_final, reduction = \"pca\", group.by = \"orig.ident\", dims = 1:2),\n    DimPlot(covid_final, reduction = \"pca\", group.by = \"orig.ident\", dims = 3:4),\n    DimPlot(covid_final, reduction = \"pca\", group.by = \"orig.ident\", dims = 5:6),\n    ncol = 3\n) + plot_layout(guides = \"collect\")\n\n\nTo identify which genes (Seurat) contribute the most to each PC, one can retrieve the loading matrix information.\n\nVizDimLoadings(covid_final, dims = 1:5, reduction = \"pca\", ncol = 5, balanced = T)\n\n\nWith the scater package we can check how different metadata variables contribute to each PCs. This can be important to look at to understand different biases you may have in your data.\n\n\n\n\n\n\nWarning\n\n\n\nUnfortunately we don’t have this package included in the list of R packages to be installed for this course. But, if you would really like to try, you can try to install it and run the following command. The example plot from the code is shown below.\n\nscater::plotExplanatoryPCs(as.SingleCellExperiment(covid_final), nvars_to_plot = 15, npcs_to_plot = 20)"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#tsne",
    "href": "topics/ggplot/lab_sc.html#tsne",
    "title": "Single-cell Visualizations",
    "section": "4.2 tSNE",
    "text": "4.2 tSNE\ntSNE is one of the main dimentionality reduction methods (non-linear) used for single-cell data and it is generated by using RunTSNE() function on the seurat object. We plot the tSNE scatterplot colored by dataset. We can clearly see the effect of batches present in the dataset.\n\nDimPlot(covid_final, reduction = \"tsne\", group.by = \"orig.ident\")"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#umap",
    "href": "topics/ggplot/lab_sc.html#umap",
    "title": "Single-cell Visualizations",
    "section": "4.3 UMAP",
    "text": "4.3 UMAP\nSimilar to tSNE, UMAP is an another well-known dimentionality reduction methods used with single-cell data. This is generated with the function RunUMAP(). Both tSNE and UMAP are usually generated from the PCA components. By default, RunUMAP only generates 2 UMAP components, but you can change this with the parameter n.components to have more more UMAP components.\ncovid_final has the following reductions stored in the object: - pca: PCA with 50 components built on scaled counts data - umap: UMAP with 2 components built on 30 PCA components - tsne: tSNE with 2 components built on 30 PCA components - UMAP10_on_PCA: UMAP with 10 components built on 30 PCA components - UMAP_on_ScaleData: UMAP with 2 components built on scaled counts data\n\nwrap_plots(\n    DimPlot(covid_final, reduction = \"umap\", group.by = \"orig.ident\") + ggplot2::ggtitle(label = \"UMAP_on_PCA\"),\n    DimPlot(covid_final, reduction = \"UMAP10_on_PCA\", group.by = \"orig.ident\", dims = 1:2) + ggplot2::ggtitle(label = \"UMAP10_on_PCA\"),\n    DimPlot(covid_final, reduction = \"UMAP10_on_PCA\", group.by = \"orig.ident\", dims = 3:4) + ggplot2::ggtitle(label = \"UMAP10_on_PCA\"),\n    ncol = 3\n) + plot_layout(guides = \"collect\")\n\n\nThe above UMAP plots are colored per dataset. Although less distinct as in the tSNE, we still see quite an effect of the different batches in the data.\nWe can now plot PCA, UMAP and tSNE side by side for comparison.\n\nwrap_plots(\n    DimPlot(covid_final, reduction = \"pca\", group.by = \"orig.ident\") + ggplot2::ggtitle(label = \"PCA\"),\n    DimPlot(covid_final, reduction = \"tsne\", group.by = \"orig.ident\") + ggplot2::ggtitle(label = \"tSNE\"),\n    DimPlot(covid_final, reduction = \"umap\", group.by = \"orig.ident\") + ggplot2::ggtitle(label = \"UMAP\"),\n    ncol = 3\n) + plot_layout(guides = \"collect\")"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#features-on-dimplot",
    "href": "topics/ggplot/lab_sc.html#features-on-dimplot",
    "title": "Single-cell Visualizations",
    "section": "4.4 Features on DimPlot",
    "text": "4.4 Features on DimPlot\nIt is possible to plot gene counts for different cell types onto the DimPlot embedding. Let us plot some marker genes.\n\nmyfeatures &lt;- c(\"CD3E\", \"CD4\", \"CD8A\", \"NKG7\", \"GNLY\", \"MS4A1\", \"CD14\", \"LYZ\", \"MS4A7\", \"FCGR3A\", \"CST3\", \"FCER1A\")\nFeaturePlot(covid_final, reduction = \"umap\", dims = 1:2, features = myfeatures, ncol = 4, order = T)\n\n\nSimilarly we can also plot metadata varibales onto the DimPlot embedding as well.\n\nmyfeatures &lt;- c(\"nCount_RNA\",\"nFeature_RNA\", \"percent_mito\",\"percent_ribo\",\"percent_hb\",\"percent_plat\")\nFeaturePlot(covid_final, reduction = \"umap\", dims = 1:2, features = myfeatures, ncol = 3, order = T)"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#across-clusters",
    "href": "topics/ggplot/lab_sc.html#across-clusters",
    "title": "Single-cell Visualizations",
    "section": "6.1 Across clusters",
    "text": "6.1 Across clusters\nWe will start with running a differential expression analysis between the different clusters. We will use the RNA_snn_res.0.5 clusters as an example for this.\n\nsel.clust &lt;- \"RNA_snn_res.0.5\"\n\ncovid_final &lt;- SetIdent(covid_final, value = sel.clust)\ntable(covid_final@active.ident)\n\n   0    1    2    3    4    5    6    7    8    9   10 \n1283 1028 1012  926  858  511  353  343  339  333  148 \nWe have 11 clusters in total and we will run the DGE analysis with the function FindAllMarkers from seurat that will run each of the clusters vs the rest. As you can see, there are some filtering criteria to remove genes that do not have certain log2FC or percent expressed. Here we only test for upregulated genes, so the only.pos parameter is set to TRUE.\n\nmarkers_genes &lt;- FindAllMarkers(\n    covid_final,\n    logfc.threshold = 0.2,\n    test.use = \"wilcox\",\n    min.pct = 0.1,\n    min.diff.pct = 0.2,\n    only.pos = TRUE,\n    max.cells.per.ident = 50,\n    assay = \"RNA\"\n)\n\nWe can now select the top 25 overexpressed genes for plotting.\n\ntop25 &lt;- markers_genes %&gt;%\n    group_by(cluster) %&gt;%\n    top_n(-25, p_val_adj) %&gt;% \n    # In case of tied p-values, further select the top 25 genes by fold-change\n    top_n(25, avg_log2FC)\n\nhead(top25)\n\n# A tibble: 6 × 7\n# Groups:   cluster [1]\n     p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene \n     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   &lt;chr&gt;\n1 7.33e-16       3.83 0.979 0.169  1.38e-11 0       GZMB \n2 9.57e-16       3.47 0.942 0.142  1.80e-11 0       KLRD1\n3 2.32e-15       3.00 0.994 0.297  4.37e-11 0       CST7 \n4 3.58e-15       3.05 1     0.397  6.75e-11 0       NKG7 \n5 5.54e-15       3.65 0.95  0.22   1.04e-10 0       GNLY \n6 7.96e-15       3.22 0.956 0.251  1.50e-10 0       CD247\n\n\n\n\n\n\nWarning\n\n\n\nThe plot below is not a ggplot but a basic plot. This is an example how to sometimes utilize a base plot to make elegant plots\n\n\n\npar(mfrow = c(2, 6), mar = c(4, 6, 3, 1))\nfor (i in unique(top25$cluster)) {\n    barplot(sort(setNames(top25$avg_log2FC, top25$gene)[top25$cluster == i], F),\n        horiz = T, las = 1, main = paste0(i, \" vs. rest\"), border = \"white\", yaxs = \"i\"\n    )\n    abline(v = c(0, 0.25), lty = c(1, 2))\n}\n\n\nWe can visualize them as a heatmap. Here we are selecting the top 5.\n\nmarkers_genes %&gt;%\n    group_by(cluster) %&gt;%\n    slice_min(p_val_adj, n = 5, with_ties = FALSE) -&gt; top5\n# create a scale.data slot for the selected genes\ncovid_final &lt;- ScaleData(covid_final, features = as.character(unique(top5$gene)), assay = \"RNA\")\nDoHeatmap(covid_final, features = as.character(unique(top5$gene)), group.by = sel.clust, assay = \"RNA\")\n\n\nAnother way is by representing the overall group expression and detection rates in a dot-plot.\n\nDotPlot(covid_final, features = rev(as.character(unique(top5$gene))), group.by = sel.clust, assay = \"RNA\") + coord_flip()\n\n\nWe can also plot a violin plot for each gene.\n\n# take top 3 genes per cluster/\ntop5 %&gt;%\n    group_by(cluster) %&gt;%\n    top_n(-3, p_val) -&gt; top3\n\n# set pt.size to zero if you do not want all the points to hide the violin shapes, or to a small value like 0.1\nVlnPlot(covid_final, features = as.character(unique(top3$gene)), ncol = 5, group.by = sel.clust, assay = \"RNA\", pt.size = 0)"
  },
  {
    "objectID": "topics/ggplot/lab_sc.html#covid-vs-ctrl",
    "href": "topics/ggplot/lab_sc.html#covid-vs-ctrl",
    "title": "Single-cell Visualizations",
    "section": "6.2 Covid vs Ctrl",
    "text": "6.2 Covid vs Ctrl\nNow, let us assume that you are interested in finding the differentially expressed genes between the patients with Covid vs the Control. We will take here the cluster 2 as it has a good representation of the patients from both conditions. So, we could specifically run the DGE within that cluster like below:\n\n# select all cells in cluster 2\ncell_selection &lt;- subset(covid_final, cells = colnames(covid_final)[covid_final@meta.data[, sel.clust] == 2])\ncell_selection &lt;- SetIdent(cell_selection, value = \"type\")\n# Compute differentiall expression\nDGE_cell_selection &lt;- FindAllMarkers(cell_selection,\n    logfc.threshold = 0.2,\n    test.use = \"wilcox\",\n    min.pct = 0.1,\n    min.diff.pct = 0.2,\n    only.pos = TRUE,\n    max.cells.per.ident = 50,\n    assay = \"RNA\"\n)\n\nWe can now plot the expression across the type\n\nDGE_cell_selection %&gt;%\n    group_by(cluster) %&gt;%\n    top_n(-5, p_val) -&gt; top5_cell_selection\nVlnPlot(cell_selection, features = as.character(unique(top5_cell_selection$gene)), ncol = 5, group.by = \"type\", assay = \"RNA\", pt.size = .1)\n\n\nWe can also plot these genes across all clusters, but split by type, to check if the genes are also over/under expressed in other celltypes/clusters.\n\nVlnPlot(covid_final,\n    features = as.character(unique(top5_cell_selection$gene)),\n    ncol = 4, split.by = \"type\", assay = \"RNA\", pt.size = 0, split.plot = TRUE\n)"
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html",
    "title": "Dynamic plotting",
    "section": "",
    "text": "Note\n\n\n\nIn these exercises you will learn how to embed dynamic components, such as interactive plots and widgets, directly into a Quarto HTML document.\nBy the end of this exercise, you will be able to:\n\nEmbed dynamic plots directly into Quarto documents.\nDiscover and apply different techniques for creating and improving dynamic visualizations."
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise",
    "title": "Dynamic plotting",
    "section": "2.1 Exercise:",
    "text": "2.1 Exercise:\nIn the palmerpenguins data, penguins are found on three islands: Biscoe, Dream and Torgersen.\nisland_coordinates &lt;- data.frame(lng = c(-66.7305, -64.2352, -64.0835),\n                                lat = c(-66.1859, -64.7269, -64.7663))\n\nYour goal is to generate dynamic map using the leaflet.\n\nAdvice: Start building dynamic map step-by-step, run code after each step and pay attention to what is happening. To get help with some functions, click here.\n\nMake a marker for three islands.\nAdd popup information (Biscoe, Dream and Torgersen island).\nUse setView() function to set a center point and a zoom level.\nChange the marker style to circle markers, and add color.\nReplace addTiles() function with addProviderTiles(providers$Esri.WorldImagery), which allows to visualize the map with real images."
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-1",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-1",
    "title": "Dynamic plotting",
    "section": "3.1 Exercise:",
    "text": "3.1 Exercise:\n\nIn this exercise you will use msleep dataset that is part of ggplot2() package.\nFirst check the dataset and familiarise yourself with data structure.\nExplore the relationship between REM sleep and total sleep across different dietary categories of mammals. To visualise this, use a scatter plot within plot_ly and test different mode arguments.\nNext, plot the number of mammalian in each diet (vore variable) group using the plot_ly() and add_histogram() functions.\nThen, generate boxplot using the plot_ly() function where you show total amount of sleep and diet. Add color to each boxplot.\nCombine both plots using the subplot function. Polish the combined figure, i.e. label axis, adjust box color, adjust legend…"
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-2",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-2",
    "title": "Dynamic plotting",
    "section": "4.1 Exercise:",
    "text": "4.1 Exercise:\n\nYou will now try to use geom_boxplot_interactive() function using the msleep dataset you already worked with.\nCreate a boxplot to visualize the total amount of total sleep across different diets, similar to the plotly example above. Enhance the plot’s appearance by applying techniques and options covered in the ggplot tutorial, such as custom color palettes, axis labels, and themes."
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-3",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-3",
    "title": "Dynamic plotting",
    "section": "5.1 Exercise:",
    "text": "5.1 Exercise:\n\nTo test DT package you will use files counts_raw.txt and metadata.csv.\nRead-in these two files, if not sure how, go back to the material from Day 1.\nDisplays the first 10 rows of counts_raw.txt and metadata.csv. Once tables are rendered and displayed play around with the search box and clickable sorting arrows.\nAdd captions to both tables.\nIn the metadata.csv order column Replicate by descending order.\nFinally, in the counts_raw.txt for Sample_1 background use bar graph using styleColorBar(). For Sample_3 use styleInterval() and color foreground and background, decide on the interval size yourself."
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-4",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-4",
    "title": "Dynamic plotting",
    "section": "6.1 Exercise:",
    "text": "6.1 Exercise:\n\nStart by creating a SharedData object using the SharedData$new() function from the crosstalk package. Use the msleep dataset as input.\nCreate a scatter plot using ggplot2 with the SharedData object. Map sleep_rem to the x-axis, sleep_total to the y-axis, and vore to the color aesthetic.\nConvert the ggplot object to obtain plotly plot.\nUse crosstalk filters to add dynamic applications. Add a checkbox filter for the vore variable, a slider filter for sleep_total, and a select filter for conservation.\nCombine the filters and the plotly plot into a single layout using the bscols() function. Specify the widths for the filters and the plot."
  },
  {
    "objectID": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-5",
    "href": "topics/dynamic_plotting/lab_dynamic_plot1.html#exercise-5",
    "title": "Dynamic plotting",
    "section": "7.1 Exercise:",
    "text": "7.1 Exercise:\nFor this exercise is recommended to create a new Quarto (.qmd) notebook. You will work with msleep dataset, and your goal is to generate a scatter plot that shows the relationship between mammalian REM and total sleep where diet (vore variable) is used as the input to filter the dataset.\n\nPrepare data in R and pass it to OJS using ojs_define. Transpose JS object.\nDisplay the raw dataset in a table using Inputs.table for better data exploration.\nCreate input using the Inputs.checkbox for vore variable, to allow dynamic filtering of the dataset.\nFilter the dataset based on user input using JavaScript’s filter function.\nVisualize the filtered data using Observable Plot. Use Plot.dot() to create scatterplot."
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#contents",
    "href": "topics/Shiny/slide_shiny3.html#contents",
    "title": "R Shiny - Part III",
    "section": "Contents",
    "text": "Contents\n\nModules\nDebugging\nThemes\nDeployment\nInteractive documents"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#modules",
    "href": "topics/Shiny/slide_shiny3.html#modules",
    "title": "R Shiny - Part III",
    "section": "Modules",
    "text": "Modules\n\nParts of an app can be modularized and reused like mini apps\nThey can be used where needed like functions\nModules have their own namespace\nA module has a UI part and a server part\nDefine namespace using NS()\nModules can be nested"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#modules-1",
    "href": "topics/Shiny/slide_shiny3.html#modules-1",
    "title": "R Shiny - Part III",
    "section": "Modules",
    "text": "Modules\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\ncounter_ui &lt;- function(id) {\n  ns &lt;- NS(id)\n  div(\n    actionButton(ns(\"btn\"), label = \"Counter\"),\n    textOutput(ns(\"txt\"))\n  )\n}\n\ncounter_server &lt;- function(id) {\n  moduleServer(id, function(input, output, session) {\n    count &lt;- reactiveVal(0)\n    output$txt &lt;- renderText({\n      count(count() + 1)\n      paste0(\"Counter \", id, \":\", count())\n    }) |&gt; bindEvent(input$btn)\n  })\n}\n\nshinyApp(\n  ui = fluidPage(\n    counter_ui(id = \"1\"),\n    counter_ui(id = \"2\")\n  ),\n\n  server = function(input, output, session) {\n    counter_server(\"1\")\n    counter_server(\"2\")\n  }\n)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#debugging-optimizing",
    "href": "topics/Shiny/slide_shiny3.html#debugging-optimizing",
    "title": "R Shiny - Part III",
    "section": "Debugging & Optimizing",
    "text": "Debugging & Optimizing\n\n\nprint() statements\nInterrupt execution and inspect environment browser()\nVisualize relationships using reactlog"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#debugging-optimizing-1",
    "href": "topics/Shiny/slide_shiny3.html#debugging-optimizing-1",
    "title": "R Shiny - Part III",
    "section": "Debugging & Optimizing",
    "text": "Debugging & Optimizing\n\nAssess compute and RAM usage using profvis\n\nSimple profiling using shiny.tictoc"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#code-execution",
    "href": "topics/Shiny/slide_shiny3.html#code-execution",
    "title": "R Shiny - Part III",
    "section": "Code execution",
    "text": "Code execution\nApp launch\n\nui &lt;- fluidPage(textInput(\"text_input\",label=\"textInput\"), textOutput(\"text_output\"))\nserver &lt;- function(input,output) {\n  output$text_output &lt;- renderText({input$text_input})\n}\n\n\nNew user\n\nui &lt;- fluidPage(textInput(\"text_input\",label=\"textInput\"), textOutput(\"text_output\"))\nserver &lt;- function(input,output) {\n  output$text_output &lt;- renderText({input$text_input})\n}\n\n\n\nWidget update\n\nui &lt;- fluidPage(textInput(\"text_input\",label=\"textInput\"), textOutput(\"text_output\"))\nserver &lt;- function(input,output) {\n  output$text_output &lt;- renderText({input$text_input})\n}"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#theming",
    "href": "topics/Shiny/slide_shiny3.html#theming",
    "title": "R Shiny - Part III",
    "section": "Theming",
    "text": "Theming\n\n\n\nUse shinythemes\n\n\nlibrary(shinythemes)\nfluidPage(theme = shinytheme(\"cerulean\"))\n\n\nLive theme selector\n\n\nlibrary(shinythemes)\nfluidPage(theme = shinythemes::themeSelector())\n\nshinythemes\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| viewerHeight: 650\nwebr::install(\"shinythemes\")\n\nshinyApp(\n  ui = fluidPage(\n    shinythemes::themeSelector(),\n    sidebarPanel(\n      textInput(\"txt\", \"Text input:\", \"text here\"),\n      sliderInput(\"slider\", \"Slider input:\", 1, 100, 30),\n      actionButton(\"action\", \"Button\"),\n      actionButton(\"action2\", \"Button2\", class = \"btn-primary\")\n    ),\n    mainPanel(\n      tabsetPanel(\n        tabPanel(\"Tab 1\"),\n        tabPanel(\"Tab 2\")\n      )\n    )\n  ),\n  server = function(input, output) {}\n)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#theming-1",
    "href": "topics/Shiny/slide_shiny3.html#theming-1",
    "title": "R Shiny - Part III",
    "section": "Theming",
    "text": "Theming\n\nUse bslib\n\n\nlibrary(bslib)\nui &lt;- page_fluid(\n  theme = bs_theme(version = 5)\n)\n\n\n\nLive theme selector\n\n\nlibrary(bslib)\nbs_theme_preview()\n\nbslib, Bootswatch"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#theming-using-custom-css",
    "href": "topics/Shiny/slide_shiny3.html#theming-using-custom-css",
    "title": "R Shiny - Part III",
    "section": "Theming using custom CSS",
    "text": "Theming using custom CSS\n\nInsert in the head\n\n\nui &lt;- fluidPage(\n  tags$head(\n    tags$style(HTML(\"\n      @import url('https://fonts.googleapis.com/css2?family=Yusei+Magic&display=swap');\n      h2 {\n        font-family: 'Yusei Magic', sans-serif;\n      }\"))\n  ))\n\n\n\nAdd styles directly\n\n\nui &lt;- fluidPage(h2(\"Old Faithful Geyser Data\", style = \"font-size: 2em;\"))\n\n\n\n\nLoad custom CSS file placed in www/\n\n\nui &lt;- fluidPage(\n  tags$head(tags$link(rel = \"stylesheet\", type = \"text/css\", href = \"styles.css\"))\n)\n\nCSS styling"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#deployment",
    "href": "topics/Shiny/slide_shiny3.html#deployment",
    "title": "R Shiny - Part III",
    "section": "Deployment",
    "text": "Deployment\n\nR scripts\n\nGitHub\nR Package\n\n\n\n\nContainer (Docker …)\n\n\n\n\nHosting\n\nShinyapps.io\nShiny Server (Free)\nShiny Server Pro\n\n\n\n\n\nAutomatically deploying to shinyapps.io"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#shinyapps.io",
    "href": "topics/Shiny/slide_shiny3.html#shinyapps.io",
    "title": "R Shiny - Part III",
    "section": "Shinyapps.io",
    "text": "Shinyapps.io\n\nlibrary(rsconnect)\nrsconnect::setAccountInfo(name=\"username\", token=\"HDFGT46YF7TDT6474G47\", secret=\"hdgTDF5FStgdkpJ\")\ndeployApp(appName=\"name\")\n\n\nShiny apps user guide, Shiny server guide"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#interactive-documents-quarto",
    "href": "topics/Shiny/slide_shiny3.html#interactive-documents-quarto",
    "title": "R Shiny - Part III",
    "section": "Interactive documents • Quarto",
    "text": "Interactive documents • Quarto\n---\ntitle: \"Interactive scatterplot\"\nformat: html\nserver: shiny\n---\n\n```{r}\nlibrary(shiny)\nlibrary(ggplot2)\n\nselectInput(\"x_var\", \"X-axis Variable:\", choices=names(mtcars), selected = \"hp\"),\nselectInput(\"y_var\", \"Y-axis Variable:\", choices=names(mtcars), selected = \"mpg\"),\nplotOutput(\"plot\")\n```\n\n```{r}\n#| context: server\noutput$plot &lt;- renderPlot({\n  ggplot(mtcars, aes_string(x = input$x_var, y = input$y_var)) +\n    geom_point() +\n    labs(title = \"Interactive mtcars scatterplot\", \n         x = input$x_var, \n         y = input$y_var)\n})\n```"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#interactive-documents-rmarkdown",
    "href": "topics/Shiny/slide_shiny3.html#interactive-documents-rmarkdown",
    "title": "R Shiny - Part III",
    "section": "Interactive documents • Rmarkdown",
    "text": "Interactive documents • Rmarkdown\n\nShiny can run in RMarkdown documents. Set YAML runtime: shiny.\n\n---\ntitle: Interactive document\noutput: html_document\nruntime: shiny\n---\n\nShiny widgets can be included directly\n\n```{r}\nselectInput('n_breaks',label='Number of bins:',choices=c(10,20,35,50),selected=20)\n```"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#interactive-documents",
    "href": "topics/Shiny/slide_shiny3.html#interactive-documents",
    "title": "R Shiny - Part III",
    "section": "Interactive documents",
    "text": "Interactive documents\n\nWhole shiny apps can be included directly\n\n```{r}\nshinyApp(\n  ui=fluidPage(),\n  server=function(input,output) {}\n)\n```\n\n\nHosted shiny apps can be embedded using &lt;iframe&gt;\n\n&lt;iframe src=\"https://user.shinyapps.io/app\"&gt;&lt;/iframe&gt;"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#other-topics",
    "href": "topics/Shiny/slide_shiny3.html#other-topics",
    "title": "R Shiny - Part III",
    "section": "Other topics",
    "text": "Other topics\n\nExtended task\nShiny unit tests\nApplications of action buttons\n\nProgress indicators\n\nShinylive\nShinyUIEditor\n…"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#extensions",
    "href": "topics/Shiny/slide_shiny3.html#extensions",
    "title": "R Shiny - Part III",
    "section": "Extensions",
    "text": "Extensions\n\nNaxstats: Repo collection of shiny extensions\nbslib: Bootswatch themes for shiny\nshinyurl: using URLs to recreate state of an app\nshinypod: Reusable modules\nshinyjs: Custom javascript functionality\nshinyWidgets: Bootstrap 3 custom widgets\nshinyBS: Bootstrap 3 widgets\nshinymanager: Authentication for shiny apps\n…"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#learning-community",
    "href": "topics/Shiny/slide_shiny3.html#learning-community",
    "title": "R Shiny - Part III",
    "section": "Learning & community",
    "text": "Learning & community\n\n\nDocumentation\n\nPosit Shiny home\nPosit Shiny articles\n\nBooks\n \n\nMastering Shiny Book\nEngineering Shiny Apps\nShiny Interfaces\nMastering shiny solutions\n\n\nConferences\n\nAppsilon: ShinyConf\nJumping Rivers: Shiny in Production\n\nBlogs & Podcasts\n\nPosit Shiny Blog\nShiny Developer Series"
  },
  {
    "objectID": "topics/Shiny/slide_shiny3.html#section",
    "href": "topics/Shiny/slide_shiny3.html#section",
    "title": "R Shiny - Part III",
    "section": "",
    "text": "Thank you. Questions?\nSlide inspirations: Roy Francis (NBIS, RaukR2024)"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#contents",
    "href": "topics/ggplot/slide_gg1.html#contents",
    "title": "Introduction to ggplot",
    "section": "Contents",
    "text": "Contents\n\nQuick checkup\nR Basics\nData Types and Formats\nR Tips\nGrammar of Graphics\n\nGeoms\nAesthetics\nScales\nFacets"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#quick-checkups",
    "href": "topics/ggplot/slide_gg1.html#quick-checkups",
    "title": "Introduction to ggplot",
    "section": "Quick checkups",
    "text": "Quick checkups\n\n\n\n\nCoffee breaks (Morning and afternoon fika)\nWebpage structure\nPlots from drop-down\nTimes mentioned in schedule are super arbitrary"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#r-basics",
    "href": "topics/ggplot/slide_gg1.html#r-basics",
    "title": "Introduction to ggplot",
    "section": "R basics",
    "text": "R basics\n\nn &lt;- c(2,3,4,2,1,2,4,5,10,11,8,9)\nprint(n)\n\n [1]  2  3  4  2  1  2  4  5 10 11  8  9\n\n\n\n\nz &lt;- n +3\nprint(z)\n\n [1]  5  6  7  5  4  5  7  8 13 14 11 12\n\n\n\n\n\nz &lt;- n +3\nmean(z)\n\n[1] 8.083333\n\n\n\n\n\ns &lt;- c(\"I\", \"love\", \"Batman\")\nprint(s)\n\n[1] \"I\"      \"love\"   \"Batman\""
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#data-types",
    "href": "topics/ggplot/slide_gg1.html#data-types",
    "title": "Introduction to ggplot",
    "section": "Data types",
    "text": "Data types\n\nint stands for integers\ndbl stands for doubles or real numbers\nchr stands for character vectors or strings\ndttm stands for date and time,\nlgl stands for logical with just TRUE or FALSE\nfctr stands for factors which R uses to state categorical variables\ndate stands for dates\n\nYou can find what kind of vectors you have or imported by using the function class()"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#data-formats",
    "href": "topics/ggplot/slide_gg1.html#data-formats",
    "title": "Introduction to ggplot",
    "section": "Data Formats",
    "text": "Data Formats\n\n\nWide format\n\n\n\n\n\n\n\nSample_1\nSample_2\nSample_3\nSample_4\n\n\n\n\nENSG00000000003\n321\n303\n204\n492\n\n\nENSG00000000005\n0\n0\n0\n0\n\n\nENSG00000000419\n696\n660\n472\n951\n\n\nENSG00000000457\n59\n54\n44\n109\n\n\nENSG00000000460\n399\n405\n236\n445\n\n\nENSG00000000938\n0\n0\n0\n0\n\n\n\n\n\n\n\n\n\n\nfamiliarity\nconveniency\nyou see more data"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#data-formats-1",
    "href": "topics/ggplot/slide_gg1.html#data-formats-1",
    "title": "Introduction to ggplot",
    "section": "Data Formats",
    "text": "Data Formats\n\nLong format\n\n\n\n\n\n\n\nSample_ID\nGene\ncount\n\n\n\n\nSample_1\nENSG00000000003\n321\n\n\nSample_1\nENSG00000000005\n0\n\n\nSample_1\nENSG00000000419\n696\n\n\nSample_1\nENSG00000000457\n59\n\n\nSample_1\nENSG00000000460\n399\n\n\nSample_1\nENSG00000000938\n0\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSample_ID\nSample_Name\nTime\nReplicate\nCell\nGene\ncount\n\n\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000003\n321\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000005\n0\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000419\n696\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000457\n59\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000460\n399\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000938\n0"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#data-formats-2",
    "href": "topics/ggplot/slide_gg1.html#data-formats-2",
    "title": "Introduction to ggplot",
    "section": "Data Formats",
    "text": "Data Formats\n\nLong format\n\n\n\n\n\n\nSample_ID\nSample_Name\nTime\nReplicate\nCell\nGene\ncount\n\n\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000003\n321\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000005\n0\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000419\n696\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000457\n59\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000460\n399\n\n\nSample_1\nt0_A\nt0\nA\nA431\nENSG00000000938\n0\n\n\n\n\n\n\n\n\n\nEasier to add data to the existing dataset without restructuring\nMost databases store and maintain data in long-formats due to its efficiency\nR tools like ggplot require data in long format"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#data-frames",
    "href": "topics/ggplot/slide_gg1.html#data-frames",
    "title": "Introduction to ggplot",
    "section": "Data Frames",
    "text": "Data Frames\n\nLet us take a quick look into data.frame in R:\n\n\n\nImported files are usually in data.frame\nStructured matrix with row.names and colnames\nProbably most used data.type in Biology!"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#important-tips",
    "href": "topics/ggplot/slide_gg1.html#important-tips",
    "title": "Introduction to ggplot",
    "section": "Important tips",
    "text": "Important tips\n\n? and ??\n\n? help manual for a particular function\n?? searches the entire R library for the term\nvignette(\"ggplot2\")\n\n\n\n\nTAB completion\n\nProbably most useful to avoid unnecessary error messages (and/or frustration)!\n\n\n\n\n\nCase sensitive\n\n\nprint(N)\n\nError: object 'N' not found\n\n\n\nprint(n)\n\n [1]  2  3  4  2  1  2  4  5 10 11  8  9"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#reading-files",
    "href": "topics/ggplot/slide_gg1.html#reading-files",
    "title": "Introduction to ggplot",
    "section": "Reading files",
    "text": "Reading files\n\n\n\n\n\niris-head-corrupted.csv\n\nSepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species\n5.1,3.5,1.4,0.2,setosa\n4.9,3,1.4,0.2,setosa\n4.7,3.2,1.3,0.2,setosa\n4.6,3.1,1.5,0.2,setosa\n5,3.6,#1.4,0.2,setosa\n5.4,3.9,1.7,0.4,setosa\n\n\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\nReserved variables\n\nReserved variables like T, F, character and many others …\nHow can you check if something is a reserved variable?\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#grammar-of-graphics",
    "href": "topics/ggplot/slide_gg1.html#grammar-of-graphics",
    "title": "Introduction to ggplot",
    "section": "Grammar of Graphics",
    "text": "Grammar of Graphics\n\n\n\n\n\n\n\nData: Input data\nGeom: A geometry representing data. Points, Lines etc\nAesthetics: Visual characteristics of the geometry. Size, Color, Shape etc\nScale: How visual characteristics are converted to display values\nStatistics: Statistical transformations. Counts, Means etc\nCoordinates: Numeric system to determine position of geometry. Cartesian, Polar etc\nFacets: Split data into subsets"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#building-a-graph",
    "href": "topics/ggplot/slide_gg1.html#building-a-graph",
    "title": "Introduction to ggplot",
    "section": "Building a graph",
    "text": "Building a graph"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#build-demo",
    "href": "topics/ggplot/slide_gg1.html#build-demo",
    "title": "Introduction to ggplot",
    "section": "Build-Demo",
    "text": "Build-Demo\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#build-demo-1",
    "href": "topics/ggplot/slide_gg1.html#build-demo-1",
    "title": "Introduction to ggplot",
    "section": "Build-Demo",
    "text": "Build-Demo\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#build-demo-2",
    "href": "topics/ggplot/slide_gg1.html#build-demo-2",
    "title": "Introduction to ggplot",
    "section": "Build-Demo",
    "text": "Build-Demo\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#build-demo-3",
    "href": "topics/ggplot/slide_gg1.html#build-demo-3",
    "title": "Introduction to ggplot",
    "section": "Build-Demo",
    "text": "Build-Demo\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#geoms",
    "href": "topics/ggplot/slide_gg1.html#geoms",
    "title": "Introduction to ggplot",
    "section": "Geoms",
    "text": "Geoms"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#geoms-1",
    "href": "topics/ggplot/slide_gg1.html#geoms-1",
    "title": "Introduction to ggplot",
    "section": "Geoms",
    "text": "Geoms\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#multiple-geoms",
    "href": "topics/ggplot/slide_gg1.html#multiple-geoms",
    "title": "Introduction to ggplot",
    "section": "Multiple geoms",
    "text": "Multiple geoms\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#aesthetics",
    "href": "topics/ggplot/slide_gg1.html#aesthetics",
    "title": "Introduction to ggplot",
    "section": "Aesthetics",
    "text": "Aesthetics\n\nAesthetic mapping vs aesthetic parameter"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#aesthetics-1",
    "href": "topics/ggplot/slide_gg1.html#aesthetics-1",
    "title": "Introduction to ggplot",
    "section": "Aesthetics",
    "text": "Aesthetics\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#scales",
    "href": "topics/ggplot/slide_gg1.html#scales",
    "title": "Introduction to ggplot",
    "section": "Scales",
    "text": "Scales\n\nIf you would like to change the default aesthetics\nscales: position, color, fill, size, shape, alpha, linetype\nsyntax: scale_&lt;aesthetic&gt;_&lt;type&gt;\n\n\nDiscrete Colors:"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#scales-discrete-colors",
    "href": "topics/ggplot/slide_gg1.html#scales-discrete-colors",
    "title": "Introduction to ggplot",
    "section": "Scales • Discrete Colors",
    "text": "Scales • Discrete Colors\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#scales-continuous-colors",
    "href": "topics/ggplot/slide_gg1.html#scales-continuous-colors",
    "title": "Introduction to ggplot",
    "section": "Scales • Continuous Colors",
    "text": "Scales • Continuous Colors\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#scales-shape",
    "href": "topics/ggplot/slide_gg1.html#scales-shape",
    "title": "Introduction to ggplot",
    "section": "Scales • Shape",
    "text": "Scales • Shape\n\nIn RStudio, type scale_, then press TAB\nSimilarly you can use it for shape, axis, fill, etc..\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#facets",
    "href": "topics/ggplot/slide_gg1.html#facets",
    "title": "Introduction to ggplot",
    "section": "Facets",
    "text": "Facets\n\nSplit to subplots based on variable(s)\nFacetting in one dimension"
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#facets-1",
    "href": "topics/ggplot/slide_gg1.html#facets-1",
    "title": "Introduction to ggplot",
    "section": "Facets",
    "text": "Facets\nfacet_wrap\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#facets-facet_grid",
    "href": "topics/ggplot/slide_gg1.html#facets-facet_grid",
    "title": "Introduction to ggplot",
    "section": "Facets • facet_grid",
    "text": "Facets • facet_grid\n\nFacetting in two dimensions\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg1.html#section",
    "href": "topics/ggplot/slide_gg1.html#section",
    "title": "Introduction to ggplot",
    "section": "",
    "text": "Thank you. Questions?"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#contents",
    "href": "topics/Shiny/slide_shiny1.html#contents",
    "title": "Introduction to R Shiny",
    "section": "Contents",
    "text": "Contents\n\nIntroduction to RShiny\nCode Structure\nApp execution\nUI\n\nDynamic UI\n\nServer"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#section",
    "href": "topics/Shiny/slide_shiny1.html#section",
    "title": "Introduction to R Shiny",
    "section": "",
    "text": "K-means sidebar, simple\n\n\n\n\n\n\n\nMovie explorer sidebar, simple\n\n\n\n\n\n\n\nfreeR simple\n\n\n\n\n\n\n\nSuperZip intermediate, geo\n\n\n\n\n\n\n\nWorkout creator intermediate\n\n\n\n\n\n\n\nWildLift intermediate, dashboard\n\n\n\n\n\n\n\nCovid tracker intermediate\n\n\n\n\n\n\n\nCashflow calc intermediate\n\n\n\n\n\n\n\nGenome browser intermediate\n\n\n\n\n\n\n\nSpecies selection adv\n\n\n\n\n\n\n\nProtein structure adv, dashboard\n\n\n\n\n\n\n\nCommute explorer adv, geo\n\n\n\n\n\n\n\nSteam explorer adv, dashboard\n\n\n\n\n\n\n\nSystem pipe adv, dashboard\n\n\n\n\n\n\n\nShark attack adv"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#what-is-shiny",
    "href": "topics/Shiny/slide_shiny1.html#what-is-shiny",
    "title": "Introduction to R Shiny",
    "section": "What is shiny?",
    "text": "What is shiny?\n\n\nInteractive documents & web applications\nCompletely created using R or Python\nNeeds a live environment\nshiny.posit.co/r/gallery/\nshinyapps.org\n\n\n\n\nUsage\n\nStandalone web applications\nDashboard/Flexboard\nInteractive RMarkdown\nVScode extensions\n\n\n\n\nApp structure\n\nUI Layout\nUI Inputs (Widgets)\nUI Outputs\nRenderer\nBuilder"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#app-organization",
    "href": "topics/Shiny/slide_shiny1.html#app-organization",
    "title": "Introduction to R Shiny",
    "section": "App organization",
    "text": "App organization\nOne file format\n\n\n\napp.r\n\nui &lt;- fluidPage()\nserver &lt;- function(input,output) {}\nshinyApp(ui=ui,server=server)\n\n\n\nTwo file format\n\n\n\nui.r\n\nui &lt;- fluidPage()\n\n\n\n\n\nserver.r\n\nserver &lt;- function(input,output) {}"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#app-execution",
    "href": "topics/Shiny/slide_shiny1.html#app-execution",
    "title": "Introduction to R Shiny",
    "section": "App execution",
    "text": "App execution\n\nRun shiny::runApp(\"path/to/folder\")\n\n\n\nUse shinyApp()\n\n\nshinyApp(\n  ui=fluidPage(),\n  server=function(input,output) {}\n)\n\n\n\n\nRunning as a separate process from terminal\n\nR -e \"shiny::runApp('~/shinyapp')\"\n\n\n\nFrom Rmd file using rmarkdown::run()"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#section-1",
    "href": "topics/Shiny/slide_shiny1.html#section-1",
    "title": "Introduction to R Shiny",
    "section": "",
    "text": "User Interface (UI)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui",
    "href": "topics/Shiny/slide_shiny1.html#ui",
    "title": "Introduction to R Shiny",
    "section": "UI",
    "text": "UI\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(\n  titlePanel(\"Title Panel\"),\n  sidebarLayout(\n    sidebarPanel(\n      helpText(\"Sidebar Panel\")\n    ),\n    mainPanel(\n      \"hello\"\n    )\n  )\n),\nserver=function(input,output) {})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#language-of-the-web-html-css-javascript",
    "href": "topics/Shiny/slide_shiny1.html#language-of-the-web-html-css-javascript",
    "title": "Introduction to R Shiny",
    "section": "Language of the web: HTML, CSS & Javascript",
    "text": "Language of the web: HTML, CSS & Javascript\n\n\nHypertext Markup Language (HTML)\n\nAll UI code is translated to HTML\nInspect with browser\n\n\nsidebarPanel(helpText(\"Sidebar Panel\"))\n\n&lt;div class=\"col-sm-4\"&gt;\n  &lt;form class=\"well\" role=\"complementary\"&gt;\n    &lt;span class=\"help-block\"&gt;Sidebar Panel&lt;/span&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n\nCascading style sheet (CSS)\n\nShiny is built on Bootstrap 3"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#section-2",
    "href": "topics/Shiny/slide_shiny1.html#section-2",
    "title": "Introduction to R Shiny",
    "section": "",
    "text": "#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(\n  titlePanel(\"Title Panel\"),\n  sidebarLayout(sidebarPanel(helpText(\"Sidebar Panel\")),\n    mainPanel(tabsetPanel(\n                tabPanel(\"tab1\",\n                         fluidRow(\n                           column(6,helpText(\"Col1\")),\n                           column(6,\n                                  helpText(\"Col2\"),\n                                  fluidRow(\n                                    column(4,style=\"background-color:#b0c6fb\",helpText(\"Col1\")),\n                                    column(4,style=\"background-color:#ffa153\",helpText(\"Col2\")),\n                                    column(4,style=\"background-color:#b1f6c6\",helpText(\"Col3\"))\n                                  )\n                           )\n                         )\n                ),\n                tabPanel(\"tab2\",\n                         inputPanel(helpText(\"Input Panel\"))\n                ),\n                tabPanel(\"tab3\",\n                  wellPanel(helpText(\"Well Panel\"))\n                )\n              )\n    )\n  )\n),\nserver=function(input,output) {})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-input",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-input",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Input",
    "text": "UI • Widgets • Input\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\nui=fluidPage(\n  fluidRow(\n    column(4,\n           selectInput(\"select-input\",\n                       label=\"selectInput\",\n                       choices=c(\"A\",\"B\",\"C\")),\n    )\n  )\n),\nserver=function(input,output) {\n})\n\n\n?selectInput\nselectInput(inputId, label, choices, selected = NULL, multiple = FALSE, \n            selectize = TRUE, width = NULL, size = NULL\n)\n\n\nInput ID has to be unique"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-input-1",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-input-1",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Input",
    "text": "UI • Widgets • Input\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\nui=fluidPage(\n  fluidRow(\n    column(4,\n           fileInput(\"file-input\",\"fileInput:\"),\n           selectInput(\"select-input\",label=\"selectInput\",choices=c(\"A\",\"B\",\"C\")),\n           sliderInput(\"slider-input\",label=\"sliderInput\",value=5,min=1,max=10),\n           numericInput(\"numeric-input\",label=\"numericInput\",value=5,min=1,max=10),\n           textInput(\"text-input\",label=\"textInput\"),\n           textAreaInput(\"text-area-input\",label=\"textAreaInput\"),\n           dateInput(\"date-input\",label=\"dateInput\"),\n           dateRangeInput(\"date-range-input\",label=\"dateRangeInput\"),\n           radioButtons(\"radio-button\",label=\"radioButtons\",choices=c(\"A\",\"B\",\"C\"),inline=T),\n           checkboxInput(\"checkbox\",\"checkboxInput\",value=FALSE),\n           actionButton(\"action-button\",\"Action\"),\n           hr(),\n           submitButton()\n    )\n  )\n),\nserver=function(input,output) {\n})\n\n\nWidgets gallery\n\nWidgets are visual objects on a page to allow for data input. Input and output variables."
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-input-functions",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-input-functions",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Input Functions",
    "text": "UI • Widgets • Input Functions\n\n\n\n\n\nFunction\nDescription\n\n\n\n\ncheckboxInput()\nCheckbox\n\n\ncheckboxGroupInput()\nCheckbox group\n\n\nradioButtons()\nRadio buttons\n\n\ndateInput()\nSingle date\n\n\ndateRangeInput()\nDate range\n\n\nfileInput()\nUpload file\n\n\nnumericInput()\nInput number\n\n\nsliderInput()\nInput number\n\n\n\n\n\n\n\nFunction\nDescription\n\n\n\n\ntextInput()\nSingle line text input\n\n\ntextAreaInput()\nMulti-line text input\n\n\npasswordInput()\nPassword input\n\n\nselectInput()\nDropdown selection\n\n\nactionButton()\nAction button\n\n\nsubmitButton()\nSubmit button\n\n\ntabsetPanel()\nTabset panel\n\n\nnavbarPage()\nPage with navbar\n\n\n\n\nWidgets gallery"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-outputs",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-outputs",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Outputs",
    "text": "UI • Widgets • Outputs\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(\n           textInput(\"text_input\",label=\"textInput\",value=\"hello world\"),\n           textOutput(\"text_output\")\n    ),\nserver=function(input, output) {\n  output$text_output &lt;- renderText({input$text_input})\n})\n\n\n?textOutput\ntextOutput(outputId)\n\n\nOutput ID has to be unique"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-outputs-1",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-outputs-1",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Outputs",
    "text": "UI • Widgets • Outputs\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(fluidRow(column(5,\n           textInput(\"text_input\",label=\"textInput\",value=\"&lt;h3 style='color:red'&gt;Red text&lt;/h3&gt;\"),\n           hr(),\n           htmlOutput(\"html_output\"),\n           textOutput(\"text_output\"),\n           verbatimTextOutput(\"verbatim_text_output\"),\n           tableOutput(\"table_output\"),\n           plotOutput(\"plot_output\",width=\"300px\",height=\"300px\")\n    ))),\n\nserver=function(input, output) {\n  output$html_output &lt;- renderText({input$text_input})\n  output$text_output &lt;- renderText({input$text_input})\n  output$verbatim_text_output &lt;- renderText({input$text_input})\n  output$table_output &lt;- renderTable({iris[1:3,1:3]})\n  output$plot_output &lt;- renderPlot({\n    plot(iris[,1],iris[,2])\n  })\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#ui-widgets-output-functions",
    "href": "topics/Shiny/slide_shiny1.html#ui-widgets-output-functions",
    "title": "Introduction to R Shiny",
    "section": "UI • Widgets • Output Functions",
    "text": "UI • Widgets • Output Functions\n\n\n\nOutput\nRenderer\nDescription\n\n\n\n\ntextOutput()\nrenderText()/renderPrint()\nStandard text\n\n\nverbatimTextOutput()\nrenderText()/renderPrint()\nMonospaced text\n\n\nhtmlOutput()\nrenderText()/renderPrint()\nHTML text output\n\n\nplotOutput()\nrenderPlot()\nCreate and display image\n\n\nimageOutput()\nrenderImage()\nDisplay existing image\n\n\ntableOutput()\nrenderTable()\nTable output\n\n\nuiOutput()\nrenderUI()\nHTML components"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#a-complete-app",
    "href": "topics/Shiny/slide_shiny1.html#a-complete-app",
    "title": "Introduction to R Shiny",
    "section": "A complete app",
    "text": "A complete app\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui = fluidPage(\n  h3(\"Temperature Converter\"),\n  numericInput(\"celsius\", \"Degrees Celsius:\", value = 0),\n  textOutput(\"fahrenheit\")\n),\n\nserver = function(input, output) {\n  output$fahrenheit &lt;- renderText({\n    paste(input$celsius, \"°C is \", (input$celsius * 9/5) + 32, \" °F\")\n  })\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#dynamic-ui",
    "href": "topics/Shiny/slide_shiny1.html#dynamic-ui",
    "title": "Introduction to R Shiny",
    "section": "Dynamic UI",
    "text": "Dynamic UI\n\nUI elements are created conditionally using uiOutput()/renderUI()\n\n\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"type\",label=\"Select input type\", choices=c(\"Text\",\"Number\")),\n  uiOutput(\"ui\"),\n  textOutput(\"text_output\"),\n),\n\nserver=function(input, output) {\n  \n output$ui &lt;- renderUI({\n    if(input$type==\"Text\") {\n      textInput(\"input_text\",\"Enter text\")\n    }else{\n      sliderInput(\"input_number\", \"Select number\", value=5, min=1, max=10)\n    }\n  })\n  \n  output$text_output &lt;- renderText({\n    if(input$type==\"Text\") {\n      input$input_text\n    }else{\n      input$input_number\n    }\n  })\n})\n\n\n\n\nOther options include conditionalPanel(), insertUI() and removeUI()"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#rendering-ui",
    "href": "topics/Shiny/slide_shiny1.html#rendering-ui",
    "title": "Introduction to R Shiny",
    "section": "Rendering UI",
    "text": "Rendering UI\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(\n  selectInput(\"type\", label=\"Select input type\", choices=c(\"Text\",\"Number\")),\n  uiOutput(\"ui\"),\n  textOutput(\"text_output\"),\n),\n\nserver=function(input, output) {\n  \n output$ui &lt;- renderUI({\n    if(input$type==\"Text\") {\n      textInput(\"input_text\", \"Enter text\", value=\"hello\")\n    }else{\n      sliderInput(\"input_number\", \"Select number\", value=5, min=1, max=10)\n    }\n  })\n  \n  output$text_output &lt;- renderText({\n    if(input$type==\"Text\") {\n      input$input_text\n    }else{\n      input$input_number\n    }\n  })\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#rendering-ui-1",
    "href": "topics/Shiny/slide_shiny1.html#rendering-ui-1",
    "title": "Introduction to R Shiny",
    "section": "Rendering UI",
    "text": "Rendering UI\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data\",label=\"Select data\",\n              choices=c(\"mtcars\",\"faithful\",\"iris\")),\n  tableOutput(\"table\"),\n  uiOutput(\"ui\")\n),\n\nserver=function(input, output) {\n  \n  data &lt;- reactive({ get(input$data, 'package:datasets') })\n  \n output$ui &lt;- renderUI({\n  if(input$data==\"iris\") plotOutput(\"plot\",width=\"400px\")\n  })\n  \n  output$plot &lt;- renderPlot({hist(data()[, 1])})\n  output$table &lt;- renderTable({head(data())})\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#rendering-ui-2",
    "href": "topics/Shiny/slide_shiny1.html#rendering-ui-2",
    "title": "Introduction to R Shiny",
    "section": "Rendering UI",
    "text": "Rendering UI\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\nui=fluidPage(\n  sliderInput(\"persons\",label=\"Select number of persons\", value=1, min=1,max=4),\n  uiOutput(\"ui\")\n),\n\nserver=function(input, output) {\n  output$ui &lt;- renderUI({\n    lapply(1:input$persons, function(i) {\n         div(\n           textInput(paste0(\"name\",i),\"Enter name:\",paste0(\"Person \",i)),\n           textInput(paste0(\"tel\",i),\"Enter phone number:\",value = \"0773921562\"),\n           hr()\n         )\n    })\n  })\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#server",
    "href": "topics/Shiny/slide_shiny1.html#server",
    "title": "Introduction to R Shiny",
    "section": "Server",
    "text": "Server\n\nServer is a function that assembles your input into output using R based code.\nThree rules to be followed to write a server function:\n\n\nRule 1: Save objects to display to output$"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#server-1",
    "href": "topics/Shiny/slide_shiny1.html#server-1",
    "title": "Introduction to R Shiny",
    "section": "Server",
    "text": "Server\nRule 2: Build objects to display with render*()\n\nR-Code block (can even be an entire R script) between the braces {} inside the render*() function.\n\n\n\n  output$hist &lt;- renderPlot({\n                    tile &lt;- \"histogram of 100 random numbers\"\n                    hist(rnorm(100), main = title)\n                })\n\n\n\n\nDifferent Render functions"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#server-2",
    "href": "topics/Shiny/slide_shiny1.html#server-2",
    "title": "Introduction to R Shiny",
    "section": "Server",
    "text": "Server\nRule 3: Use input values with input$"
  },
  {
    "objectID": "topics/Shiny/slide_shiny1.html#section-3",
    "href": "topics/Shiny/slide_shiny1.html#section-3",
    "title": "Introduction to R Shiny",
    "section": "",
    "text": "Thank you. Questions?\nSlide inspirations: Roy Francis (NBIS, RaukR2024)"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#dynamic-and-interactive-applications",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#dynamic-and-interactive-applications",
    "title": "Dynamic applications",
    "section": "Dynamic and Interactive applications",
    "text": "Dynamic and Interactive applications\n\n\nDynamic applications may resemble interactive Shiny dashboards in terms of appearance and user experience, but they differ significantly in structure. These applications are standalone and do not rely on a server component. Instead, all interactive features are pre-built within the application itself, and the final product is generated as an HTML file, ready to be hosted on a web platform. Tools like Quarto (and its predecessor, RMarkdown) are often used to create such dynamic applications.\nInteractive applications consist of both, a user interface (UI) and server, enabling users to send requests to the server through the UI. This setup allows the application’s components to be reactive, meaning the content displayed on the UI dynamically responds to the user’s inputs, creating a fully interactive experience. To build these applications, you need R scripts that define the UI and server components, either as separate or combined scripts.\nIn this workshop, we will cover both dynamic and interactive applications. First, we will explore how to create dynamic applications using Quarto, especially how to incorporate dynamic components directly into a Quarto HTML document and consequently incorporate interactivity without learning JavaScript or requiring a Shiny Server to view your document.\nThen, we will dive into building interactive applications with Shiny, focusing on the structure and components required for their development. By the end of today and tomorrow, you will have a clear understanding of the differences between these two approaches and the tools needed to implement them effectively."
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#quarto-using-htmlwidgets",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#quarto-using-htmlwidgets",
    "title": "Dynamic applications",
    "section": "Quarto using htmlwidgets",
    "text": "Quarto using htmlwidgets\n\n\nHTML widgets work just like R plots except they produce interactive web visualizations\nDo not require any knowledge of JavaScript, nor use of a Shiny Server\nThere are many widgets to choose from, most known are:\n\nplotly\nggiraph\nleaflet\nDT"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#plotly",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#plotly",
    "title": "Dynamic applications",
    "section": "plotly",
    "text": "plotly\n\n\n```{r}\nlibrary(plotly)\nlibrary(palmerpenguins)\npenguins %&gt;%\n    plot_ly(x = ~body_mass_g, y = ~flipper_length_mm, \n    color = ~sex, width = 550, height = 400) %&gt;%\n    add_markers()\n```\n\n\n\n\n\nFig.1: Body mass and flipper length of Palmer penguins"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#ggiraph",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#ggiraph",
    "title": "Dynamic applications",
    "section": "ggiraph",
    "text": "ggiraph\n\n\n\n\nWorks similar to plotly\nIt can connect 2 or more charts together\n\n\n```{r}\n#| fig-width: 14\n#| fig-height: 10\nlibrary(ggiraph)\nlibrary(ggplot2)\nlibrary(patchwork)\n\ntb_data &lt;- read.csv(\"./data/bcg-immunization-coverage-for-tb-among-1-year-olds.csv\", sep = \",\", header = T)\n\ntb_data_filt &lt;- tb_data[tb_data$Year == 2020 & tb_data$Share_of_newborns &lt; 60, ]\n\np1 &lt;- ggplot(tb_data_filt, aes(x = Entity, y = Share_of_newborns)) +\n    geom_col_interactive(aes(color = Entity, tooltip = Share_of_newborns, fill = Entity)) +\n    theme_minimal() +\n    labs(x = \"Entity\", y = \"Share of Newborns (%)\") + \n    coord_flip() + \n    scale_color_manual(values =c (\"#88CCEE\", \"#44AA99\", \"#117733\", \"#332288\", \"#DDCC77\", \"#999933\")) + \n    scale_fill_manual(values =c (\"#88CCEE\", \"#44AA99\", \"#117733\", \"#332288\", \"#DDCC77\", \"#999933\")) + \n    theme(axis.text = element_text(size = 18),\n    axis.title = element_text(size = 18),\n    legend.text = element_text(size = 18), \n    legend.title = element_text(size = 18))\n\ntb_data_filt1 &lt;- tb_data[tb_data$Year == 2023 & tb_data$Share_of_newborns &lt; 60, ]\n\np2 &lt;- ggplot(tb_data_filt1, aes(x = Entity, y = Share_of_newborns)) +\n    geom_col_interactive(aes(color = Entity, tooltip = Share_of_newborns, fill = Entity)) +\n    theme_minimal() +\n    labs(x = \"Entity\", y = \"Share of Newborns (%)\") + \n    coord_flip() + \n    scale_color_manual(values =c (\"#117733\", \"#332288\", \"#CC6677\", \"#999933\")) + \n    scale_fill_manual(values =c (\"#117733\", \"#332288\", \"#CC6677\", \"#999933\")) + \n    theme(axis.text = element_text(size = 18), \n    axis.title = element_text(size = 18),\n    legend.text = element_text(size = 18), \n    legend.title = element_text(size = 18)) \n\ngirafe(ggobj = (p1 + p2))\n```\n\n\n\n\n\n\n\n\n\nData used: https://ourworldindata.org/grapher/bcg-immunization-coverage-for-tb-among-1-year-olds?time=2020"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#leaflet",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#leaflet",
    "title": "Dynamic applications",
    "section": "leaflet",
    "text": "leaflet\n\n\nFor creating dynamic maps that support panning and zooming along with various annotations like markers, basemaps, and pop-ups\nLet’s check where NBIS has drop-ins on Wednesdays at 10.30 in Lund\n\n\n\n\n\n```{r}\nlibrary(leaflet)\n\ndf &lt;- data.frame(lng = c(13.20279, 13.20869, 13.21894),\n                 lat = c(55.71118, 55.71414, 55.71092))\n\nicons_list &lt;- awesomeIcons(icon = 'briefcase',\n  iconColor = 'white',\n  library = 'ion', \n  markerColor = \"cadetblue\")\n\nleaflet(width = \"100%\") %&gt;%\n  addTiles() %&gt;%\n  setView(lng = 13.21014,lat = 55.71208, zoom = 12) %&gt;%\n  addAwesomeMarkers(data = df, icon = icons_list, popup = c(\"Forum Medicum Café\", \"Café Le Mani\", \"MV Inspira\"))\n```"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#dt",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#dt",
    "title": "Dynamic applications",
    "section": "DT",
    "text": "DT\n\n\n```{r}\nlibrary(DT)\n\ntb_data &lt;- read.csv(\"./data/bcg-immunization-coverage-for-tb-among-1-year-olds.csv\", sep = \",\", header = T)\n\ndatatable(tb_data, filter = \"top\", class = 'cell-border stripe')\n```"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#quarto-using-crosstalk",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#quarto-using-crosstalk",
    "title": "Dynamic applications",
    "section": "Quarto using crosstalk",
    "text": "Quarto using crosstalk\n```{r}\nlibrary(crosstalk)\nlibrary(DT)\nlibrary(plotly)\n\ntb_data &lt;- read.csv(\"./data/bcg-immunization-coverage-for-tb-among-1-year-olds.csv\", sep = \",\", header = T)\ntb_data_filt &lt;- tb_data[grepl(\"^N\", tb_data$Entity) & tb_data$Year == 2000, ]\ntb_data_cross &lt;- SharedData$new(tb_data_filt)\n\nbscols(\n  list(filter_checkbox(\"Entity\", \"Entity\", tb_data_cross, ~Entity, inline = TRUE)),\n  plot_ly(tb_data_cross, x = ~Entity, y=~Share_of_newborns),\n  datatable(tb_data_cross, width = \"100%\")\n)\n```\n\n\n\n\n\n\nEntity\n\n\n\nNamibia\n\n\n\nNauru\n\n\n\nNepal\n\n\n\nNicaragua\n\n\n\nNiger\n\n\n\nNigeria\n\n\n\nNiue\n\n\n\nNorth Korea\n\n\n\nNorth Macedonia"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#observablejs",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#observablejs",
    "title": "Dynamic applications",
    "section": "ObservableJS",
    "text": "ObservableJS\n\n\nQuarto supports OJS for interactive visualizations in the browser\n{ojs} executable code block\n\n\n```{ojs}\n// Load the dataset from a CSV file\ndata = FileAttachment(\"./data/bcg-immunization-coverage-for-tb-among-1-year-olds.csv\").csv()\n\n// Create a range slider to select the year dynamically\nviewof year = Inputs.range([2000, 2023], {step: 1, value: 2010, label: \"Year\"})\n\n// Create a checkbox input to filter data by specific entities\nviewof entity = Inputs.checkbox(\n  [\"Bangladesh\", \"Belarus\", \"Belize\", \"Benin\", \"Bhutan\", \"Bolivia\", \"Bosnia and Herzegovina\", \"Botswana\", \"Brazil\", \"Brunei\", \"Bulgaria\", \"Burkina Faso\", \"Burundi\"], \n  { value: [\"Belarus\", \"Belize\", \"Bolivia\", \"Brasil\", \"Bulgaria\"], \n    label: \"Entity:\"\n  }\n)\n\n// Filter the dataset based on the selected year and entity\nfilteredData = data.filter(d =&gt; d.Year == year && entity.includes(d.Entity))\n\n// Generate a bar plot using the filtered data\nPlot.plot({\n    marks: [\n        Plot.barY(filteredData, {x: \"Entity\", y: \"Share_of_newborns\", fill: \"Entity\"})\n    ],\n    x: {label: \"Entity\"}, // Label for the x-axis\n    y: {label: \"Share of Newborns (%)\"}, // Label for the y-axis\n    color: {legend: true} // enable the color legend\n})\n```"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#observablejs-1",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#observablejs-1",
    "title": "Dynamic applications",
    "section": "ObservableJS",
    "text": "ObservableJS\n\n\nQuarto supports OJS for interactive visualizations in the browser\n{ojs} executable code block\n\n\n\ndata = FileAttachment(\"./data/bcg-immunization-coverage-for-tb-among-1-year-olds.csv\").csv()\n\n// Create a range slider to select the year dynamically\nviewof year = Inputs.range([2000, 2023], {step: 1, value: 2010, label: \"Year\"})\n\n// Create a checkbox input to filter data by specific entities\nviewof entity = Inputs.checkbox(\n  [\"Bangladesh\", \"Belarus\", \"Belize\", \"Benin\", \"Bhutan\", \"Bolivia\", \"Bosnia and Herzegovina\", \"Botswana\", \"Brazil\", \"Brunei\", \"Bulgaria\", \"Burkina Faso\", \"Burundi\"], \n  { value: [\"Belarus\", \"Belize\", \"Bolivia\", \"Brasil\", \"Bulgaria\"], \n    label: \"Entity:\"\n  }\n)\n\n// Filter the dataset based on the selected year and entity\nfilteredData = data.filter(d =&gt; d.Year == year && entity.includes(d.Entity))\n\n// Generate a bar plot using the filtered data\nPlot.plot({\n    marks: [\n        Plot.barY(filteredData, {x: \"Entity\", y: \"Share_of_newborns\", fill: \"Entity\"})\n    ],\n    x: {label: \"Entity\"}, // Label for the x-axis\n    y: {label: \"Share of Newborns (%)\"}, // Label for the y-axis\n    color: {legend: true} // enable the color legend\n})"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#sources",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#sources",
    "title": "Dynamic applications",
    "section": "Sources",
    "text": "Sources\n\nhtmlwidgets\nQuarto Tips & Tricks\nObservable JS\nOur World in Data"
  },
  {
    "objectID": "topics/dynamic_plotting/slide_dynamic_plot1.html#section",
    "href": "topics/dynamic_plotting/slide_dynamic_plot1.html#section",
    "title": "Dynamic applications",
    "section": "",
    "text": "Thank you. Questions?"
  },
  {
    "objectID": "topics/Shiny/lab_shiny2.html",
    "href": "topics/Shiny/lab_shiny2.html",
    "title": "RShiny Lab: Part II",
    "section": "",
    "text": "We will here first look into the example of what the automatic reactivity of Rshiny looks like. The reactive functions like renderPlot() and renderPrint() are always looking for any changes in the input values and are updated quickly! Although this is super handy for any app, sometimes this can lead to unwanted confusion. Like, take the R function rnorm(), this function basically spits out random numbers. If you use this function in an app, everytime this function is called, it will output different random number sets. This can cause problems like in the example below:\n Task   Try to change the slider input values and check if the summary and hist match with each other?\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nui &lt;- fluidPage(\n  sliderInput(inputId = \"num\", \n    label = \"Choose a number\", \n    value = 25, min = 1, max = 100),\n  plotOutput(\"hist\"),\n  verbatimTextOutput(\"stats\")\n)\n\nserver &lt;- function(input, output) {\n  output$hist &lt;- renderPlot({\n    hist(rnorm(input$num))\n  })\n  output$stats &lt;- renderPrint({\n    summary(rnorm(input$num))\n  })\n}\n\nshinyApp(ui = ui, server = server)\nSo, in order to make it consistent, we have to use the rnorm() only once and save it as a reactive function and then apply it to both the hist() and summary(). We do this by using reactive() function to store it as a variable. See the example below:\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nui &lt;- fluidPage(\n  sliderInput(inputId = \"num\", \n    label = \"Choose a number\", \n    value = 25, min = 1, max = 100),\n  plotOutput(\"hist\"),\n  verbatimTextOutput(\"stats\")\n)\n\nserver &lt;- function(input, output) {\n  \n  data &lt;- reactive({\n    rnorm(input$num)\n  })\n  \n  output$hist &lt;- renderPlot({\n    hist(data())\n  })\n  output$stats &lt;- renderPrint({\n    summary(data())\n  })\n}\n\nshinyApp(ui = ui, server = server)\n Note   As the data variable we have in the example above is a reactive function, you have to remember to use () whenever you call that particular variable."
  },
  {
    "objectID": "topics/Shiny/lab_shiny2.html#rmarkdown",
    "href": "topics/Shiny/lab_shiny2.html#rmarkdown",
    "title": "RShiny Lab: Part II",
    "section": "8.1 Rmarkdown",
    "text": "8.1 Rmarkdown\nShiny interactive widgets can be embedded into Rmarkdown documents. These documents need to be live and can handle interactivity. The important addition is the line runtime: shiny to the YAML matter. Here is an example:\n\n\n---\nruntime: shiny\noutput: html_document\n---\n\n```{r}\nlibrary(shiny)\n```\n\nThis is a standard RMarkdown document. Here is some code:\n\n```{r}\nhead(iris)\n```\n\n```{r}\nplot(iris$Sepal.Length,iris$Petal.Width)\n```\n\nBut, here is an interactive shiny widget.\n\n```{r}\nsliderInput(\"in_breaks\",label=\"Breaks:\",min=5,max=50,value=5,step=5)\n```\n\n```{r}\nrenderPlot({\nhist(iris$Sepal.Length,breaks=input$in_breaks)\n})\n```\n\n\nThis code can be copied to a new file in RStudio and saved as, for example, shiny.Rmd. Then click Knit. Alternatively, you can run rmarkdown::run(\"shiny.Rmd\")."
  },
  {
    "objectID": "topics/Shiny/lab_shiny2.html#quarto",
    "href": "topics/Shiny/lab_shiny2.html#quarto",
    "title": "RShiny Lab: Part II",
    "section": "8.2 Quarto",
    "text": "8.2 Quarto\nSimialrly, you can do the same in quarto. Just change the yaml header of the previous code with the following:\n\n\n---\nformat: html\nserver: shiny\n---\n\n\nAlso under the server part of the code-chunk, add #| context: server\nThis could be saved as shiny.qmd and could be rendered in the bash terminal by quarto render shiny.qmd\nMore information about using shiny and quarto together is here"
  },
  {
    "objectID": "topics/Shiny/lab_shiny1.html",
    "href": "topics/Shiny/lab_shiny1.html",
    "title": "RShiny Lab: Part I",
    "section": "",
    "text": "This is an introduction to shiny web applications with R. Please follow the exercise to familiarise yourself with the fundamentals. And then you can follow instructions to build an app with interactive plots related to the Covid data. Code chunks starting with shinyApp() can be simply copy-pasted to the RStudio console and run. Generally, complete shiny code is saved as a text file, named for example, as app.R and then clicking Run app launches the app.\n\n\n\n1 UI • Layout\nThis is an example to show the layout of widgets on a webpage using shiny functions. fluidPage() is used to define a responsive webpage. titlePanel() is used to define the top bar. sidebarLayout() is used to create a layout that includes a region on the left called side bar panel and a main panel on the right. The contents of these panels are further defined under sidebarPanel() and mainPanel().\nIn the main panel, the use of tab panels are demonstrated. The function tabsetPanel() is used to define a tab panel set and individual tabs are defined using tabPanel(). fluidRow() and column() are used to structure elements within each tab. The width of each column is specified. Total width of columns must add up to 12.\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\n\nui &lt;- fluidPage(\n  titlePanel(\"Title Panel\"),\n  sidebarLayout(\n    sidebarPanel(\n      helpText(\"Sidebar Panel\")\n    ),\n    mainPanel(tabsetPanel(\n      tabPanel(\"tab1\",\n               fluidRow(\n                 column(6,helpText(\"Col1\")),\n                 column(6,\n                        helpText(\"Col2\"),\n                        fluidRow(\n                          column(4,style=\"background-color:#b0c6fb\",\n                                 helpText(\"Col1\")\n                          ),\n                          column(4,style=\"background-color:#ffa153\",\n                                 helpText(\"Col2\")\n                          ),\n                          column(4,style=\"background-color:#b1f6c6\",\n                                 helpText(\"Col3\")\n                          )\n                        )\n                 )\n               )\n      ),\n      tabPanel(\"tab2\",\n               inputPanel(helpText(\"Input Panel\"))\n      ),\n      tabPanel(\"tab3\",\n               wellPanel(helpText(\"Well Panel\"))\n      )\n    )\n    )\n  )\n)\nserver &lt;- function(input,output){}\nshinyApp(ui=ui,server=server)\n\n\n2 UI • Widgets • Input\nInput widgets are used to accept content interactively from the user. These widgets usually end in Input like selectInput(). Below are usage examples of several of shiny’s built-in widgets. Every widget has a variable name which is accessible through input$ in the server function. For example, the value of a variable named text-input would be accessed through input$text-input.\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui=fluidPage(\n  fluidRow(\n    column(6,\n           fileInput(\"file-input\",\"fileInput:\"),\n           selectInput(\"select-input\",label=\"selectInput\",choices=c(\"A\",\"B\",\"C\")),\n           numericInput(\"numeric-input\",label=\"numericInput\",value=5,min=1,max=10),\n           sliderInput(\"slider-input\",label=\"sliderInput\",value=5,min=1,max=10),\n           textInput(\"text-input\",label=\"textInput\"),\n           textAreaInput(\"text-area-input\",label=\"textAreaInput\"),\n           dateInput(\"date-input\",label=\"dateInput\"),\n           dateRangeInput(\"date-range-input\",label=\"dateRangeInput\"),\n           radioButtons(\"radio-button\",label=\"radioButtons\",choices=c(\"A\",\"B\",\"C\"),inline=T),\n           checkboxInput(\"checkbox\",\"checkboxInput\",value=FALSE),\n           actionButton(\"action-button\",\"Action\"),\n           hr(),\n           submitButton()\n    )\n  )\n),\nserver=function(input,output){},\noptions=list(height=900))\n\n\n3 UI • Widgets • Outputs\nSimilar to input widgets, output widgets are used to display information to the user on the webpage. These widgets usually end in Output like textOutput(). Every widget has a variable name accessible under output$ to which content is written in the server function. Render functions are used to write content to output widgets. For example renderText() is used to write text data to textOutput() widget.\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\n  ui=fluidPage(fluidRow(column(6,\n             textInput(\"text_input\",label=\"textInput\",value=\"&lt;h3 style='color:red'&gt;Red text&lt;/h3&gt;\"),\n             hr(),\n             htmlOutput(\"html_output\"),\n             textOutput(\"text_output\"),\n             verbatimTextOutput(\"verbatim_text_output\"),\n             tableOutput(\"table_output\"),\n             plotOutput(\"plot_output\",width=\"300px\",height=\"300px\")\n      ))),\n  server=function(input, output) {\n    output$html_output &lt;- renderText({input$text_input})\n    output$text_output &lt;- renderText({input$text_input})\n    output$verbatim_text_output &lt;- renderText({input$text_input})\n    output$table_output &lt;- renderTable({iris[1:3,1:3]})\n    output$plot_output &lt;- renderPlot({\n      plot(iris[,1],iris[,2])\n    })\n},\noptions=list(height=700))\nIn this example, we have a text input box which takes user text and outputs it in three different variations. The first output is html output htmlOutput(). Since the default text is html content, the output is red coloured text. A normal non-html text would just look like normal text. The second output is normal text output textOutput(). The third variation is verbatimTextOutput() which displays text in monospaced code style. This example further shows table output and plot output.\n\n\n4 Dynamic UI\nSometimes we want to add, remove or change currently loaded UI widgets conditionally based on dynamic changes in code execution or user input. Conditional UI can be defined using conditionalPanel(), uiOutput()/renderUI(), insertUI() or removeUI. In this example, we will use uiOutput()/renderUI().\nIn the example below, the output plot is displayed only if the selected dataset is iris.\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"mtcars\",\"faithful\",\"iris\")),\n  tableOutput(\"table_output\"),\n  uiOutput(\"ui\")\n),\nserver=function(input,output) {\n  getdata &lt;- reactive({ get(input$data_input, 'package:datasets') })\n  \n  output$ui &lt;- renderUI({\n    if(input$data_input==\"iris\") plotOutput(\"plot_output\",width=\"400px\")\n  })\n  \n  output$plot_output &lt;- renderPlot({hist(getdata()[, 1])})\n  output$table_output &lt;- renderTable({head(getdata())})\n})\nHere, conditional UI is used to selectively display an output widget (plot). Similarly, this idea can be used to selectively display any input or output widget.\n\n\n5 Session info\n\nsessionInfo()\n\nR version 4.4.3 (2025-02-28)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 24.04.1 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0\n\nlocale:\n [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              \n [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    \n [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   \n [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 \n [9] LC_ADDRESS=C               LC_TELEPHONE=C            \n[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       \n\ntime zone: Etc/UTC\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggplot2_3.5.1 shiny_1.10.0 \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.5       cli_3.6.4         knitr_1.50        rlang_1.1.5      \n [5] xfun_0.51         generics_0.1.3    promises_1.3.2    jsonlite_1.9.0   \n [9] xtable_1.8-4      glue_1.8.0        colorspace_2.1-1  htmltools_0.5.8.1\n[13] httpuv_1.6.15     scales_1.3.0      rmarkdown_2.29    grid_4.4.3       \n[17] tibble_3.2.1      evaluate_1.0.3    munsell_0.5.1     fastmap_1.2.0    \n[21] yaml_2.3.10       lifecycle_1.0.4   compiler_4.4.3    dplyr_1.1.4      \n[25] pkgconfig_2.0.3   htmlwidgets_1.6.4 Rcpp_1.0.14       later_1.4.1      \n[29] digest_0.6.37     R6_2.6.1          tidyselect_1.2.1  pillar_1.10.1    \n[33] magrittr_2.0.3    withr_3.0.2       tools_4.4.3       gtable_0.3.6     \n[37] mime_0.12"
  },
  {
    "objectID": "home_contents.html",
    "href": "home_contents.html",
    "title": "Contents",
    "section": "",
    "text": "Note\n\n\n\nThe contents of this course are currently being generated. It will be updated here regularly until the course. Please check the Schedule for the proposed topics and updated materials.\n\n\n\n\n\n\n\n\n\n\n\n\nTopic\nLecture\nTutorial\n\n\n\n\nggplot\n\n\nBasic ggplot\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAdvanced ggplot\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nVector and Bitmap\n\n\n\n\n\n\n\n\n\nPCA plot\n\n\n\n\n\n\n\n\n\nSingle-cell\n\n\n\n\n\n\n\n\n\nQuarto\n\n\nBasic Quarto\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuarto Dashboard\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDynamic Plotting\n\n\nIntro to Dynamic plotting\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRshiny\n\n\nRshiny Part I\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRshiny Part II\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nRshiny Part III\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   Slides    Lab  \n\n\n\n\n\n\n\n   Solutions to Lab Exercises\n\n\n\n\n\nWe have compiled all the solutions for the different exercises in each of the sections here"
  },
  {
    "objectID": "topics/lab_download.html",
    "href": "topics/lab_download.html",
    "title": "Download data",
    "section": "",
    "text": "The following data will be used in the used for the exercises in this course. The data comes from a mock RNA sequencing data with 12 samples that are from cell-lines. As in any normal RNAseq analysis the counts of genes were normalized using different methods such as VST and CPM after filtering out the genes that were of very low expression. We would use these data for visualizations.\nDownload all of these files into your current working directory\nYou can download all the files together here. Make a directory called data and unzip in that directory!\nIf workshop_on_advanced_data_visualization is the current working directory, the directory tree should look like this:\n\nworkshop_on_advanced_data_visualization\n\ndata\n\n2024_final_scores.tsv\narch_newick.txt\ncounts_deseq2.txt\ncounts_filtered.txt\ncounts_raw.txt\ncounts_vst.txt\nhuman_biomaRt_annotation.csv\nmetadata.csv\nshiny_app_data.csv\nTime_t24_vs_t0.txt\nTime_t2_vs_t0.txt\nTime_t6_vs_t0.txt\ntree_env.tsv\ntree_hmap.tsv\n\n\n\nYou can find the information related to the important files below:\n\n\n\nTable with gene counts after filtering: Filtered Counts\nTable with gene counts normalized with VST: VST counts\nTable with gene counts normalized with DESeq2: DESeq2 counts\n\n\n\n\n\nMetadata of the samples: Sample Metadata\nMetadata of the genes with their functions: Gene Annotation\n\n\n\n\nBelow are the lists of differentially expressed genes between different time points\n\nTime point 2 vs Time point 0\nTime point 6 vs Time point 0\nTime point 24 vs Time point 0"
  },
  {
    "objectID": "topics/lab_download.html#counts-table",
    "href": "topics/lab_download.html#counts-table",
    "title": "Download data",
    "section": "",
    "text": "Table with gene counts after filtering: Filtered Counts\nTable with gene counts normalized with VST: VST counts\nTable with gene counts normalized with DESeq2: DESeq2 counts"
  },
  {
    "objectID": "topics/lab_download.html#metadata",
    "href": "topics/lab_download.html#metadata",
    "title": "Download data",
    "section": "",
    "text": "Metadata of the samples: Sample Metadata\nMetadata of the genes with their functions: Gene Annotation"
  },
  {
    "objectID": "topics/lab_download.html#de-genes",
    "href": "topics/lab_download.html#de-genes",
    "title": "Download data",
    "section": "",
    "text": "Below are the lists of differentially expressed genes between different time points\n\nTime point 2 vs Time point 0\nTime point 6 vs Time point 0\nTime point 24 vs Time point 0"
  },
  {
    "objectID": "topics/lab_download.html#phylogenetic-trees",
    "href": "topics/lab_download.html#phylogenetic-trees",
    "title": "Download data",
    "section": "3.1 Phylogenetic trees",
    "text": "3.1 Phylogenetic trees\n\n\n\n\n\n\nTip\n\n\n\nIf you are interested in leaning about how to work with phylogeny in ggplot and R. You can follow some tutorial materials here\n\n\nThe data required for the phylogenetic trees are already part of the main data.zip file, as shown in the directory tree before. The files needed for this exercise are described below:\n\nA phylogenetic tree based on a group of archaeal genomes in newick format: Archaea tree\nSome metadata info regarding the environments that these archaea could be found: Environment info\nAn expression matrix to show heatmap and phylogenetic tree together: for heatmap"
  },
  {
    "objectID": "topics/lab_download.html#map-data-with-ggmap",
    "href": "topics/lab_download.html#map-data-with-ggmap",
    "title": "Download data",
    "section": "3.2 Map-data with ggmap",
    "text": "3.2 Map-data with ggmap\n\n\n\n\n\n\nTip\n\n\n\nIf you are interested in leaning about how to work with maps in ggplot and R. You can follow some tutorial materials here\n\n\nThe data required for this part of the exercise can be downloaded from here\n\nPopulation statistics of the different countries in 2020\nA small data frame of points from the Sisquoc River\nGPS readings from a personal run"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#quarto-dashboards",
    "href": "topics/Quarto/slide_quarto2.html#quarto-dashboards",
    "title": "Advanced Quarto",
    "section": "Quarto dashboards",
    "text": "Quarto dashboards\n\nA new output format for creating dashboards from notebooks/ .qmd files\nDashboards are a great way to share results from analyses with others \nMain goal: To make it simple to build compelling interactive dashboards using R, Python, Julia, and Observable\n\n\n\nDashboards examples\n\n\nYou already analyzed and summarize your data in computational notebooks with R and/or Python. What’s next? You can share your insights or allow others to make their own conclusions in eye-catching dashboards and straight-forward to author, design, and deploy Quarto Dashboards, regardless of the language of your data processing, visualization, analysis, etc. With Quarto Dashboards, you can create elegant and production-ready dashboards using a variety of components, including static graphics (ggplot2, Matplotlib, Seaborn, etc.), interactive widgets (Plotly, Leaflet, Jupyter Widgets, htmlwidgets, etc.), tabular data, value boxes, text annotations, and more. Additionally, with intelligent resizing of components, your Quarto Dashboards look great on devices of all sizes. And importantly, you can author Quarto Dashboards without leaving the comfort of your “home” – in plain text markdown with any text editor (VS Code, RStudio, Neovim, etc.) or any notebook editor (JupyterLab, etc.)."
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#dashboard-components",
    "href": "topics/Quarto/slide_quarto2.html#dashboard-components",
    "title": "Advanced Quarto",
    "section": "Dashboard components",
    "text": "Dashboard components\n\nDashboards are composed of cards\nCards content: plots, tables, value boxes…\nCards are arranged into rows and columns\nPages, tabsets, and sidebars allow for more advanced layouts"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#dashboard-basic-structure",
    "href": "topics/Quarto/slide_quarto2.html#dashboard-basic-structure",
    "title": "Advanced Quarto",
    "section": "Dashboard basic structure",
    "text": "Dashboard basic structure"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-1-format-dashboard",
    "href": "topics/Quarto/slide_quarto2.html#step-1-format-dashboard",
    "title": "Advanced Quarto",
    "section": "Step 1: format: dashboard",
    "text": "Step 1: format: dashboard\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n# notebook content goes here..."
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-2-add-a-card",
    "href": "topics/Quarto/slide_quarto2.html#step-2-add-a-card",
    "title": "Advanced Quarto",
    "section": "Step 2: Add a card",
    "text": "Step 2: Add a card\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-2-add-a-card-1",
    "href": "topics/Quarto/slide_quarto2.html#step-2-add-a-card-1",
    "title": "Advanced Quarto",
    "section": "Step 2: Add a card",
    "text": "Step 2: Add a card\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-3-add-another-card",
    "href": "topics/Quarto/slide_quarto2.html#step-3-add-another-card",
    "title": "Advanced Quarto",
    "section": "Step 3: Add another card",
    "text": "Step 3: Add another card\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-3-add-another-card-1",
    "href": "topics/Quarto/slide_quarto2.html#step-3-add-another-card-1",
    "title": "Advanced Quarto",
    "section": "Step 3: Add another card",
    "text": "Step 3: Add another card\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-4-add-titles-to-cards",
    "href": "topics/Quarto/slide_quarto2.html#step-4-add-titles-to-cards",
    "title": "Advanced Quarto",
    "section": "Step 4: Add titles to cards",
    "text": "Step 4: Add titles to cards\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-4-add-titles-to-cards-1",
    "href": "topics/Quarto/slide_quarto2.html#step-4-add-titles-to-cards-1",
    "title": "Advanced Quarto",
    "section": "Step 4: Add titles to cards",
    "text": "Step 4: Add titles to cards\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: dashboard\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-5-add-a-logo",
    "href": "topics/Quarto/slide_quarto2.html#step-5-add-a-logo",
    "title": "Advanced Quarto",
    "section": "Step 5: Add a logo",
    "text": "Step 5: Add a logo\n\nLogo added to the navigation bar\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat:\n  dashboard: \n    logo: ../assets/images/cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#step-5-add-a-logo-1",
    "href": "topics/Quarto/slide_quarto2.html#step-5-add-a-logo-1",
    "title": "Advanced Quarto",
    "section": "Step 5: Add a logo",
    "text": "Step 5: Add a logo\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat:\n  dashboard: \n    logo: ../assets/images/cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#layout",
    "href": "topics/Quarto/slide_quarto2.html#layout",
    "title": "Advanced Quarto",
    "section": "Layout",
    "text": "Layout\n\nRows\n\nBy default, cards are laid out in rows\n\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat:\n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\n```\n\n## Row - Gender {height=70%}\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Row - Temperature {height=30%}\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#layout---rows",
    "href": "topics/Quarto/slide_quarto2.html#layout---rows",
    "title": "Advanced Quarto",
    "section": "Layout - Rows",
    "text": "Layout - Rows\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat:\n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n## Row - Gender {height=70%}\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Row - Temperature {height=30%}\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#layout-1",
    "href": "topics/Quarto/slide_quarto2.html#layout-1",
    "title": "Advanced Quarto",
    "section": "Layout",
    "text": "Layout\n\nColumns\n\nSetting orientation to columns makes each ## indicate a column instead of a row\n\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    orientation: columns\n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n## Column - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Column - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#layout---columns",
    "href": "topics/Quarto/slide_quarto2.html#layout---columns",
    "title": "Advanced Quarto",
    "section": "Layout - Columns",
    "text": "Layout - Columns\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    orientation: columns\n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n## Column - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Column - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#tabsets",
    "href": "topics/Quarto/slide_quarto2.html#tabsets",
    "title": "Advanced Quarto",
    "section": "Tabsets",
    "text": "Tabsets\n\nPut content in different tabs\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n## Row - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Row - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n### Tabsets of plots {.tabset}\n```{r}\n#| title: Gender\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: Temperature\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#tabsets-1",
    "href": "topics/Quarto/slide_quarto2.html#tabsets-1",
    "title": "Advanced Quarto",
    "section": "Tabsets",
    "text": "Tabsets\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n## Row - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n## Row - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n### Tabsets of plots {.tabset}\n```{r}\n#| title: Gender\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n```{r}\n#| title: Temperature\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#pages",
    "href": "topics/Quarto/slide_quarto2.html#pages",
    "title": "Advanced Quarto",
    "section": "Pages",
    "text": "Pages\n\nNew page is created with a Level I heading (#)\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n# Page 1\n## Row - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n# Page 2\n## Row - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#pages-1",
    "href": "topics/Quarto/slide_quarto2.html#pages-1",
    "title": "Advanced Quarto",
    "section": "Pages",
    "text": "Pages\n\n\n\n\nmy-dashboard.qmd\n\n---\ntitle: \"Immunotechnology Cake Club\"\nformat: \n  dashboard: \n    logo: ./cake-emoji.png\n---\n\n```{r}\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n\n# Page 1\n## Row - Gender\n\n```{r}\n#| title: Who bakes better?\ncake_data %&gt;%\n    ggplot(aes(x = Gender, y = Score, fill = Gender)) +\n    geom_boxplot() +\n    theme_minimal() +\n    theme_bw() + \n    scale_fill_manual(values = c(\"#F5E8E1\", \"#D0BBA8\")) + \n    labs(x = \"Gender\", y = \"Score\") + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```\n\n# Page 2\n## Row - Temperature\n\n```{r}\n#| title: How does outdoor temperature influence final score?\ncake_data %&gt;%\n    ggplot(aes(x = Temperature, y = Score)) +\n    geom_line( color=\"darkgrey\") +\n    geom_point(shape=21, color=\"black\", fill=\"#DBD9DA\", size=6) + \n    theme_bw() + \n    theme(axis.text = element_text(size = 20),\n    axis.title = element_text(size = 20),\n    legend.text = element_text(size = 20), \n    legend.title = element_text(size = 20))\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#interactive-dashboards",
    "href": "topics/Quarto/slide_quarto2.html#interactive-dashboards",
    "title": "Advanced Quarto",
    "section": "Interactive dashboards",
    "text": "Interactive dashboards\n\nQuarto dashboards can include interactive Shiny components (e.g. a plot with sliders that control its inputs)\nQuarto dashboard with Shiny"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#extra-material",
    "href": "topics/Quarto/slide_quarto2.html#extra-material",
    "title": "Advanced Quarto",
    "section": "Extra Material",
    "text": "Extra Material\n\nOfficial quarto extensions\nAn awesome list of Quarto content\nA gallery of Quarto examples"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#sources",
    "href": "topics/Quarto/slide_quarto2.html#sources",
    "title": "Advanced Quarto",
    "section": "Sources",
    "text": "Sources\n\nQuarto Dashboards\nHello, Dashboards!\nQuarto Dashboard video by Charles Teague\nFrom Notebooks to Dashboards with Quarto\nDashboard layout\nDashboard options\nQuarto Dashboards - NCEAS"
  },
  {
    "objectID": "topics/Quarto/slide_quarto2.html#section",
    "href": "topics/Quarto/slide_quarto2.html#section",
    "title": "Advanced Quarto",
    "section": "",
    "text": "Thank you. Questions?"
  },
  {
    "objectID": "topics/Quarto/lab_quarto2.html",
    "href": "topics/Quarto/lab_quarto2.html",
    "title": "Quarto Dashboards",
    "section": "",
    "text": "Note\n\n\n\nThese are exercises to get you started with Quarto Dashboards. Refer to the official Quarto Dashboards documentation for help.\nBy the end of this exercise, you will be able to:\n\nCreate a basic Quarto dashboard\nBecome familiar with different components of a dashboard\nCustomize dashboard layout and appearance\nAdd dynamic components to your dashboard"
  },
  {
    "objectID": "topics/Quarto/lab_quarto2.html#other-features",
    "href": "topics/Quarto/lab_quarto2.html#other-features",
    "title": "Quarto Dashboards",
    "section": "2.1 Other features",
    "text": "2.1 Other features\nValue boxes\nValue boxes are a great way to prominently display simple values within a dashboard. For example, here is a dashboard row with three value boxes.\n\n## Row\n\n```{r}\n#| content: valuebox\n#| title: \"Sunny days\"\nlist(\n  icon = \"brightness-high-fill\",\n  color = \"warning\",\n  value = 14\n)\n```\n\n```{r}\n#| content: valuebox\n#| title: \"Snowy days\"\nlist(\n  icon = \"snow2\",\n  color = \"info\",\n  value = 5\n)\n```\n\n```{r}\n#| content: valuebox\n#| title: \"Rainy days\"\nlist(\n  icon = \"cloud-rain-heavy\",\n  color = \"secondary\",\n  value = 12\n)\n```\nThe icon used in value boxes can be any of the 2,000 available bootstrap icons.\nThe color can be any CSS color value, however there are some color aliases that are tuned specifically for dashboards that you might consider using by default:\n\n\n\nColor Alias\nDefault Theme Color(s)\n\n\n\n\nprimary\nBlue\n\n\nsecondary\nGray\n\n\nsuccess\nGreen\n\n\ninfo\nBright Blue\n\n\nwarning\nYellow/Orange\n\n\ndanger\nRed\n\n\nlight\nLight Gray\n\n\ndark\nBlack\n\n\n\nThe value can be a variable created previously within the document, or randomly assigned value as here.\nDashboard Theming\nQuarto Dashboards use same Bootstrap 5 based theming system as regular HTML documents (so themes you have built for HTML websites can also be used with dashboards). Use the theme option to choose a theme. Themes options are available here.\nformat:\n  dashboard:\n    theme: solar"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "Using the language of graphics: ggplot2\nBasic and advanced plotting in ggplot2\nSingle-cell data visualizations with Seurat\nQuarto notebooks and reports\nDynamic plotting with quarto\nInteractive web apps with Shiny\n\n\n\nUpdated: 12-05-2025 at 09:34:26 ."
  },
  {
    "objectID": "index.html#advanced-data-visualization",
    "href": "index.html#advanced-data-visualization",
    "title": "",
    "section": "",
    "text": "Using the language of graphics: ggplot2\nBasic and advanced plotting in ggplot2\nSingle-cell data visualizations with Seurat\nQuarto notebooks and reports\nDynamic plotting with quarto\nInteractive web apps with Shiny\n\n\n\nUpdated: 12-05-2025 at 09:34:26 ."
  },
  {
    "objectID": "home_syllabus.html",
    "href": "home_syllabus.html",
    "title": "Syllabus",
    "section": "",
    "text": "SyllabusLearning outcomesEntry requirements\n\n\nThe syllabus for this workshop are as follows.\n\nAdvanced level\n\nUsing the language of graphics: ggplot2\nBasic and advanced plotting in ggplot2\nSingle-cell data visualizations with Seurat\nQuarto notebooks and reports\nDynamic plotting with Quarto\nInteractive web apps with Shiny\n\nBeginner level\n\nHandle data in R for visualizations\nApply ggplot grammar to get publication-grade plots\nCombine different data and/or different plots\nPCA, Heatmaps, Phylogenetic trees and Maps\n\n\n\n\nAfter this workshop you should be able to:\n\nAdvanced level\n\nHandle data in R for visualizations\nFamiliarize with ggplot2 functions and techniques at adavanced level\nCombine different data and/or different plots that are of publication-ready\nCreate interactive documents with Quarto for data exploration and analysis\nWrite your own simple Shiny app in R\n\nBeginner level\n\nHandle data in R for visualizations\nApply the grammar efficiently in ggplot to obtain the desired plot\nCombine different data and/or different plots that are of publication-grade\n\n\n\n\n\nFamiliarity with R and R Studio\nPlotting using standard R graphics\nParticipants are expected to use their own computers with pre-installed R, R Studio and different R packages (detailed instructions will be given upon acceptance)."
  },
  {
    "objectID": "other/docker.html",
    "href": "other/docker.html",
    "title": "Docker Set Up",
    "section": "",
    "text": "Ensure that you install Docker or Docker Desktop before the course starts. If you do not have admin rights to install software on your laptop, talk to your local IT for help.\n\n\nFollow the installation instructions for your OS:\n\nUbuntu\nDebian\nFedora\n\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\n\n\n\nVisit this page to ensure you have the requirements necessary.\nDownload Docker Desktop for Mac with Apple Silicon or Intel Chip and follow the installation instructions.\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\n\n\n\n\n\n\nImportant\n\n\n\nOn Macs with Apple Silicon, in Docker Settings &gt; General, check Use Rosetta for x86/amd64 emulation on Apple Silicon.\n\n\n\n\n\nVisit this page to ensure you have the requirements necessary.\nDownload Docker Desktop for Windows and follow the installation instructions.\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\nAfter installation, open a PowerShell terminal and try to run docker --version. If that works, Docker is set up."
  },
  {
    "objectID": "other/docker.html#install-docker",
    "href": "other/docker.html#install-docker",
    "title": "Docker Set Up",
    "section": "",
    "text": "Ensure that you install Docker or Docker Desktop before the course starts. If you do not have admin rights to install software on your laptop, talk to your local IT for help.\n\n\nFollow the installation instructions for your OS:\n\nUbuntu\nDebian\nFedora\n\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\n\n\n\nVisit this page to ensure you have the requirements necessary.\nDownload Docker Desktop for Mac with Apple Silicon or Intel Chip and follow the installation instructions.\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\n\n\n\n\n\n\nImportant\n\n\n\nOn Macs with Apple Silicon, in Docker Settings &gt; General, check Use Rosetta for x86/amd64 emulation on Apple Silicon.\n\n\n\n\n\nVisit this page to ensure you have the requirements necessary.\nDownload Docker Desktop for Windows and follow the installation instructions.\nAfter Docker Desktop starts, open the Dashboard and go to Settings ( in the top-right) &gt; General. Follow the instructions in the General section.\nAfter installation, open a PowerShell terminal and try to run docker --version. If that works, Docker is set up."
  },
  {
    "objectID": "other/docker.html#test-installation",
    "href": "other/docker.html#test-installation",
    "title": "Docker Set Up",
    "section": "2 Test installation",
    "text": "2 Test installation\nFrom the terminal, type:\ndocker --version\nand then run your first image by typing:\ndocker run hello-world\nIf both work as expected, you successfully installed Docker Desktop!"
  },
  {
    "objectID": "other/docker.html#allocate-resources",
    "href": "other/docker.html#allocate-resources",
    "title": "Docker Set Up",
    "section": "3 Allocate resources",
    "text": "3 Allocate resources\nOpen the Docker Dashboard when Docker Desktop starts and go to Settings ( in the top-right) &gt; Resources to allocate the following resources:\n\nCPU limit: 8\n\nMemory limit: 12 GB\n\nSwap: 2 GB\n\nOn Windows, if WSL engine is used, you might not be able to change resources directly."
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#quarto",
    "href": "topics/Quarto/slide_quarto1.html#quarto",
    "title": "Introduction to Quarto",
    "section": "Quarto",
    "text": "Quarto\nAn open-source scientific and technical publishing system\n\nQuarto is a command line tool, not an R package\nQuarto combine codes, comments, and other features to tell a story about your data\nQuarto support numerous output formats\nQuarto documents are fully reproducible"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#installation",
    "href": "topics/Quarto/slide_quarto1.html#installation",
    "title": "Introduction to Quarto",
    "section": "Installation",
    "text": "Installation\n\nInstall the latest quarto executable\nR package quarto is a wrapper that runs quarto from R\nIf using RStudio, you need a version v2022.07.1 or newer\nVisual Studio Code along with quarto extension is a great option too"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#quarto-notebook",
    "href": "topics/Quarto/slide_quarto1.html#quarto-notebook",
    "title": "Introduction to Quarto",
    "section": "Quarto notebook",
    "text": "Quarto notebook\nQuarto file – a plain text file that has the extension .qmd\n\n\n---\ntitle: \"Palmer penguins\"\nauthor: \"Katja\"\ndate: today\nformat: \n  html: \n    code-fold: true\n    code-tools: true\n    toc: true\n    number-sections: true\nexecute:\n  warning: false\n---\n\n# Meet the penguins\nThe `palmerpenguins` data contains size measurements for three penguin species \nobserved on three islands in the Palmer Archipelago, Antarctica.\n\n![](./images/lter_penguins.png)\n\nThe three species of penguins have quite distinct \ndistributions of physical dimensions (@fig-penguins).\n\n```{r packages}\n#| label: load packages and data\n#| warning: false\n#| output: false\nlibrary(ggplot2)\nlibrary(palmerpenguins)\nlibrary(dplyr)\ndata(penguins, package = \"palmerpenguins\")\n```\n\n## Bill dimensions\n```{r bill dimensions}\n#| label: fig-penguins\n#| warning: false\n#| fig-cap: \"Bill dimensions of penguins across three species.\"\n#| fig-width: 10\n#| fig-height: 5\n\npenguins %&gt;%\n  ggplot(aes(x = bill_length_mm, y = bill_depth_mm)) +\n  geom_point(aes(color = species, \n                 shape = species),\n             size = 2) + \n  geom_smooth(method = \"lm\", se = FALSE, aes(color = species)) +\n  scale_color_manual(values = c(\"darkorange\",\"darkorchid\",\"cyan4\")) + \n  labs(color = \"Species\", shape = \"Species\") + \n  xlab(\"Bill length (mm)\") + ylab(\"Bill depth (mm)\") + \n  theme_bw()\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#quarto-document-anatomy",
    "href": "topics/Quarto/slide_quarto1.html#quarto-document-anatomy",
    "title": "Introduction to Quarto",
    "section": "Quarto document anatomy",
    "text": "Quarto document anatomy"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#yaml-metadata",
    "href": "topics/Quarto/slide_quarto1.html#yaml-metadata",
    "title": "Introduction to Quarto",
    "section": "YAML metadata",
    "text": "YAML metadata\n\n\n---\ntitle: \"Palmer penguins\"\nsubtitle: \"Intro to Quarto Exercise\"\nauthor: \"Katja\"\ndate: today\nformat: \n  html: \n    code-fold: true\n    code-tools: true\n    toc: true\n    number-sections: true\nexecute:\n  warning: false\n---\n\n\n\nBracketed by ---\nDefines document-wide options\nSpecifies the output format\nCan include several parameters"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#markdown-text",
    "href": "topics/Quarto/slide_quarto1.html#markdown-text",
    "title": "Introduction to Quarto",
    "section": "Markdown text",
    "text": "Markdown text\n\nImages, tables, text, etc.\nFreely add and format text using markdown\n\n\n# Meet the penguins\nThe `palmerpenguins` data contains size measurements for three penguin species \nobserved on three islands in the Palmer Archipelago, Antarctica.\n\n![](./images/lter_penguins.png)\n\nThe three species of penguins have quite distinct \ndistributions of physical dimensions (@fig-penguins).\n\n## Bill dimensions"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#code-chunks",
    "href": "topics/Quarto/slide_quarto1.html#code-chunks",
    "title": "Introduction to Quarto",
    "section": "Code chunks",
    "text": "Code chunks\n\n\n\nCode blocks are called code chunks\nEvaluate code and show its output\nSpecify global and/or local chunk options (e.g. figure dimensions)\nAlso works with other languages (e.g. Python)\n\n\n\n\n## Bill dimensions\n```{r bill dimensions}\n#| label: fig-penguins\n#| warning: false\n#| fig-cap: \"Bill dimensions of penguins across three species.\"\n#| fig-width: 10\n#| fig-height: 5\n\npenguins %&gt;%\n  ggplot(aes(x = bill_length_mm, y = bill_depth_mm)) +\n  geom_point(aes(color = species, \n                 shape = species),\n             size = 2) + \n  geom_smooth(method = \"lm\", se = FALSE, aes(color = species)) +\n  scale_color_manual(values = c(\"darkorange\",\"darkorchid\",\"cyan4\")) + \n  labs(color = \"Species\", shape = \"Species\") + \n  xlab(\"Bill length (mm)\") + ylab(\"Bill depth (mm)\") + \n  theme_bw()\n```"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#rendering-quarto-document",
    "href": "topics/Quarto/slide_quarto1.html#rendering-quarto-document",
    "title": "Introduction to Quarto",
    "section": "Rendering Quarto document",
    "text": "Rendering Quarto document\n\n\nLive preview\n\nFrom R console: quarto::quarto_preview(\"report.qmd\")\nFrom terminal: quarto preview report.qmd\n\n\n\n\n\nRender\n\nInteractively using the Render button\nFrom R console: quarto::quarto_render(\"report.qmd\")\nFrom terminal: quarto render report.qmd"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#how-rendering-works",
    "href": "topics/Quarto/slide_quarto1.html#how-rendering-works",
    "title": "Introduction to Quarto",
    "section": "How rendering works?",
    "text": "How rendering works?"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#output-formats",
    "href": "topics/Quarto/slide_quarto1.html#output-formats",
    "title": "Introduction to Quarto",
    "section": "Output formats",
    "text": "Output formats\n\n\nReports and general documents (HTML, PDF, Jupyter Notebook, Microsoft Word)\nPresentations (reveal.js, PowerPoint, Beamer)\nInteractive documents (Observable, R Shiny)\nBooks, blogs and websites\nJournal articles"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#moving-between-output-formats-is-straightforward",
    "href": "topics/Quarto/slide_quarto1.html#moving-between-output-formats-is-straightforward",
    "title": "Introduction to Quarto",
    "section": "Moving between output formats is straightforward",
    "text": "Moving between output formats is straightforward\n\n\n\nDocument HTML\n\n lesson-1.qmd\n\ntitle: \"Lesson 1\"\nformat: html\n\n\n\nDocument PDF\n\n lesson-1.qmd\n\ntitle: \"Lesson 1\"\nformat: pdf\n\n\n\nPresentation\n\n lesson-1.qmd\n\ntitle: \"Lesson 1\"\nformat: revealjs\n\n\n\nWebsite\n\n _quarto.yml\n\nproject:\n  type: website\n\nwebsite: \n  navbar: \n    left:\n      - lesson-1.qmd\n\n\n\n\nBook\n\n _quarto.yml\n\nproject:\n  type: book\n\nwebsite: \n  navbar: \n    left:\n      - lesson-1.qmd"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#key-advantages-of-quarto",
    "href": "topics/Quarto/slide_quarto1.html#key-advantages-of-quarto",
    "title": "Introduction to Quarto",
    "section": "Key advantages of Quarto",
    "text": "Key advantages of Quarto\n\n\nText, code snippets, and visualizations in a single document\nSupports multiple programming languages (R, Python, Julia, etc.)\nVarious output formats (HTML, PDF, presentations, etc.)\nCompatible with multiple editors (RStudio, VS Code, Jupyter Lab, etc.)\nInteractive elements (Shiny apps, HTML widgets, or JavaScript visualizations) can be incorporated directly into documents\nReproducible and transparent workflows\nEasy collaboration and sharing"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#sources",
    "href": "topics/Quarto/slide_quarto1.html#sources",
    "title": "Introduction to Quarto",
    "section": "Sources",
    "text": "Sources\n\n\nR for Data Science book\nHello Quarto\nGuides\nRaukR 2024 (Quarto by Roy Francis)\nGetting started with Quarto\nQuarto cheatsheet"
  },
  {
    "objectID": "topics/Quarto/slide_quarto1.html#section",
    "href": "topics/Quarto/slide_quarto1.html#section",
    "title": "Introduction to Quarto",
    "section": "",
    "text": "Thank you. Questions?"
  },
  {
    "objectID": "home_precourse.html",
    "href": "home_precourse.html",
    "title": "Precourse",
    "section": "",
    "text": "Download and install the latest version of R from r-project.org.\n\n\n\nInstall RStudio. RStudio provides you with tools like code editor with highlighting, project management, version control, package building, debugger, profiler and more. Visual Studio code is another good alternative to RStudio.\n\n\n\nDownload and install the latest version of Quarto from quarto.org.\n\n\n\nInstall all the R packages necessary for this course by opening an R terminal either in Rstudio or VScode and pasting the following command:\n\ninstall.packages(c(\"cowplot\",\"crosstalk\",\"dplyr\",\"DT\",\"gganimate\",\"ggiraph\",\n                    \"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggthemes\",\"grid\",\"gridExtra\",\n                    \"gt\", \"kableExtra\",\"leaflet\",\"palmerpenguins\",\"patchwork\",\n                    \"pheatmap\",\"plotly\",\"reshape2\",\"scales\",\"Seurat\",\"shiny\",\n                    \"tidyr\",\"tidyverse\",\"wesanderson\"), dependencies = TRUE)\n\n\n\n\n\n\n\nTip\n\n\n\nTo make sure that the installations went well, we will try to make a quick plot using the packages you just installed. In this plot, we try to see if there is correlation plot between BMI and average no.of steps taken by some volunteers per day. The data and the code for plotting is available here. Just render or preview the installation_check.qmd file in RStudio or VScode. and you should see the correlation plot, if all the packages are installed properly.\n\n\n\n\n\n\n\n\n Download course files\n\n\n\nPlease download all the necessary files from here and make sure that the directory tree looks similar to the one displayed in that page."
  },
  {
    "objectID": "home_precourse.html#installations",
    "href": "home_precourse.html#installations",
    "title": "Precourse",
    "section": "",
    "text": "Download and install the latest version of R from r-project.org.\n\n\n\nInstall RStudio. RStudio provides you with tools like code editor with highlighting, project management, version control, package building, debugger, profiler and more. Visual Studio code is another good alternative to RStudio.\n\n\n\nDownload and install the latest version of Quarto from quarto.org.\n\n\n\nInstall all the R packages necessary for this course by opening an R terminal either in Rstudio or VScode and pasting the following command:\n\ninstall.packages(c(\"cowplot\",\"crosstalk\",\"dplyr\",\"DT\",\"gganimate\",\"ggiraph\",\n                    \"ggplot2\",\"ggpubr\",\"ggrepel\",\"ggthemes\",\"grid\",\"gridExtra\",\n                    \"gt\", \"kableExtra\",\"leaflet\",\"palmerpenguins\",\"patchwork\",\n                    \"pheatmap\",\"plotly\",\"reshape2\",\"scales\",\"Seurat\",\"shiny\",\n                    \"tidyr\",\"tidyverse\",\"wesanderson\"), dependencies = TRUE)\n\n\n\n\n\n\n\nTip\n\n\n\nTo make sure that the installations went well, we will try to make a quick plot using the packages you just installed. In this plot, we try to see if there is correlation plot between BMI and average no.of steps taken by some volunteers per day. The data and the code for plotting is available here. Just render or preview the installation_check.qmd file in RStudio or VScode. and you should see the correlation plot, if all the packages are installed properly.\n\n\n\n\n\n\n\n\n Download course files\n\n\n\nPlease download all the necessary files from here and make sure that the directory tree looks similar to the one displayed in that page."
  },
  {
    "objectID": "home_precourse.html#hackmd",
    "href": "home_precourse.html#hackmd",
    "title": "Precourse",
    "section": " HackMD",
    "text": "HackMD\nWe will use the online note-keeping document from HackMD for our questions. Please click here to see the notebook. We would appreciate it a lot if you could write your questions and feedback here, so that all participants can learn from each other."
  },
  {
    "objectID": "home_precourse.html#preparations",
    "href": "home_precourse.html#preparations",
    "title": "Precourse",
    "section": " Preparations",
    "text": "Preparations\nTo prepare for the course, you can follow one of the links below to warm up your skills necessary for the course.\n\n\n\n\n\n\nTip\n\n\n\n\nBeginner-level: Basic warm-up exercises in R\nAdvanced-level: ggplot warm-up\n\n\n\n\n\n\n\n\n\n Docker\n\n\n\n\n\nIf you are more familiar with using Docker, all the tools necessary for the course are available as a Docker image. You can pull the image using the following command:\ndocker pull ghcr.io/nbisweden/workshop-adv-data-viz:latest\nIf you would like to try to install Docker and give it a try, please follow the instructions here\n\n Visual Studio code\nThe best and most efficient way to work with the Docker image is with VScode and the extension Dev Containers. Similar to RStudio or Posit, VScode is an IDE maintained by Microsoft and it is quite efficient and robust for all Operating systems.\n\nTo install VScode, follow the instructions here\nAfter successful installation of VScode and Docker, you can install the Dev Containers extension for VScode from here\nDownload the Dev Container file from here Make sure that all the course related files are in the same place as this .devcontainer.json hidden file\nThen in VScode, press Ctrl+Shift+P (Cmd+Shift+P for Mac users) followed by Dev Containers: Open Folder in Container to select the folder where you have all the files or Dev Containers: Reopen in Container, if you are already on VScode in the same directory.\nNow, if everything worked fine, a new window shoudl appear inside the Advanced Data Visualization container."
  },
  {
    "objectID": "data/Installation_check/installation_check.html",
    "href": "data/Installation_check/installation_check.html",
    "title": "Packages installation check",
    "section": "",
    "text": "1 Package installations worked!\n\n1.0.1 And here is the correlation test for the Toy dataset"
  },
  {
    "objectID": "home_info.html",
    "href": "home_info.html",
    "title": "Practical Info",
    "section": "",
    "text": "Lund_mv\n\n\n\n\n\n\n\n\n\n\nRoom E24\nBuilding 404\nMedicon Village\nScheelevägen 2\n223 63 Lund\nSweden\nFor Lund city buses, tram, regional buses and regional trains, use skanetrafiken.se. You can buy a ticket at the central station in Lund or at the regional bus (card only). You can also use the app Skånetrafiken From the Lund C the easiest is to take the tram from Clemens torget towards ESS and get off at Lund Ideontorget. The trip take about 5 minutes and a tram leaves about four times an hour.\n\n\n\n\n\nThe lunches during the course will be provided at Restaurant & Café Inspira located at Medicon Village which is 2 minutes walk from the course location. The location of the restaurant is here.\n\n\n\nThe restaurant for the dinner on the 2nd day will be at Valvet Steakhouse."
  },
  {
    "objectID": "home_info.html#location",
    "href": "home_info.html#location",
    "title": "Practical Info",
    "section": "",
    "text": "Lund_mv\n\n\n\n\n\n\n\n\n\n\nRoom E24\nBuilding 404\nMedicon Village\nScheelevägen 2\n223 63 Lund\nSweden\nFor Lund city buses, tram, regional buses and regional trains, use skanetrafiken.se. You can buy a ticket at the central station in Lund or at the regional bus (card only). You can also use the app Skånetrafiken From the Lund C the easiest is to take the tram from Clemens torget towards ESS and get off at Lund Ideontorget. The trip take about 5 minutes and a tram leaves about four times an hour.\n\n\n\n\n\nThe lunches during the course will be provided at Restaurant & Café Inspira located at Medicon Village which is 2 minutes walk from the course location. The location of the restaurant is here.\n\n\n\nThe restaurant for the dinner on the 2nd day will be at Valvet Steakhouse."
  },
  {
    "objectID": "home_info.html#contact",
    "href": "home_info.html#contact",
    "title": "Practical Info",
    "section": "Contact",
    "text": "Contact\nThis workshop is run by the National Bioinformatics Infrastructure Sweden (NBIS). NBIS is a platform that is part of SciLifeLab.\nIf you would like to get in touch with us regarding this workshop, please contact us.\nIf you would like to get in touch with us regarding the course at GitHub, kindly write to us at the issues page."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html",
    "href": "topics/Quarto/lab_quarto1.html",
    "title": "Introduction to Quarto",
    "section": "",
    "text": "Note\n\n\n\nThese are exercises to get you started with Quarto. Refer to the official Quarto documentation for help.\nBy the end of this exercise, you will be able to:\n\nCreate and render a Quarto document in RStudio.\nUnderstand the structure of a Quarto document, including the YAML header.\nAdd and format text using Markdown.\nInclude and customize code chunks.\nGenerate and embed visualizations.\nRender Quarto documents to different formats, such as HTML and PDF reports\nSet-up Quarto project"
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#text-formatting",
    "href": "topics/Quarto/lab_quarto1.html#text-formatting",
    "title": "Introduction to Quarto",
    "section": "3.1 Text formatting",
    "text": "3.1 Text formatting\nThis *italic text* becomes italic text.\nThis **bold text** becomes bold text. Subscript written like this H~2~O renders as H2O.\nSuperscript written like this 2^10^ renders as 210. This code format becomes code."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#headings",
    "href": "topics/Quarto/lab_quarto1.html#headings",
    "title": "Introduction to Quarto",
    "section": "3.2 Headings",
    "text": "3.2 Headings\n# Level 1 heading\n## Level 2 heading  \n### Level 3 heading  \n#### Level 4 heading"
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#lists",
    "href": "topics/Quarto/lab_quarto1.html#lists",
    "title": "Introduction to Quarto",
    "section": "3.3 Lists",
    "text": "3.3 Lists\n-   Bulleted list item 1\n\n-   Item 2\n\n    -   Item 2a\n\n    -   Item 2b\n\nBulleted list item 1\nItem 2\n\nItem 2a\nItem 2b\n\n\n1.  Numbered list item 1\n\n2.  Item 2.\n    The numbers are incremented automatically in the output.\n\nNumbered list item 1\nItem 2. The numbers are incremented automatically in the output."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#links",
    "href": "topics/Quarto/lab_quarto1.html#links",
    "title": "Introduction to Quarto",
    "section": "3.4 Links",
    "text": "3.4 Links\nLinks can be created using &lt;https://quarto.org&gt; which renders like https://quarto.org or using [this](https://quarto.org) which renders like this this."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#figures",
    "href": "topics/Quarto/lab_quarto1.html#figures",
    "title": "Introduction to Quarto",
    "section": "3.5 Figures",
    "text": "3.5 Figures\nThe figures in a Quarto document can be embedded (e.g., a PNG or JPEG file) or generated as a result of a code chunk.\nImages can be displayed from a relative local location using ![These are Palmer penguins](./images/lter_penguins.png).\n\n\n\nThese are Palmer penguins\n\n\nBy default, the image is displayed at full scale or until it fills the display width. The image dimension can be adjusted ![These are Palmer penguins](./images/lter_penguins.png){width=40%}.\n\n\n\nThese are Palmer penguins\n\n\n\n\n\n\n\n\nRStudio - Figure / Image\n\n\n\nTo embed an image from an external file, you can use the Insert menu in the Visual Editor in RStudio and select Figure / Image. This will open a menu where you can browse to the image you want to insert as well as add alternative text or caption to it and adjust its size. In the Visual Editor you can also simply paste an image from your clipboard into your document and RStudio will place a copy of that image in your project folder.\n\n\n\nIn your Quarto document, rename first header from # This is a header to Introduction. Replace existing markdown text under the first header with some text related to Quarto notebook, for example This is my first Quarto document. The goal is to build a Quarto report using different Quarto features. To existing markdown text add link to Quarto webpage. Save the document.\nCreate another header (level 1), Palmer penguins. Find some information about palmerpenguins dataset, and add markdown text under the second header. Add link to the palmerpenguins R package. Finally, download image of the three penguins and insert image to the document. Save the document and render."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#tables",
    "href": "topics/Quarto/lab_quarto1.html#tables",
    "title": "Introduction to Quarto",
    "section": "3.6 Tables",
    "text": "3.6 Tables\nSimilar to figures, you can include two types of tables in a Quarto document. They can be markdown tables that you create directly in your Quarto document (using the Insert Table menu in the Visual Editor in RStudio) or they can be tables generated as a result of a code chunk. Here is an example of markdown table known as a pipe table.\n| First Header | Second Header |\n|--------------|---------------|\n| Content Cell | Content Cell  |\n| Content Cell | Content Cell  |\n\n\n\nFirst Header\nSecond Header\n\n\n\n\nContent Cell\nContent Cell\n\n\nContent Cell\nContent Cell"
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#r-plots",
    "href": "topics/Quarto/lab_quarto1.html#r-plots",
    "title": "Introduction to Quarto",
    "section": "4.1 R plots",
    "text": "4.1 R plots\nIf you include a code chunk that generates a figure (e.g., includes a ggplot() call), the resulting figure will be automatically included in your Quarto document.\nR Plots can be plotted like below:\n```{r}\n#| fig-height: 6\n#| fig-width: 6\n\nggplot(penguins, aes(x = sex, fill = species)) +\n  geom_bar(alpha = 0.8) +\n  scale_fill_manual(values = c(\"darkorange\",\"purple\",\"cyan4\"), \n                    guide = FALSE) +\n  theme_minimal() +\n  facet_wrap(~species, ncol = 1) +\n  coord_flip()\n```\n\n\n\n\n\n\n\n\n\n\nCreate new header (level 1), named it Data visualization. Insert new r chunk where you will generate r plot using palmerpenguins dataset that we loaded in the previous step. Similar to the example above create a barplot where penguin counts for each species and island are shown. Specify executions options similar to the example above. Render the document.\n\n\n\n\n\n\n\n   Solution\n\n\n\n\n\n```{r}\n#| echo: false\n#| fig-height: 6\n#| fig-width: 6\n\nggplot(penguins, aes(x = island, fill = species)) +\n  geom_bar(alpha = 0.8) +\n  scale_fill_manual(values = c(\"darkorange\",\"purple\",\"cyan4\"), \n                    guide = FALSE) +\n  theme_minimal() +\n  facet_wrap(~species, ncol = 1) +\n  coord_flip()\n```\n\n\n\nThere are two chunk options related to figure sizes: fig-width and fig-height (expressed in inches). These allow you to experiment with your figures and make them look the way you want.\n\nModify these two parametrs, render the document and observe changes.\n\nYou can also add captions and their location using the fig-cap and cap-location code chunk options respectively.\n\nAdd a suitable caption and caption location (options: top, bottom, margin) to the figure and render.\n\n\n4.1.1 Cross-references\nA convenient way to be able to refer to figures in text is by adding a figure label, which will automatically add a figure number before your caption.\n\nAdd a suitable label to the plot generated above, e.g. label: fig-islands_by_penguins to the chunk options, then render the document again.\n\nNotice that the figure now has a number before the caption. Importantly, the label must start with fig- prefix for the numbering and cross-referencing to work. Cross-references use the @ symbol and the corresponding label.\nYou can thus write some markdown outside of a code chunk and refer to e.g. @fig-islands_by_penguins, as per the example here. Try this out by adding the following to your document:\nA plot of penguin count for each species on all islands is shown in @fig-islands_by_penguins.\n\n\n4.1.2 Subfigures\nSometimes you want to show multiple (sub) figures, and using Quarto you can create them without using a plotting library such as cowplot. This is possible with fig-subcap: chunk option.\nFor example:\n#| fig-subcap:\n#|     - Penguin count for each species of each sex\n#|     - Penguin count for each species on all islands\nThe layout of subfigures is controlled using the layout-ncol chunk option. To put multiple plots in a single row, set the layout-ncol to 2 for two plots, 3 for three plots, etc. This effectively sets out-width to “50%” for each of your plots if layout-ncol is 2, “33%” if layout-ncol is 3, etc. Depending on what you are trying to illustrate (e.g., show data or show plot variations), you might also tweak fig-width.\n\nCreate a new chunk and copy codes from steps above to obtain two figures. Set the fig-subcap: and layout-ncol: options and render the document."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#tables-1",
    "href": "topics/Quarto/lab_quarto1.html#tables-1",
    "title": "Introduction to Quarto",
    "section": "4.2 Tables",
    "text": "4.2 Tables\nLike mentioned earlier, two types of tables can be included in a Quarto document. Example below demonstrates table generated as a result of a code chunk. In order for a table to be cross-referenceable, its label must start with the tbl- prefix.\n```{r}\n#| label: tbl-penguins\n#| tbl-cap: Palmer penguins bill length, flipper length and body mass.\n#| tbl-cap-location: margin\n\nknitr::kable(\n    penguins[1:10, c(\"species\", \"bill_length_mm\", \"flipper_length_mm\", \"body_mass_g\")],\n    col.names = c(\"Species\", \"Bill length (mm)\", \"Flipper length (mm)\", \"Body mass (g)\")\n)\n```\n\nAdd this code chunk to your document and render it.\nChange tbl-cap-location: to top, render and observe what happens.\nUnder the chunk where you just generated the table, write some markdown text and refer to the table using cross-referencing."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#table-of-contents",
    "href": "topics/Quarto/lab_quarto1.html#table-of-contents",
    "title": "Introduction to Quarto",
    "section": "5.1 Table of contents",
    "text": "5.1 Table of contents\nTo make it easier for readers to navigate your document, you can use a table of contents. You just have to specify it using the toc in the YAML header. This is how the header would look like:\n---\ntitle: \"My first Quarto Document\"\nauthor: \"Katja\"\ndate: last-modified\ndate-format: “YYYY-MMM-DD\"\nformat: html\ntoc: true\n---\nTo specify the number of section levels to include in the table of contents toc-depth option can be used. Position of the table of contents can be set-up using the toc-location. The HTML format by default floats the table of contents to the right. You can alternatively position it at the left, or in the body. You can also customize the title used for the table of contents using the toc-title option, for example: toc-title: Contents.\n\nAdd toc, toc-depth and toc-location to your document and render it."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#section-numbering",
    "href": "topics/Quarto/lab_quarto1.html#section-numbering",
    "title": "Introduction to Quarto",
    "section": "5.2 Section numbering",
    "text": "5.2 Section numbering\nThis is another feature that can help browsing your document efficiently. It is very straightforward, you just need to specify number-sections: true in your YAML header. To specify the deepest level of heading to add numbers to (by default all headings are numbered) use the number-depth option."
  },
  {
    "objectID": "topics/Quarto/lab_quarto1.html#code-folding",
    "href": "topics/Quarto/lab_quarto1.html#code-folding",
    "title": "Introduction to Quarto",
    "section": "5.3 Code folding",
    "text": "5.3 Code folding\ncode-fold is one of the global options that are specified nested inside the format option, like so:\nformat:\n  html:\n    code-fold: true\n\nAdd the code-fold option to your document and render it.\n\nYou will see that Code button is generated and if you click on it chunk containing code will open. You can also use the code-summary chunk option to specify a different text to show with the folded code instead of the default Code, e.g. code-summary: Show the code.\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n\nAdd the code-fold and code-summary options to your document and render it.\n\nYou can also add the code-tools option, which will add a drop-down menu to toggle visibility of all code as well as the ability to view the source of the document.\n\nAdd the code-tools: true to your document and render it."
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#contents",
    "href": "topics/Shiny/slide_shiny2.html#contents",
    "title": "R Shiny - Part II",
    "section": "Contents",
    "text": "Contents\n\nReactivity\nObservers\nUpdating Widgets\nError Validation\nDownload"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactivity",
    "href": "topics/Shiny/slide_shiny2.html#reactivity",
    "title": "R Shiny - Part II",
    "section": "Reactivity",
    "text": "Reactivity\n\nCode doesn’t always run line-by-line (Non-linear execution)\nCode executes when dependencies change\n\n\nreactlog"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactives",
    "href": "topics/Shiny/slide_shiny2.html#reactives",
    "title": "R Shiny - Part II",
    "section": "Reactives",
    "text": "Reactives\nFunctions with reactive context\n\nreactive(): Defines an expression\nreactiveVal(): Defines single value\nreactiveValues(): Defines a list of values\n\nRegular function fn &lt;- function(): Runs wherever it is is used\nReactive function fn &lt;- reactive(): Runs only when input changes"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-context",
    "href": "topics/Shiny/slide_shiny2.html#reactive-context",
    "title": "R Shiny - Part II",
    "section": "Reactive context",
    "text": "Reactive context\nReactive values cannot be accessed outside a reactive context\n\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui = fluidPage(\n    numericInput(\"num\", \"Enter number\",\n                 value = 1),\n    textOutput(\"result\")\n  ),\n  server = function(input, output) {\n    val = input$num^2\n    output$result &lt;- renderText({\n      paste(\"Squared number is:\", val)\n    })\n  }\n)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-dynamics",
    "href": "topics/Shiny/slide_shiny2.html#reactive-dynamics",
    "title": "R Shiny - Part II",
    "section": "Reactive dynamics",
    "text": "Reactive dynamics\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui=fluidPage(\n    numericInput(\"num_input\",label=\"Observations\",value=50),\n    textOutput(\"text_output\")),\n  server=function(input,output) {\n    output$text_output &lt;- renderText({\n        mean(rnorm(input$num_input))\n    })\n  })"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-dynamics-1",
    "href": "topics/Shiny/slide_shiny2.html#reactive-dynamics-1",
    "title": "R Shiny - Part II",
    "section": "Reactive dynamics",
    "text": "Reactive dynamics\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui=fluidPage(\n    numericInput(\"num_input\",label=\"Observations\",value=50),\n    textOutput(\"text_output1\"), textOutput(\"text_output2\")),\n  server=function(input,output) {\n    output$text_output1 &lt;- renderText({\n      mean(rnorm(input$num_input))\n    })\n    output$text_output2 &lt;- renderText({\n      mean(rnorm(input$num_input))\n    })\n  })"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-dynamics-2",
    "href": "topics/Shiny/slide_shiny2.html#reactive-dynamics-2",
    "title": "R Shiny - Part II",
    "section": "Reactive dynamics",
    "text": "Reactive dynamics\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui=fluidPage(\n    numericInput(\"num_input\",label=\"Observations\",value=50),\n    textOutput(\"text_output1\"), textOutput(\"text_output2\")),\n  server=function(input,output) {\n    rand &lt;- function(x) rnorm(x)\n    output$text_output1 &lt;- renderText({\n      mean(rand(input$num_input))\n    })\n    output$text_output2 &lt;- renderText({\n      mean(rand(input$num_input))\n    })\n  })"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-dynamics-3",
    "href": "topics/Shiny/slide_shiny2.html#reactive-dynamics-3",
    "title": "R Shiny - Part II",
    "section": "Reactive dynamics",
    "text": "Reactive dynamics\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui=fluidPage(\n    numericInput(\"num_input\",label=\"Observations\",value=50),\n    textOutput(\"text_output1\"), textOutput(\"text_output2\")\n    ),\n  server=function(input,output) {\n    rand &lt;- reactive({ rnorm(input$num_input) })\n    output$text_output1 &lt;- renderText({\n      mean(rand())\n    })\n    output$text_output2 &lt;- renderText({\n      mean(rand())\n    })\n  })\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nReactive functions can be use to share output from a common source. They can be used to reduce computation for demanding functions. Reactive values cannot be accessed from outside the reactive environment.\nTry changing the reactive function\nrand &lt;- reactive({ rnorm(input$num_input) })\nto a regular function\nrand &lt;- function(){ rnorm(input$num_input) }\nSaving a reactlog,\n\n# reset log\nreactlogReset()\n# run the app and exit\n# save react log as text\ndput(shiny::reactlog(), file = \"assets/reactlog-reactivity-3.txt\")\n# open and visualize\n\"assets/reactlog-reactivity-3.txt\" |&gt;\n  dget() |&gt;\n  reactlog::reactlog_show()"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#reactive-values",
    "href": "topics/Shiny/slide_shiny2.html#reactive-values",
    "title": "R Shiny - Part II",
    "section": "Reactive values",
    "text": "Reactive values\n\nreactVal() reactValues()\nStore reactive values that can be accessed from any reactive context\n\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui = fluidPage(\n    actionButton(\"add\",\"Add\"),\n    actionButton(\"subtract\",\"Subtract\"),\n    textOutput(\"counter\")\n  ),\n  server = function(input, output) {\n    reactive_values &lt;- reactiveValues(counter = 0) \n    \n    observeEvent(input$add, {\n      reactive_values$counter &lt;- reactive_values$counter + 1\n    }) \n    observeEvent(input$subtract, {\n      reactive_values$counter &lt;- reactive_values$counter - 1\n    }) \n  \n    output$counter &lt;- renderText({\n      reactive_values$counter\n    })\n  }\n)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#controlling-reactivity-using-action-buttons",
    "href": "topics/Shiny/slide_shiny2.html#controlling-reactivity-using-action-buttons",
    "title": "R Shiny - Part II",
    "section": "Controlling reactivity using action buttons",
    "text": "Controlling reactivity using action buttons\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\nui = fluidPage(\n  h3(\"Temperature Converter\"),\n  numericInput(\"celsius\", \"Degrees Celsius:\", value = 0),\n  actionButton(\"btn_go\", \"Go!\"),\n  textOutput(\"fahrenheit\")\n),\n\nserver = function(input, output) {\n  evr &lt;- eventReactive(input$btn_go, {\n    paste(input$celsius, \"°C is \", (input$celsius * 9/5) + 32, \" °F\")\n  })\n  \n  output$fahrenheit &lt;- renderText({\n    evr()\n  })\n  \n  #output$fahrenheit &lt;- renderText({\n  #    paste(input$celsius, \"°C is \", (input$celsius * 9/5) + 32, \" °F\")\n  #  }) |&gt;\n  #  bindEvent(input$btn_go)\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#observers",
    "href": "topics/Shiny/slide_shiny2.html#observers",
    "title": "R Shiny - Part II",
    "section": "Observers",
    "text": "Observers\nReactive functions that automatically re-executes whenever its dependencies change. Usually used for side-effects rather than returning a value.\nobserve()\nDoesn’t return a value. Constantly runs as long as the app is alive.\nobserveEvent()\nSimilar to observe(), but only re-executes on specific event (like a button click). Doesn’t return a value.\neventReactive()\nSimilar to observeEvent(), but returns a value.\nbindEvent()\nBind an action to a specific event. Similar to observeEvent(), but allows for the event to be determined dynamically. Links an input (like a button) to an output and ensures that reactive expressions are only updated when bound event is triggered.\n\nObservers are reactive functions that run when their dependencies change similar to regular reactive output functions,affect HTML output. Observers are used for side-effect."
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#updating-widgets",
    "href": "topics/Shiny/slide_shiny2.html#updating-widgets",
    "title": "R Shiny - Part II",
    "section": "Updating widgets",
    "text": "Updating widgets\n\nWidgets can be updated once initialised.\n\n\n\nExample of a typical UI\n\n\n\nui=fluidPage(\n  selectInput(\"select-input\",label=\"selectInput\",choices=c(\"A\",\"B\",\"C\")),\n  numericInput(\"numeric-input\",label=\"numericInput\",value=5,min=1,max=10),\n  sliderInput(\"slider-input\",label=\"sliderInput\",value=5,min=1,max=10),\n)\n\n\n\n\n\nAdd third argument session to server function\nUpdate functions can be used to update input widgets\nReactive observer observe({}) monitors for a conditional change\n\n\n\nserver=function(input,output,session) {\n  observe({\n    if(something) {\n      updateSelectInput(session,\"select-input\",label=\"selectInput\",choices=c(\"D\",\"E\",\"F\"))\n      updateNumericInput(session,\"numeric-input\",label=\"numericInput\",value=10,min=1,max=10)\n      updateSliderInput(session,\"slider-input\",label=\"sliderInput\",value=8,min=1,max=10)\n    }\n  })\n}"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#updating-widgets-1",
    "href": "topics/Shiny/slide_shiny2.html#updating-widgets-1",
    "title": "R Shiny - Part II",
    "section": "Updating widgets",
    "text": "Updating widgets\n#| '!! shinylive warning !!': |\n#|   shinylive does not work in self-contained HTML documents.\n#|   Please set `embed-resources: false` in your metadata.\n#| standalone: true\n#| components: [editor, viewer]\nshinyApp(\n  ui = fluidPage(\n    selectInput(\"data\", \"Choose a dataset:\", choices = c(\"mtcars\", \"iris\", \"faithful\")),\n    selectInput(\"variable\", \"Choose a variable:\", choices = names(mtcars))\n  ),\n  \n  server = function(input, output, session) {\n    \n    dataset &lt;- reactive({\n      switch(input$data,\n             \"mtcars\" = mtcars,\n             \"iris\" = iris,\n             \"faithful\" = faithful)\n    })\n    \n    observe({\n      updateSelectInput(session,\"variable\",choices=names(dataset()))\n    })\n  }\n)"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#updating-widgets-2",
    "href": "topics/Shiny/slide_shiny2.html#updating-widgets-2",
    "title": "R Shiny - Part II",
    "section": "Updating widgets",
    "text": "Updating widgets\n\n\n\nInput function\nUpdate function\n\n\n\n\ncheckboxInput()\nupdateCheckboxInput()\n\n\ncheckboxGroupInput()\nupdateCheckboxGroupInput()\n\n\nradioButtons()\nupdateRadioButtons()\n\n\ndateInput()\nupdateDateInput()\n\n\ndateRangeInput()\nupdateDateRangeInput()\n\n\nfileInput()\n\n\n\nnumericInput()\nupdateNumericInput()\n\n\nsliderInput()\nupdateSliderInput()\n\n\ntextInput()\nupdateTextInput()\n\n\ntextAreaInput()\nupdateTextAreaInput()\n\n\npasswordInput()\n\n\n\nselectInput()\nupdateSelectInput()\n\n\nactionButton()\n\n\n\nsubmitButton()\n\n\n\ntabsetPanel()\nupdateTabsetPanel()\n\n\nnavbarPage()\nupdateNavbarPage()"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#error-validation",
    "href": "topics/Shiny/slide_shiny2.html#error-validation",
    "title": "R Shiny - Part II",
    "section": "Error validation",
    "text": "Error validation\n\nShiny returns an error with missing or incorrect values\n\n\n\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"\",\"mtcars\",\"faithful\",\"iris\")),\n  tableOutput(\"table_output\")\n),\nserver=function(input, output) {\n  getdata &lt;- reactive({ get(input$data_input,'package:datasets') })\n  output$table_output &lt;- renderTable({head(getdata())})\n})\n\n\n\n\n\n\n\n\nErrors can be handled in a controlled manner"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#error-validation-1",
    "href": "topics/Shiny/slide_shiny2.html#error-validation-1",
    "title": "R Shiny - Part II",
    "section": "Error validation",
    "text": "Error validation\n\n\nvalidate() can be used to check input\nvalidate() using need()\n\n\n\n\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"\",\"mtcars\",\"faithful\",\"iris\")),\n  tableOutput(\"table_output\")\n),\nserver=function(input, output) {\n  getdata &lt;- reactive({ \n  validate(need(try(input$data_input),\"Please select a data set\"))\n    get(input$data_input,'package:datasets') \n    })\n  output$table_output &lt;- renderTable({head(getdata())})\n})"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#error-validation-2",
    "href": "topics/Shiny/slide_shiny2.html#error-validation-2",
    "title": "R Shiny - Part II",
    "section": "Error validation",
    "text": "Error validation\n\nvalidate() using custom function\n\n\n\n\nvalfn &lt;- function(x) if(is.null(x) | is.na(x) | x==\"\") return(\"Input data is incorrect.\")\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"\",\"mtcars\",\"faithful\",\"iris\")),\n  tableOutput(\"table_output\")\n),\nserver=function(input,output) {\n  getdata &lt;- reactive({ \n  validate(valfn(try(input$data_input)))\n    get(input$data_input,'package:datasets')\n    })\n  output$table_output &lt;- renderTable({head(getdata())})\n})\n\n\n\n\n\n\n\n\nshiny::req() checks input variable and silently stops execution"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#download-data",
    "href": "topics/Shiny/slide_shiny2.html#download-data",
    "title": "R Shiny - Part II",
    "section": "Download • Data",
    "text": "Download • Data\n\nAdd button and downloadHandler() function\n\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"mtcars\",\"faithful\",\"iris\")),\n  textOutput(\"text_output\"),\n  downloadButton(\"button_download\",\"Download\")\n),\nserver=function(input, output) {\n  getdata &lt;- reactive({ get(input$data_input, 'package:datasets') })\n  output$text_output &lt;- renderText(paste0(\"Selected dataset: \",input$data_input))\n  \n  output$button_download &lt;- downloadHandler(\n  filename = function() {\n     paste0(input$data_input,\".csv\")\n   },\n  content = function(file) {\n     write.csv(getdata(),file,row.names=FALSE,quote=F)\n   })\n})\n\n\nRun in system browser if Rstudio browser doesn’t work"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#download-plots",
    "href": "topics/Shiny/slide_shiny2.html#download-plots",
    "title": "R Shiny - Part II",
    "section": "Download • Plots",
    "text": "Download • Plots\n\nshinyApp(\nui=fluidPage(\n  selectInput(\"data_input\",label=\"Select data\",\n              choices=c(\"mtcars\",\"faithful\",\"iris\")),\n  textOutput(\"text_output\"),\n  plotOutput(\"plot_output\",width=\"400px\"),\n  downloadButton(\"button_download\", \"Download\")\n),\nserver=function(input, output) {\n  getdata &lt;- reactive({ get(input$data_input, 'package:datasets') })\n  output$text_output &lt;- renderText(paste0(\"Selected dataset: \",input$data_input))\n  output$plot_output &lt;- renderPlot({hist(getdata()[, 1])})\n  \noutput$button_download &lt;- downloadHandler(\n  filename = function() {\n    paste0(input$data_input,\".png\")\n  },\n  content = function(file) {\n    png(file)\n    hist(getdata()[, 1])\n    dev.off()\n  })\n})\n\n\nRun in system browser if Rstudio browser doesn’t work\nSee usage of download buttons"
  },
  {
    "objectID": "topics/Shiny/slide_shiny2.html#section",
    "href": "topics/Shiny/slide_shiny2.html#section",
    "title": "R Shiny - Part II",
    "section": "",
    "text": "Thank you. Questions?\nSlide inspirations: Roy Francis (NBIS, RaukR2024)"
  },
  {
    "objectID": "home_schedule.html",
    "href": "home_schedule.html",
    "title": "Schedule",
    "section": "",
    "text": "Note\n\n\n\nBreaks are planned for approximately at 10:15 and 15:00 every day.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nTime\nTopic\nInstructor\nAssistants\n\n\n\n\n\n\n\n\n\n\n13-May-2025Tue\n\n\n\n\nRoom E24, Building 404, Medicon Village\n\n\n\n09:00 - 09:15\nWelcome\nMarkus Ringner\n\n\n\n09:15 - 10:15\n\n\nggplot basics\n\n\n\n\n\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n10:15 - 10:30\nBreak\n\n\n\n\n10:30 - 12:00\n\n\nAdvanced ggplot\n\n\n\n\n\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n12:00 - 13:00\nLunch\n\n\n\n\n13:00 - 13:30\n\nVector and bitmap\n\n\n\n\n\nMarkus Ringner\n\n\n\n13:30 - 15:00\n\nPCA plots\n\n\n\n\n\nMarkus Ringner\nLM, KK, LV\n\n\n15:00 - 15:30\nFika\n\n\n\n\n15:30 - 16:30\n\nSingle-cell\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n16:30 - 17:00\nWrap-up day I\nLokesh Mano\n\n\n\n\n\n\n\n\n\n14-May-2025Wed\n\n\n\n\nRoom E24, Building 404, Medicon Village\n\n\n\n09:00 - 10:15\n\n\nQuarto\n\n\n\n\n\n\n\n\n\n\nKatja Kozjek\nLM, MR, LV\n\n\n10:15 - 10:30\nBreak\n\n\n\n\n10:30 - 11:00\nQuarto (continuation)\nKatja Kozjek\nLM, MR, LV\n\n\n11:00 - 12:00\n\n\nDynamic plots\n\n\n\n\n\n\n\n\n\n\nKatja Kozjek\nLM, MR, LV\n\n\n12:00 - 13:00\nLunch\n\n\n\n\n13:00 - 14:00\nDynamic plots (continuation)\nKatja Kozjek\nLM, MR, LV\n\n\n14:00 - 15:00\n\n\nDashboards\n\n\n\n\n\n\n\n\n\n\nKatja Kozjek\nLM, MR, LV\n\n\n13:30 - 15:30\nFika\n\n\n\n\n15:30 - 16:30\nDashboards (continuation)\nKatja Kozjek\nLM, MR, LV\n\n\n16:30 - 17:00\nWrap-up day II\nLokesh Mano\n\n\n\n\n\n\n\n\n\n14-May-2025Wed\n\n\n\n\nRestaurang Valvet\n\n\n\n18:30 - 22:00\nDinner\n\n\n\n\n\n\n\n\n\n\n15-May-2025Thu\n\n\n\n\nRoom E24, Building 404, Medicon Village\n\n\n\n09:00 - 10:15\n\n\nIntro to R-Shiny\n\n\n\n\n\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n10:15 - 10:30\nBreak\n\n\n\n\n10:30 - 12:00\n\n\nR-Shiny part-II\n\n\n\n\n\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n12:00 - 13:00\nLunch\n\n\n\n\n13:00 - 15:00\n\n\nR-Shiny part-III\n\n\n\n\n\n\n\n\n\n\nLokesh Mano\nKK, MR, LV\n\n\n15:00 - 15:30\nFika\n\n\n\n\n15:30 - 16:30\nOwn shiny app\n\n\n\n\n16:30 - 16:45\nWrap-up day III\nLokesh Mano\n\n\n\n16:45 - 17:00\nClosing and feedback sessions\nLokesh Mano\n\n\n\n\n\n\n\n\n\n   Date    Venue    Slides    Lab    Video  \n\n LM: Lokesh Mano, MR: Markus Ringńer, LV: Louella Vasquez, KK: Katja Kozjek"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html",
    "href": "topics/ggplot/lab_pca.html",
    "title": "PCA and Gene Expression",
    "section": "",
    "text": "Let us first make a PCA object. For this, we will use the VST data, because it makes sense to use the normalized data for building the PCA. To run PCA, we use the R function prcomp(). It takes in a matrix where samples are rows and variables are columns. Therefore, we transpose our count matrix using the function t(). If we do not transpose, then PCA is run on the genes rather than the samples.\n\n\n\n\n\n\nNote\n\n\n\nIn this section, we will talk about PCA and how to plot a PCA object using ggplot. But the idea of plotting the results of any multi-dimensionality reduction methods like MDS/PCoA, NMDS, tSNE, UMAP and many others would in theory be the same as PCA.\n\n\n\ngc_vst &lt;- read.table(\"../../data/counts_vst.txt\", header = T, row.names = 1, sep = \"\\t\")\nvst_pca &lt;- prcomp(t(gc_vst))\n\nAfter you computer the PCA, if you type the object vst_pca$ and press TAB, you will notice that this R object has multiple vectors and data.frames within it. Some of the important ones are\n\nsdev: the standard deviations of the principal components\nx: the coordinates of the samples (observations) on the principal components.\nrotation: the matrix of variable loadings (columns are eigenvectors).\n\n\n\n\n\n\n\nNote\n\n\n\nThere are quite a few functions in R from different packages that can run PCA. So, one should look into the structure of the PCA object and import it into ggplot accordingly!\n\n\n\n\nFirst, let us look into plotting the variance explained by the top PCs.\n\nfrac_var &lt;- function(x) x^2/sum(x^2)\nlibrary(scales)\n\nvst_pca$sdev %&gt;% \n  as_tibble() %&gt;% \n  frac_var() %&gt;% \n  mutate(Comp = colnames(vst_pca$x)) %&gt;% \n  slice(1:9) %&gt;% \n  ggplot(aes(x=Comp, y = value)) + \n  geom_bar(stat = \"identity\", fill = \"#4DC5F9\") +\n  geom_hline(yintercept = 0.03, linetype=2) +\n  xlab(\"Principal Components\") +\n  scale_y_continuous(name = \"Variance Explained\", breaks = seq(0,0.8,0.1), labels = percent_format(accuracy = 5L)) +\n  theme_classic(base_size = 14)\n\n\n\n\n\n\n\n\n\n\n\nSo, looks like the first two components explain almost 85% of the data. Now, let us look into building a plot out of these components. From the above object, to get the scatter plot for the samples, we need to look into vst_pca$x. Then, we combine this data (as shown below) with the metadata to use different aesthetics and colors on the plot.\n\nvst_pca$x\n\n                 PC1        PC2        PC3         PC4        PC5         PC6\nSample_1  -34.641623 -13.435531   6.486032   0.2742477   6.406502   5.6703279\nSample_2  -35.431333 -13.277983   5.171377   0.3540945   3.953216   6.9974341\nSample_3  -35.938795 -14.544994   2.885351  11.3414829  -5.950082 -10.8497916\nSample_4  -20.672358   3.962013  -1.414301 -10.4819194   0.195882  -2.8003847\nSample_5  -21.155503   1.390981  -6.644132  -7.4002617  -6.505502   0.9771040\nSample_6  -22.662075   1.115504  -9.801356  -6.3107519  -7.431833   0.6592987\nSample_7    1.862762  24.449057  12.865650   4.4029501  -5.822040   4.1873901\nSample_8   -5.909698  13.992629 -14.775686  10.9789567   8.967097   2.2612207\nSample_9   -3.233544  17.321871   5.196746  -2.5142966   6.983077  -7.2580550\nSample_10  60.630406  -5.930071   6.993097  -5.7393184   4.254238  -2.6905179\nSample_11  56.669696 -10.638879  -5.860598  -0.4646609   5.216763  -1.3748865\nSample_12  60.482067  -4.404596  -1.102179   5.5594769 -10.267317   4.2208603\n                 PC7        PC8        PC9       PC10       PC11         PC12\nSample_1  -7.6896364 -7.5508580  1.1936551  0.2382806  0.7901002 4.899206e-14\nSample_2   5.8962070  9.0662471  1.0449651 -0.2284545 -1.3982703 5.084128e-14\nSample_3   1.4353811 -0.7461021 -1.4769949 -0.2114041  0.5247079 4.830164e-14\nSample_4   1.2992058 -2.3863551 -6.1089574  0.1510797 -9.1851796 4.973973e-14\nSample_5  -2.7487548  2.7353990 -4.5686381  6.6024251  6.9911571 4.892961e-14\nSample_6   2.1391551 -2.3567136  7.7925047 -6.9400619  1.3499685 5.057196e-14\nSample_7   5.2166866 -4.0805978 -0.2292610  1.4574679  1.2200771 5.066433e-14\nSample_8  -0.1684735  0.1448735 -3.9822133 -2.5610601  0.5182664 4.997044e-14\nSample_9  -5.4663572  5.2056738  6.4295279  1.6062665 -0.5133496 4.986636e-14\nSample_10  0.8277618  0.5767198 -4.9156730 -6.8596253  4.8748004 4.900247e-14\nSample_11  5.8886122 -3.9566331  4.4374522  6.9835771 -0.4457707 4.726081e-14\nSample_12 -6.6297877  3.3483466  0.3836326 -0.2384911 -4.7265074 5.044576e-14\n\n\nAnd, if you check the class() of this object, you will realize that this is a matrix. To be able to comfortably use tidyverse on this object, we must first convert this to a data.frame.\n\nvst_pca_all &lt;- vst_pca$x %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(var = \"Sample_ID\") %&gt;%\n  full_join(md, by = \"Sample_ID\")\n\n# Just to keep the order the right way.\nvst_pca_all$Sample_Name &lt;- factor(vst_pca_all$Sample_Name, levels = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\nvst_pca_all$Time &lt;- factor(vst_pca_all$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\nvst_pca_all$Replicate &lt;- factor(vst_pca_all$Replicate, levels = c(\"A\",\"B\",\"C\"))\n\nggplot(vst_pca_all, aes(x=PC1, y=PC2, color = Time)) +\n  geom_point(size = 3, aes(shape = Replicate)) +\n  geom_vline(xintercept = 0, linetype=2) +\n  geom_hline(yintercept = 0, linetype=2) +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank()) \n\n\n\n\n\n\n\n\n\n\n\nNow, let us say you want to plot the four genes that contribute the most to the four directions in the PCA plot. We could obtain them by looking at the vst_pca$rotation matrix. We could get those genes and their respective coordinates as follows.\n\ngenes.selected=vst_pca$rotation[c(which.max(vst_pca$rotation[,\"PC1\"]), which.min(vst_pca$rotation[,\"PC1\"]), which.max(vst_pca$rotation[,\"PC2\"]), which.min(vst_pca$rotation[,\"PC2\"])),c(\"PC1\",\"PC2\")]\ngenes.selected &lt;- genes.selected %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(var = \"Gene_ID\")\ngenes.selected\n\n\n  \n\n\n\nA loading plot shows how strongly each variable (gene) influences a principal component. As an example, we could plot the four genes we selected.\n\nggplot(genes.selected, aes(x=PC1, y=PC2)) +\n  geom_point() +\n  geom_segment(aes(xend=PC1, yend=PC2), x=0, y=0, color=\"Grey\") +\n  geom_label(aes(x=PC1, y=PC2, label=Gene_ID), size=2, vjust=\"outward\") +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank()) \n\n\n\n\n\n\n\n\n\n\n\nBy merging the PCA plot with the loadings plot one can create a so-called PCA bi-plot.\n\nscale=500\nggplot(data=vst_pca_all, mapping=aes(x=PC1, y=PC2)) +\n     geom_point(size = 3, aes(shape = Replicate, color = Time)) +\n     geom_vline(xintercept = 0, linetype=2) +\n     geom_hline(yintercept = 0, linetype=2) +\n     geom_segment(data=genes.selected, mapping=aes(xend=scale*PC1,yend=scale*PC2), x=0, y=0, arrow=arrow(), color=\"grey\") +\n     geom_label(data=genes.selected, mapping=aes(x=scale*PC1,y=scale*PC2, label=Gene_ID), size=2, hjust=\"outward\", vjust=\"outward\") +\n     theme_bw() +\n     theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank())\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nSimilarly, let us say, you have environmental variables (continuos variables like pH and so on) from the same samples and you would like to see how they would fit this bi-plot. One can use envfit() function from the vegan package, this function would return both the p-value and the coordinates of each of the variables in your environmental matrix. Then you could subset the significant variables and plot them in the same way as above."
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#variance-of-components-scree-plot",
    "href": "topics/ggplot/lab_pca.html#variance-of-components-scree-plot",
    "title": "PCA and Gene Expression",
    "section": "",
    "text": "First, let us look into plotting the variance explained by the top PCs.\n\nfrac_var &lt;- function(x) x^2/sum(x^2)\nlibrary(scales)\n\nvst_pca$sdev %&gt;% \n  as_tibble() %&gt;% \n  frac_var() %&gt;% \n  mutate(Comp = colnames(vst_pca$x)) %&gt;% \n  slice(1:9) %&gt;% \n  ggplot(aes(x=Comp, y = value)) + \n  geom_bar(stat = \"identity\", fill = \"#4DC5F9\") +\n  geom_hline(yintercept = 0.03, linetype=2) +\n  xlab(\"Principal Components\") +\n  scale_y_continuous(name = \"Variance Explained\", breaks = seq(0,0.8,0.1), labels = percent_format(accuracy = 5L)) +\n  theme_classic(base_size = 14)"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#pca-plot",
    "href": "topics/ggplot/lab_pca.html#pca-plot",
    "title": "PCA and Gene Expression",
    "section": "",
    "text": "So, looks like the first two components explain almost 85% of the data. Now, let us look into building a plot out of these components. From the above object, to get the scatter plot for the samples, we need to look into vst_pca$x. Then, we combine this data (as shown below) with the metadata to use different aesthetics and colors on the plot.\n\nvst_pca$x\n\n                 PC1        PC2        PC3         PC4        PC5         PC6\nSample_1  -34.641623 -13.435531   6.486032   0.2742477   6.406502   5.6703279\nSample_2  -35.431333 -13.277983   5.171377   0.3540945   3.953216   6.9974341\nSample_3  -35.938795 -14.544994   2.885351  11.3414829  -5.950082 -10.8497916\nSample_4  -20.672358   3.962013  -1.414301 -10.4819194   0.195882  -2.8003847\nSample_5  -21.155503   1.390981  -6.644132  -7.4002617  -6.505502   0.9771040\nSample_6  -22.662075   1.115504  -9.801356  -6.3107519  -7.431833   0.6592987\nSample_7    1.862762  24.449057  12.865650   4.4029501  -5.822040   4.1873901\nSample_8   -5.909698  13.992629 -14.775686  10.9789567   8.967097   2.2612207\nSample_9   -3.233544  17.321871   5.196746  -2.5142966   6.983077  -7.2580550\nSample_10  60.630406  -5.930071   6.993097  -5.7393184   4.254238  -2.6905179\nSample_11  56.669696 -10.638879  -5.860598  -0.4646609   5.216763  -1.3748865\nSample_12  60.482067  -4.404596  -1.102179   5.5594769 -10.267317   4.2208603\n                 PC7        PC8        PC9       PC10       PC11         PC12\nSample_1  -7.6896364 -7.5508580  1.1936551  0.2382806  0.7901002 4.899206e-14\nSample_2   5.8962070  9.0662471  1.0449651 -0.2284545 -1.3982703 5.084128e-14\nSample_3   1.4353811 -0.7461021 -1.4769949 -0.2114041  0.5247079 4.830164e-14\nSample_4   1.2992058 -2.3863551 -6.1089574  0.1510797 -9.1851796 4.973973e-14\nSample_5  -2.7487548  2.7353990 -4.5686381  6.6024251  6.9911571 4.892961e-14\nSample_6   2.1391551 -2.3567136  7.7925047 -6.9400619  1.3499685 5.057196e-14\nSample_7   5.2166866 -4.0805978 -0.2292610  1.4574679  1.2200771 5.066433e-14\nSample_8  -0.1684735  0.1448735 -3.9822133 -2.5610601  0.5182664 4.997044e-14\nSample_9  -5.4663572  5.2056738  6.4295279  1.6062665 -0.5133496 4.986636e-14\nSample_10  0.8277618  0.5767198 -4.9156730 -6.8596253  4.8748004 4.900247e-14\nSample_11  5.8886122 -3.9566331  4.4374522  6.9835771 -0.4457707 4.726081e-14\nSample_12 -6.6297877  3.3483466  0.3836326 -0.2384911 -4.7265074 5.044576e-14\n\n\nAnd, if you check the class() of this object, you will realize that this is a matrix. To be able to comfortably use tidyverse on this object, we must first convert this to a data.frame.\n\nvst_pca_all &lt;- vst_pca$x %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(var = \"Sample_ID\") %&gt;%\n  full_join(md, by = \"Sample_ID\")\n\n# Just to keep the order the right way.\nvst_pca_all$Sample_Name &lt;- factor(vst_pca_all$Sample_Name, levels = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\nvst_pca_all$Time &lt;- factor(vst_pca_all$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\nvst_pca_all$Replicate &lt;- factor(vst_pca_all$Replicate, levels = c(\"A\",\"B\",\"C\"))\n\nggplot(vst_pca_all, aes(x=PC1, y=PC2, color = Time)) +\n  geom_point(size = 3, aes(shape = Replicate)) +\n  geom_vline(xintercept = 0, linetype=2) +\n  geom_hline(yintercept = 0, linetype=2) +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank())"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#loading-plot",
    "href": "topics/ggplot/lab_pca.html#loading-plot",
    "title": "PCA and Gene Expression",
    "section": "",
    "text": "Now, let us say you want to plot the four genes that contribute the most to the four directions in the PCA plot. We could obtain them by looking at the vst_pca$rotation matrix. We could get those genes and their respective coordinates as follows.\n\ngenes.selected=vst_pca$rotation[c(which.max(vst_pca$rotation[,\"PC1\"]), which.min(vst_pca$rotation[,\"PC1\"]), which.max(vst_pca$rotation[,\"PC2\"]), which.min(vst_pca$rotation[,\"PC2\"])),c(\"PC1\",\"PC2\")]\ngenes.selected &lt;- genes.selected %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(var = \"Gene_ID\")\ngenes.selected\n\n\n  \n\n\n\nA loading plot shows how strongly each variable (gene) influences a principal component. As an example, we could plot the four genes we selected.\n\nggplot(genes.selected, aes(x=PC1, y=PC2)) +\n  geom_point() +\n  geom_segment(aes(xend=PC1, yend=PC2), x=0, y=0, color=\"Grey\") +\n  geom_label(aes(x=PC1, y=PC2, label=Gene_ID), size=2, vjust=\"outward\") +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank())"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#pca-bi-plot",
    "href": "topics/ggplot/lab_pca.html#pca-bi-plot",
    "title": "PCA and Gene Expression",
    "section": "",
    "text": "By merging the PCA plot with the loadings plot one can create a so-called PCA bi-plot.\n\nscale=500\nggplot(data=vst_pca_all, mapping=aes(x=PC1, y=PC2)) +\n     geom_point(size = 3, aes(shape = Replicate, color = Time)) +\n     geom_vline(xintercept = 0, linetype=2) +\n     geom_hline(yintercept = 0, linetype=2) +\n     geom_segment(data=genes.selected, mapping=aes(xend=scale*PC1,yend=scale*PC2), x=0, y=0, arrow=arrow(), color=\"grey\") +\n     geom_label(data=genes.selected, mapping=aes(x=scale*PC1,y=scale*PC2, label=Gene_ID), size=2, hjust=\"outward\", vjust=\"outward\") +\n     theme_bw() +\n     theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank())\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nSimilarly, let us say, you have environmental variables (continuos variables like pH and so on) from the same samples and you would like to see how they would fit this bi-plot. One can use envfit() function from the vegan package, this function would return both the p-value and the coordinates of each of the variables in your environmental matrix. Then you could subset the significant variables and plot them in the same way as above."
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#ma-plot.",
    "href": "topics/ggplot/lab_pca.html#ma-plot.",
    "title": "PCA and Gene Expression",
    "section": "3.1 MA plot.",
    "text": "3.1 MA plot.\nThe MA plot shows the distribution of mean expression vs log fold change for all genes.\n\nt2_vs_t0 %&gt;%\n  ggplot(aes(x = baseMean, y = log2FoldChange)) +\n  geom_point(color = \"grey70\") +\n  geom_hline(yintercept = 0) +\n  scale_x_log10(\"Mean of normalized counts\") +\n  ylab(\"log fold change\") +\n  theme_bw(base_size = 14) \n\n\n\n\n\n\n\n\nTry to think about each of the line of code that was used to generate the plot and what it’s function is. At the moment, the plot contains all genes that are colored the with same grey scale.\nYou can read more about MA plot and what it means here"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#exercise-ii",
    "href": "topics/ggplot/lab_pca.html#exercise-ii",
    "title": "PCA and Gene Expression",
    "section": "3.2 Exercise II",
    "text": "3.2 Exercise II\n\n\n\n\n\n\nTask 2.1\n\n\n\nThis plot would be even more informative when you color the significant genes differently. Would you be able to generate that plot?\n\n\n\n\n\n\nTip\n\n\n\nYou can filter the data that has adjusted p-value &lt; 0.05 and plot the points with a different color."
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#volcano-plot",
    "href": "topics/ggplot/lab_pca.html#volcano-plot",
    "title": "PCA and Gene Expression",
    "section": "3.3 Volcano plot",
    "text": "3.3 Volcano plot\nSimilar to MA plot, Volcano plot indicates the relation between the adjusted p-values and the log fold change. The adjusted p-value is transformed with -log10 on the y-axis, so that the smallest p-values appears at the top of the plot. The log2FoldChange values are plotted as they are on the x-axis, so that the down-regulated genes are on the left of the x-axis (-ve values) and the up-regulated genes are on the right of the x-axis (+ve values).\n\nt2_vs_t0 %&gt;%\n  ggplot(aes(x = log2FoldChange, y = -log10(padj))) +\n  geom_point(color = \"grey70\") +\n  geom_hline(yintercept = 1.3, linetype = 2) +\n  geom_point(data=filter(t2_vs_t0, padj &lt; 0.05), color = \"red\") +\n  ylab(\"Adjusted P-values in -log10\") +\n  theme_bw(base_size = 14) \n\n\n\n\n\n\n\n\nYou can read more about Volcano plot and what it means here"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#exercise-ii-1",
    "href": "topics/ggplot/lab_pca.html#exercise-ii-1",
    "title": "PCA and Gene Expression",
    "section": "3.4 Exercise II",
    "text": "3.4 Exercise II\n\n\n\n\n\n\nTask 2.2\n\n\n\nTry to code the plot below:\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nYou can find the gene name information in the file data/human_biomaRt_annotation.csv.\n\n\n\n\n\n\n\n\nTip\n\n\n\nYou can filter the data that has adjusted p-value &lt; 0.05 and log2FoldChange &gt; ±1.5 for the text part and use geom_text_repel()."
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#pheatmap",
    "href": "topics/ggplot/lab_pca.html#pheatmap",
    "title": "PCA and Gene Expression",
    "section": "4.1 pheatmap",
    "text": "4.1 pheatmap\n\n4.1.1 Samples\nFor heatmap, let us look into pheatmap library which is not part of ggplot, but it is a well known package for building heatmaps. It contains a lot of internal aesthetics that you can add that are very informative and intuitive. Let us first start with making a correlation matrix and plot it.\n\nvst_cor &lt;- as.matrix(cor(gc_vst, method=\"spearman\"))\nlibrary(pheatmap)\n\npheatmap(vst_cor,border_color=NA,annotation_col=md[,\"Time\",drop=F],\n         annotation_row=md[,\"Time\",drop=F],annotation_legend=T)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nIf you get a gpar() error, this is due to the reason that the metadata table you provide here does not have the sample ids as rownames. pheatmap maps the meta-data to the count data using rownames\n\n\nNow, this is based on a correlation matrix where you have a very simple square matrix with samples and their correlations to each to each other. Now let us look into how we can make a heatmap from an expression dataset.\n\n\n4.1.2 Genes\nFor this we will use the dataset: Time_t24_vs_t0.txt here that basically has the list of genes that are differentially expressed in t24 vs t0 and we would like to visualize this in an heatmap. To be more precise, we take the top 200 genes (based on fold change) with adjusted p-value &lt; 0.001. We use just these 200, for the sake of visualization. Let us take the t24 vs t0 here as these are most different based on our PCA.\n\nt24_vs_t0 &lt;- read.table(\"../../data/Time_t24_vs_t0.txt\", sep = \"\\t\", header = TRUE, row.names = 1)\n\ndiff_t24_vs_t0 &lt;- t24_vs_t0 %&gt;% \n  rownames_to_column('gene') %&gt;%\n  filter(padj &lt; 0.001) %&gt;%\n  arrange(desc(abs(log2FoldChange))) %&gt;%\n  head(200)\n\nhmap_t24_t0 &lt;- subset(gc_vst, rownames(gc_vst) %in% diff_t24_vs_t0$gene)\n\npheatmap(hmap_t24_t0, border_color=NA, annotation_col=md[,\"Time\",drop=F], annotation_row=NULL, annotation_legend=T)\n\n\n\n\n\n\n\n\nFurther, we can also customize using the pheatmap and also use the continuos color options we talked about in the earlier sections.\n\nlibrary(wesanderson)\nmd$Time &lt;- factor(md$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\n\npheatmap(hmap_t24_t0, color = wes_palette(\"Moonrise3\", 100, type = \"continuous\"), border_color=NA, annotation_col=md[,\"Time\",drop=F], annotation_row=NULL, annotation_legend=T, show_rownames = FALSE, fontsize = 14)"
  },
  {
    "objectID": "topics/ggplot/lab_pca.html#ggplot",
    "href": "topics/ggplot/lab_pca.html#ggplot",
    "title": "PCA and Gene Expression",
    "section": "4.2 ggplot",
    "text": "4.2 ggplot\nWe can use geom_tile() from ggplot to make heatmaps. The ggplot based heatmaps are, as we have seen for other cases, much more easier to customize.\n\nhmap_t24_t0_long &lt;- hmap_t24_t0 %&gt;%\n  rownames_to_column(var = \"Gene\") %&gt;%\n  gather(Sample_ID, VST, -Gene) %&gt;% \n  full_join(md, by = \"Sample_ID\")  \n\nhmap_t24_t0_long$Sample_Name &lt;- factor(hmap_t24_t0_long$Sample_Name, levels = \n                                        c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\nhmap_t24_t0_long$Time &lt;- factor(hmap_t24_t0_long$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\nhmap_t24_t0_long$Replicate &lt;- factor(hmap_t24_t0_long$Replicate, levels = c(\"A\",\"B\",\"C\"))\nhmap_t24_t0_long$Gene &lt;- factor(hmap_t24_t0_long$Gene, levels = row.names(hmap_t24_t0))\n\nggplot(hmap_t24_t0_long) +\n  geom_tile(aes(x = Sample_Name, y = Gene, fill = VST)) +\n  scale_fill_gradientn(colours = rainbow(5)) +\n  scale_x_discrete(limits = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t24_A\",\"t24_B\",\"t24_C\")) +\n  theme(axis.text.y = element_blank(), axis.ticks = element_blank()) \n\n\n\n\n\n\n\n\nAs you can see and compare that the heatmaps produced by pheatmap are way better than ggplot."
  },
  {
    "objectID": "topics/lab_solutions.html",
    "href": "topics/lab_solutions.html",
    "title": "Solutions",
    "section": "",
    "text": "The solutions given below are just one way of obtaining the desired plots! There are probably several different ways you could code to get the same plots."
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-i-and-ii",
    "href": "topics/lab_solutions.html#exercise-i-and-ii",
    "title": "Solutions",
    "section": "1.1 Exercise I and II",
    "text": "1.1 Exercise I and II\nFor these exercises the solutions are already part of the material, all you need to do is to replace the filename counts_raw.txt with each of the different files to look at the differences between different normalization methods."
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-iii",
    "href": "topics/lab_solutions.html#exercise-iii",
    "title": "Solutions",
    "section": "1.2 Exercise III",
    "text": "1.2 Exercise III\n\n1.2.1 Task 3.1\n\ngc_raw &lt;- read.table(file = \"../data/counts_raw.txt\", sep = \"\\t\", header = T)\ngc_filt &lt;- read.table(file = \"../data/counts_filtered.txt\", sep = \"\\t\", header = T)\ngc_vst &lt;- read.table(file = \"../data/counts_vst.txt\", sep = \"\\t\", header = T)\ngc_deseq &lt;- read.table(file = \"../data/counts_deseq2.txt\", sep = \"\\t\", header = T)\nmd &lt;- read.table(\"../data/metadata.csv\", header = T, sep = \";\")\nrownames(md) &lt;- md$Sample_ID\nse &lt;- function(x) sqrt(var(x)/length(x))\n\ngene_counts_all &lt;- \n  gc_raw %&gt;% gather(Sample_ID, Raw, -Gene) %&gt;%\n  full_join(gc_filt %&gt;% gather(Sample_ID, Filtered, -Gene), by = c(\"Gene\", \"Sample_ID\")) %&gt;%\n  full_join(gc_vst %&gt;% gather(Sample_ID, VST, -Gene), by = c(\"Gene\", \"Sample_ID\")) %&gt;%\n  full_join(gc_deseq %&gt;% gather(Sample_ID, DESeq2, -Gene), by = c(\"Gene\", \"Sample_ID\")) %&gt;%\n  gather(Method, count, Raw:DESeq2) %&gt;%\n  filter(!is.na(count)) %&gt;%\n  full_join(md, by = \"Sample_ID\")\n\ngene_counts_all$Time &lt;- factor(gene_counts_all$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\ngene_counts_all$Replicate &lt;- factor(gene_counts_all$Replicate, levels = c(\"A\",\"B\",\"C\"))\ngene_counts_all$Method &lt;- factor(gene_counts_all$Method, levels = c(\"Raw\",\"Filtered\",\"DESeq2\",\"VST\"))\n\ngene_counts_all %&gt;% \n  group_by(Time, Replicate, Method) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%\n  ggplot(aes(x= Time, y= mean, fill = Replicate)) + \n  geom_bar(position = position_dodge2(), stat = \"identity\") +\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), position = position_dodge2(.9, padding = .6)) +\n  facet_wrap(~Method, scales = \"free\")\n\n\n\n1.2.2 Task 3.2\n\ngene_counts_all %&gt;% \n  group_by(Time, Replicate, Method) %&gt;% \n  ggplot() +\n  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), fill = Time)) +\n  facet_wrap(~Method*Replicate, ncol = 3, scales = \"free\")"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-i",
    "href": "topics/lab_solutions.html#exercise-i",
    "title": "Solutions",
    "section": "2.1 Exercise I",
    "text": "2.1 Exercise I\n\ngc_long &lt;- gc_raw %&gt;%\n  gather(Sample_ID, count, -Gene) %&gt;% \n  full_join(md, by = \"Sample_ID\") %&gt;% \n  select(Sample_ID, everything()) %&gt;% \n  select(-c(Gene,count), c(Gene,count)) \ngc_long$Sample_Name &lt;- factor(gc_long$Sample_Name, levels = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\ngc_long$Time &lt;- factor(gc_long$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\ngc_long$Replicate &lt;- factor(gc_long$Replicate, levels = c(\"A\",\"B\",\"C\"))\n\ngc_long %&gt;% \n  group_by(Time, Replicate) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%\n  ggplot(aes(x=Time, y=mean, color = Replicate)) +\n  facet_wrap(~Replicate) +\n  geom_line(aes(group=1), stat= \"identity\", size = 2) +\n  scale_x_discrete(limits= c(\"t0\", \"t2\", \"t24\")) +\n  scale_y_continuous(limits = c(0.4,0.8), breaks = seq(0.4,0.8,0.05)) +\n  guides(color=\"none\") +\n  ylab(label = \"mean(log10(count + 1))\") +\n  theme_light() +\n  theme(axis.text = element_text(face=\"bold\", size=12),\n        axis.title = element_text(face=\"bold\", color = \"#C84DF9\", size=14),\n        axis.ticks = element_blank())"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-ii",
    "href": "topics/lab_solutions.html#exercise-ii",
    "title": "Solutions",
    "section": "2.2 Exercise II",
    "text": "2.2 Exercise II\n\nlibrary(ggpubr)\np4 &lt;- ggplot(data=iris,mapping=aes(x=Sepal.Length, y = Sepal.Width, color = Species)) +\n  geom_point(size = 3, alpha = 0.6) +\n  theme_classic(base_size = 12) +\n  border() \n\nd1 &lt;- ggplot(data=iris,mapping=aes(Sepal.Length, fill = Species)) +\n  geom_density(alpha = 0.6) +\n  theme_classic() +\n  clean_theme() +\n  theme(legend.position = \"none\")\n\nd2 &lt;- ggplot(data=iris,mapping=aes(Sepal.Width, fill = Species)) +\n  geom_density(alpha = 0.6) +\n  theme_classic() +\n  clean_theme() +\n  theme(legend.position = \"none\") +\n  rotate()\n\nggarrange(d1, NULL, p4, d2, \n          ncol = 2, nrow = 2,  align = \"hv\", \n          widths = c(3, 1), heights = c(1, 3),\n          common.legend = TRUE)"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-i-1",
    "href": "topics/lab_solutions.html#exercise-i-1",
    "title": "Solutions",
    "section": "3.1 Exercise I",
    "text": "3.1 Exercise I\n\nrow.names(gc_vst) &lt;- gc_vst$Gene\ngc_vst$Gene &lt;- NULL\ngc_dist &lt;- dist(t(gc_vst))\ngc_mds &lt;- cmdscale(gc_dist,eig=TRUE, k=2) \nEigenvalues &lt;- gc_mds$eig\nVariance &lt;- Eigenvalues / sum(Eigenvalues) \nVariance1 &lt;- 100 * signif(Variance[1], 3)\nVariance2 &lt;- 100 * signif(Variance[2], 3)\n\ngc_mds_long &lt;- gc_mds$points %&gt;%\n  as.data.frame() %&gt;%\n  rownames_to_column(\"Sample_ID\") %&gt;%\n  full_join(md, by = \"Sample_ID\")\n\ngc_mds_long$Sample_Name &lt;- factor(gc_mds_long$Sample_Name, levels = c(\"t0_A\",\"t0_B\",\"t0_C\",\"t2_A\",\"t2_B\",\"t2_C\",\"t6_A\",\"t6_B\",\"t6_C\",\"t24_A\",\"t24_B\",\"t24_C\"))\ngc_mds_long$Time &lt;- factor(gc_mds_long$Time, levels = c(\"t0\",\"t2\",\"t6\",\"t24\"))\ngc_mds_long$Replicate &lt;- factor(gc_mds_long$Replicate, levels = c(\"A\",\"B\",\"C\"))\n\nggplot(gc_mds_long, aes(x=V1, y=V2, color = Time)) +\n  geom_point(size = 3, aes(shape = Replicate)) +\n  xlab(paste(\"PCO1: \", Variance1, \"%\")) +\n  ylab(paste(\"PCO2: \", Variance2, \"%\")) +\n  geom_vline(xintercept = 0, linetype=2) +\n  geom_hline(yintercept = 0, linetype=2) +\n  theme_bw() +\n  theme(panel.grid.major = element_blank(), \n        panel.grid.minor = element_blank())"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-ii-1",
    "href": "topics/lab_solutions.html#exercise-ii-1",
    "title": "Solutions",
    "section": "3.2 Exercise II",
    "text": "3.2 Exercise II\n\n3.2.1 Task 2.1\n\nt2_vs_t0 &lt;- read.table(\"../data/Time_t2_vs_t0.txt\", sep = \"\\t\", header = TRUE, row.names = 1)\n\nt2_vs_t0 %&gt;%\n  ggplot() +\n  geom_point(aes(x = baseMean, y = log2FoldChange), color = \"grey70\") +\n  geom_point(data=filter(t2_vs_t0, padj &lt; 0.05), aes(x = baseMean, y = log2FoldChange), color = \"blue\") +\n  geom_hline(yintercept = 0) +\n  scale_x_log10(\"Mean of normalized counts\") +\n  ylab(\"log fold change\") +\n  theme_bw(base_size = 14) \n\n\n\n3.2.2 Task 2.2\n\nlibrary(ggrepel)\ngene_info &lt;- read.table(\"../data/human_biomaRt_annotation.csv\", sep = \";\", header = TRUE, row.names = 1)\nnames(gene_info) &lt;- c('gene_id', 'gene_name')\n\nde_w_names &lt;- t2_vs_t0 %&gt;%\n  rownames_to_column('gene_id') %&gt;%\n  left_join(gene_info, by = \"gene_id\")\n\nggplot(de_w_names, aes(x = log2FoldChange, y = -log10(padj))) +\n  geom_point(color = \"grey70\") +\n  geom_text_repel(data=filter(de_w_names, padj &lt; 0.05 & abs(log2FoldChange) &gt; 1.5), aes(x = log2FoldChange, y = -log10(padj), label=gene_name)) +\n  geom_hline(yintercept = 1.3, linetype = 2) +\n  geom_point(data=filter(t2_vs_t0, padj &lt; 0.05), color = \"red\") +\n  ylab(\"Adjusted P-values in -log10\") +\n  theme_bw(base_size = 14)"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-2.1",
    "href": "topics/lab_solutions.html#exercise-2.1",
    "title": "Solutions",
    "section": "4.1 Exercise 2.1",
    "text": "4.1 Exercise 2.1\n\nlibrary(palmerpenguins)\nlibrary(leaflet)\n\nleaflet() %&gt;%\n  addTiles() %&gt;%\n  #addProviderTiles(providers$Esri.WorldImagery) %&gt;%\n  setView(lng = -63.0, lat = -63.0, zoom = 5) %&gt;%\n  addCircleMarkers(data = island_coordinates, popup = c(\"Biscoe\", \"Dream\", \"Torgersen\"), color = \"green\")"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-3.1",
    "href": "topics/lab_solutions.html#exercise-3.1",
    "title": "Solutions",
    "section": "4.2 Exercise 3.1",
    "text": "4.2 Exercise 3.1\n\nlibrary(ggplot2)\nlibrary(plotly)\n\nplot_ly(msleep, x = ~sleep_rem, y = ~sleep_total, \n    color = ~vore, colors = \"Set1\", size=2, type = \"scatter\", mode = \"markers\")\n\nplot_ly(msleep, x = ~sleep_rem, y = ~sleep_total, \n    color = ~vore, colors = \"Set1\", size=2, type = \"scatter\", mode = \"lines\", line = list(width = 4))\n\n\nlibrary(ggplot2)\nlibrary(plotly)\n\np1 &lt;- plot_ly(msleep, x = ~vore, color = ~vore, colors = c(\"#88CCEE\", \"#CC6677\", \"#DDCC77\", \"#117733\")) %&gt;%\n  add_histogram()\n\np2 &lt;- plot_ly(msleep,  x = ~vore, y = ~sleep_total, color = ~vore, type = \"box\", size=2, colors = c(\"#88CCEE\", \"#CC6677\", \"#DDCC77\", \"#117733\"), showlegend = F)\n\nfig &lt;- subplot(p1, p2)\n\nfig %&gt;% \n    layout(title = \"Mammals Sleep Data\",\n    xaxis = list(title = \"Diet\"), \n    yaxis = list(title = \"Number of mammals\"),\n    xaxis2 = list(title = \"Diet\"), \n    yaxis2 = list(title = \"Total sleep (hours)\"), \n    legend=list(title=list(text=\"Diet\")))"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-4.1",
    "href": "topics/lab_solutions.html#exercise-4.1",
    "title": "Solutions",
    "section": "4.3 Exercise 4.1",
    "text": "4.3 Exercise 4.1\n\nlibrary(ggiraph)\n\nPlotData &lt;- ggplot(msleep,aes(x = vore, y = sleep_total, color = vore, tooltip = vore)) +\n    geom_boxplot_interactive() +\n    theme_minimal() +\n    scale_color_manual(values = c(\"#88CCEE\", \"#CC6677\", \"#DDCC77\", \"#117733\", \"#999999\")) + \n    labs(title = \"Mammals Sleep Data\", x = \"Diet\", y = \"Total Sleep (hours)\", color = \"Diet\")\n  \ngirafe(ggobj = PlotData)"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-5.1",
    "href": "topics/lab_solutions.html#exercise-5.1",
    "title": "Solutions",
    "section": "4.4 Exercise 5.1",
    "text": "4.4 Exercise 5.1\n\nlibrary(DT)\n\ngc &lt;- read.table(\"../../data/counts_raw.txt\", header = T, row.names = 1, sep = \"\\t\")\nmd &lt;- read.table(\"../../data/metadata.csv\", header = T, sep = \";\")\n\ndatatable(gc, options = list(pageLength = 10), caption = \"Table 1: Raw gene counts\") %&gt;% \n  formatStyle(\n    'Sample_1',\n    background = styleColorBar(msleep$sleep_rem, 'steelblue'),\n    backgroundSize = '100% 90%',\n    backgroundRepeat = 'no-repeat',\n    backgroundPosition = 'center') %&gt;%\n  formatStyle('Sample_3', color = styleInterval(c(8500, 15000), c('white', 'blue', 'green')),\n    backgroundColor = styleInterval(11000, c('gray', 'orange')))\n\ndatatable(md, options = list(pageLength = 10, order = list(list(4, 'desc'))), caption = \"Table 1: Metadata\")"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-6.1",
    "href": "topics/lab_solutions.html#exercise-6.1",
    "title": "Solutions",
    "section": "4.5 Exercise 6.1",
    "text": "4.5 Exercise 6.1\n\nlibrary(plotly)\nlibrary(ggplot2)\n\nshared_msleep &lt;- SharedData$new(msleep)\n\ngg_plot1 &lt;- ggplot(data = shared_msleep, aes(x = sleep_rem, y = sleep_total, color = vore)) +\n  geom_point() + theme_bw()\n\nplotly_plot1 &lt;- ggplotly(gg_plot1)\n\nbscols(widths = c(3, NA),\n    list(\n        filter_checkbox(\"vore\", \"Diet\", shared_msleep, ~vore, inline = TRUE),\n        filter_slider(\"sleep_total\", \"Total Sleep (hours)\", shared_msleep, ~sleep_total, width = \"100%\"),\n        filter_select(\"conservation\", \"Conservation Status\", shared_msleep, ~conservation)\n    ),\n    plotly_plot1)"
  },
  {
    "objectID": "topics/lab_solutions.html#exercise-7.1",
    "href": "topics/lab_solutions.html#exercise-7.1",
    "title": "Solutions",
    "section": "4.6 Exercise 7.1",
    "text": "4.6 Exercise 7.1\n---\ntitle: \"OJS example\"\nauthor: \"John Doe\"\ndate: last-modified\ndate-format: \"YYYY-MMM-DD\"\nformat: html\n---\n\n```{r}\nlibrary(ggplot2)\n```\n\n```{r}\ndt_sleep &lt;- msleep\nojs_define(ojsd = dt_sleep)\n```\n\n```{ojs}\nojsdata = transpose(ojsd)\n```\n\n```{ojs}\nviewof raw_table = Inputs.table(ojsdata)\n```\n\n```{ojs}\nviewof diets = Inputs.checkbox(\n  [\"herbi\", \"carni\", \"omni\", \"insecti\"], \n  { value: [\"herbi\", \"carni\"], \n    label: \"Diet:\"\n  }\n)\n```\n\n```{ojs}\nfiltered = ojsdata.filter(function(mammal) {\n    return diets.includes(mammal.vore);\n})\n```\n\n```{ojs}\nPlot.plot({\n  marks: [\n    Plot.dot(filtered, {\n      x:\"sleep_rem\",\n      y: \"sleep_total\",\n      fill: \"vore\"\n    })\n  ],\n  grid: true\n})"
  },
  {
    "objectID": "topics/Shiny/lab_shiny3.html",
    "href": "topics/Shiny/lab_shiny3.html",
    "title": "RShiny Lab: Part III",
    "section": "",
    "text": "In this section of the lab, we will try to go into making an app step-by-step. The idea basically is to first have a plan/backbone of the page that we want and then to go on populating the page in a step-wise manner!"
  },
  {
    "objectID": "topics/Shiny/lab_shiny3.html#layout",
    "href": "topics/Shiny/lab_shiny3.html#layout",
    "title": "RShiny Lab: Part III",
    "section": "5.1 Layout",
    "text": "5.1 Layout\nWe need to first have a plan for the app page, which UI elements to include and how they will be laid out and structured. My plan is as shown in the preview image.\n\nThere is a horizontal top bar for the title and two columns below. The left column will contain the input widgets and control. The right column will contain the plot output. Since, this is a commonly used layout, it is available as a predefined function in shiny called pageWithSidebar(). It takes three arguments headerPanel, sidebarPanel and mainPanel which is self explanatory.\n\nlibrary(shiny)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(cowplot)\n\ncov_data &lt;- read.table(\"data/shiny_app_data.csv\", sep = \",\", header = T)\ncov_data$date &lt;- as.Date(cov_data$date)\n\n\nshinyApp(\nui=fluidPage(\n  pageWithSidebar(\n    headerPanel(),\n    sidebarPanel(),\n    mainPanel())\n  ),\nserver=function(input,output){}\n)"
  },
  {
    "objectID": "topics/Shiny/lab_shiny3.html#ui",
    "href": "topics/Shiny/lab_shiny3.html#ui",
    "title": "RShiny Lab: Part III",
    "section": "5.2 UI",
    "text": "5.2 UI\nThen we fill in the panels with widgets and contents. The way I planned this app is to have two input values from user which are the countries to visualize and the duration, as I mentioned earlier. In addition I would also like to have the Update button to control the reactivity of the plots as we have learnt in the earlier session. So, the plots should update only when the Update button is pressed. I would also like to give the user the option to download these animated plots as pdf image.\nLet us start with including the countries as a checkboxGroupInput() input widget. It is self-explanatory that the countries you choose in this group can be accessed in the server() to subset the data just for these countries. The function comes with its own header label, followed by choices and you can use selected to have the default choice.\n\nshinyApp(\n    ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"USA\"),\n            ),\n            mainPanel())\n    ),\n    server=function(input,output){}\n)\n\n\nNow that we got the countries-input sorted out, let us now add the duration of the period, a user would like to visualize the data for. We can add this by doing the following:\n\nshinyApp(\n    ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"USA\"),\n                h3(\"Duration\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           dateInput(\"in_duration_date_start\",\"From\",value=\"2020-02-15\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           dateInput(\"in_duration_date_end\",\"To\",value=\"2021-07-25\")\n                    )\n                )\n            ),\n            mainPanel())\n    ),\n    server=function(input,output){}\n)\n\n\nWe have defined a part of the side bar panel with a title Duration. fluidRow() is an html tag used to create rows. Above, in the side bar panel, a row is defined and two columns are defined inside. Each column is filled with date input widgets for start and end dates. We use the columns here to place date input widgets side by side. To place widgets one below the other, the columns can simply be removed.\nNow let us add the last part of the sidebar panel where we add actionButtons for us to be able to do Update and Download.\n\nshinyApp(\n    ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"USA\"),\n                h3(\"Duration\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           dateInput(\"in_duration_date_start\",\"From\",value=\"2020-02-15\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           dateInput(\"in_duration_date_end\",\"To\",value=\"2021-07-25\")\n                    )\n                ),\n                h3(\"Plot controls\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           actionButton(\"click\", \"Update\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           downloadButton('download', 'Download')\n                    ),\n                )\n            ),\n            mainPanel()\n            )\n    ),\n    server=function(input,output){}\n)\n\n\nNow we can finalize the UI part by adding the interface for the plotOutput()s. So basically we want two rows with two columns. We can add this by using fluidRow() as we have done before:\n\nshinyApp(\n    ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"USA\"),\n                h3(\"Duration\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           dateInput(\"in_duration_date_start\",\"From\",value=\"2020-02-15\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           dateInput(\"in_duration_date_end\",\"To\",value=\"2021-07-25\")\n                    )\n                ),\n                h3(\"Plot controls\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           actionButton(\"click\", \"Update\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           downloadButton('download', 'Download')\n                    ),\n                )\n            ),\n            mainPanel(\n                fluidRow(\n                    column(width = 6, plotOutput(\"casesPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"hospitalPlot\",  width=\"100%\"))\n                ),\n                fluidRow(\n                    column(width = 6, plotOutput(\"fatalPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"vaccinePlot\",  width=\"100%\"))\n                )\n            )\n            )\n    ),\n    server=function(input,output){}\n)\n\nThe UI is set for now! Now let us move-on to the server part and then eventually figure-out if we have to come back to the UI part again for changes!"
  },
  {
    "objectID": "topics/Shiny/lab_shiny3.html#server",
    "href": "topics/Shiny/lab_shiny3.html#server",
    "title": "RShiny Lab: Part III",
    "section": "5.3 Server",
    "text": "5.3 Server\nThe first thing that I would like to do here is to make sure that the inputs we get from the user are valid for our data!\n\n5.3.1 Error validation\nAs I have mentioned before, we have two inputs from the user and let us start with the country! We need to make sure that the user has selected at-least one country! For this, I would also make some changes in the ui part where I would like to show an error message, when the user has not selected a country! For this I would use conditionalPanel() where the panel appears if the condition is satisfied. Similarly, we want the selected duration to be between 2020-02-15 and 2021-07-25, so I would create another conditionalPanel() for this input. So, the ui part of the app would look like below:\n\n ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"USA\"),\n                conditionalPanel(condition = \"input.countries == ''\",\n                                 textOutput('error_country')),\n                h3(\"Duration\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           dateInput(\"in_duration_date_start\",\"From\",value=\"2020-02-15\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           dateInput(\"in_duration_date_end\",\"To\",value=\"2021-07-25\")\n                    )\n                ),\n                conditionalPanel(condition = \"input.in_duration_date_start &lt; as.Date('2020-02-15') || input.in_duration_date_end &lt; as.Date('2020-02-15') || input.in_duration_date_start &gt; as.Date('2021-07-25') || input.in_duration_date_end &gt; as.Date('2021-07-25')\",\n                                 textOutput('error_duration')),\n                h3(\"Plot controls\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           actionButton(\"click\", \"Update\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           downloadButton('download', 'Download')\n                    ),\n                )\n            ),\n            mainPanel(\n                fluidRow(\n                    column(width = 6, plotOutput(\"casesPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"hospitalPlot\",  width=\"100%\"))\n                ),\n                fluidRow(\n                    column(width = 6, plotOutput(\"fatalPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"vaccinePlot\",  width=\"100%\"))\n                )\n            )\n          )\n)\n\n Note the syntax with input.countries inside the conditionalPanel(). This is different from how you would normally use it as input$countries within the server.\nWe will render the output error message in the server part when those above mentioned conditions satisfy. This I would do it in combination with the observeEvent() function in relation to our Update button in the sidebar! So, as soon as that button is clicked, we need to check if the input values are good! The actual error validation part here I do it with the combination of functions validate() and need(). So, the server would like:\n\nserver=function(input,output){\n        \n        observeEvent(input$click, {\n            output$error_country &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$countries != '', 'You must select at-least one country'\n                    )\n                )\n            })\n            output$error_duration &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$in_duration_date_start &gt; as.Date('2020-02-14') & input$in_duration_date_end &gt; as.Date('2020-02-14') & input$in_duration_date_start &lt; as.Date('2021-07-26') & input$in_duration_date_end &lt; as.Date('2021-07-26'), \n                                'You must select the duration between 2020-02-15 and 2021-07-25'\n                    )\n                )\n            })\n            shiny::req(input$countries)\n        })\n}\n\n Note that the conditional statement with need() is a little different from the conditionalPanel(). The conditions we use in these two functions are basically the negation of each other. In need(): the options as we want and in conditionalPanel(): the options are suppose to check for the wrong values.\nI include req() as well for the countries, so that the plots are not made when there are no countries specified.\n\n\n5.3.2 Subset and plots\nWe subset the data of our interest simply using the filter() function from dplyr package.\n\nserver=function(input,output){\n        \n        observeEvent(input$click, {\n            output$error_country &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$countries != '', 'You must select at-least one country'\n                    )\n                )\n            })\n            output$error_duration &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$in_duration_date_start &gt; as.Date('2020-02-14') & input$in_duration_date_end &gt; as.Date('2020-02-14') & input$in_duration_date_start &lt; as.Date('2021-07-26') & input$in_duration_date_end &lt; as.Date('2021-07-26'), \n                                'You must select the duration between 2020-02-15 and 2021-07-25'\n                    )\n                )\n            })\n            shiny::req(input$countries)\n            \n            subset_covdata &lt;- cov_data %&gt;%\n                filter(location %in% input$countries) %&gt;%\n                filter(date &gt;= input$in_duration_date_start) %&gt;%\n                filter(date &lt;= input$in_duration_date_end)\n\n        })\n    }\n\nThen we use our plotting strategy that we already looked at before! We simply use that code for the four different plots that we want to populate in the mainPanel(). As you would expect, we will use the renderPlot() function to render these plots on the panel. So, finally we should have a properly working app based on the code below:\n\nlibrary(shiny)\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(cowplot)\n\ncov_data &lt;- read.table(\"data/shiny_app_data.csv\", sep = \",\", header = T)\ncov_data$date &lt;- as.Date(cov_data$date)\n\nvalfn_country &lt;- function(x) if(is.null(x) | is.na(x) | x==\"\") return(\"You must select at-least one country\")\nvalfn_date &lt;- function(x) if(x &lt; as.Date('2020-02-15') | x &gt; as.Date('2021-07-25')) return(\"You must select the 'from' and 'to' dates between 2020-02-15 and 2021-07-25\")\n\nshinyApp(\n    ui=fluidPage(\n        pageWithSidebar(\n            headerPanel(title=\"Personalized Visualization of the SARS-Cov-II Pandemic\",windowTitle=\"Covid Data\"),\n            sidebarPanel(\n                checkboxGroupInput(\"countries\", label = h3(\"Countries\"), \n                                   choices = list(\"France\" = \"France\", \"Germany\" = \"Germany\", \"India\" = \"India\", \"Sweden\" = \"Sweden\", \"UK\" = \"UK\", \"USA\" = \"USA\"),\n                                   selected = \"France\"),\n                conditionalPanel(condition = \"input.countries == ''\",\n                                 textOutput('error_country')),\n                h3(\"Duration\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           dateInput(\"in_duration_date_start\",\"From\",value=\"2020-02-15\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           dateInput(\"in_duration_date_end\",\"To\",value=\"2021-07-25\")\n                    )\n                ),\n                conditionalPanel(condition = \"input.in_duration_date_start &lt; as.Date('2020-02-15') || input.in_duration_date_end &lt; as.Date('2020-02-15') || input.in_duration_date_start &gt; as.Date('2021-07-25') || input.in_duration_date_end &gt; as.Date('2021-07-25')\",\n                                 textOutput('error_duration')),\n                h3(\"Plot controls\"),\n                fluidRow(\n                    column(6,style=list(\"padding-right: 5px;\"),\n                           actionButton(\"click\", \"Update\")\n                    ),\n                    column(6,style=list(\"padding-left: 5px;\"),\n                           downloadButton('download', 'Download')\n                    ),\n                )\n            ),\n            mainPanel(\n                fluidRow(\n                    column(width = 6, plotOutput(\"casesPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"hospitalPlot\",  width=\"100%\"))\n                ),\n                fluidRow(\n                    column(width = 6, plotOutput(\"fatalPlot\",  width=\"100%\")),\n                    column(width = 6, plotOutput(\"vaccinePlot\",  width=\"100%\"))\n                )\n            )\n            )\n    ),\n    server=function(input,output){\n        \n        observeEvent(input$click, {\n            output$error_country &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$countries != '', 'You must select at-least one country'\n                    )\n                )\n            })\n            output$error_duration &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$in_duration_date_start &gt; as.Date('2020-02-14') & input$in_duration_date_end &gt; as.Date('2020-02-14') & input$in_duration_date_start &lt; as.Date('2021-07-26') & input$in_duration_date_end &lt; as.Date('2021-07-26'), \n                                'You must select the duration between 2020-02-15 and 2021-07-25'\n                    )\n                )\n            })\n            shiny::req(input$countries)\n            \n            subset_covdata &lt;- cov_data %&gt;%\n                filter(location %in% input$countries) %&gt;%\n                filter(date &gt;= input$in_duration_date_start) %&gt;%\n                filter(date &lt;= input$in_duration_date_end)\n            \n            p1 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_cases_per_million, group = location, color = location)) +\n                geom_line() +\n                theme_bw() +\n                scale_x_date(date_labels = \"%b-%Y\") \n            \n            output$casesPlot &lt;- renderPlot({p1})\n            \n            p2 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=icu_patients_per_million, group = location, color = location)) +\n                geom_line() +\n                theme_bw() +\n                scale_x_date(date_labels = \"%b-%Y\") \n            \n            output$hospitalPlot &lt;- renderPlot({p2})\n            \n            p3 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_deaths_per_million, group = location, color = location)) +\n                geom_line() +\n                theme_bw() +\n                scale_x_date(date_labels = \"%b-%Y\") \n            \n            output$fatalPlot &lt;- renderPlot({p3})\n            \n            p4 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=people_vaccinated_per_hundred, group = location, color = location)) +\n                geom_line() +\n                theme_bw() +\n                scale_x_date(date_labels = \"%b-%Y\") \n            \n            output$vaccinePlot &lt;- renderPlot({p4})\n\n                \n        })\n        \n        \n    }\n)\n\n\nNow let us make these plots look a little bit more prettier!\n\np1 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_cases_per_million, group = location, color = location)) +\n                geom_line(show.legend = F) +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), axis.title.x = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"New cases per million\")\n            \n            \n            output$casesPlot &lt;- renderPlot({p1})\n            \n            p2 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=icu_patients_per_million, group = location, color = location)) +\n                geom_line() +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), axis.title.x = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"ICU admissions per million\")\n            \n            output$hospitalPlot &lt;- renderPlot({p2})\n            \n            p3 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_deaths_per_million, group = location, color = location)) +\n                geom_line(show.legend = F) +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"Fatalities per million\")\n            \n            output$fatalPlot &lt;- renderPlot({p3})\n            \n            p4 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=people_vaccinated_per_hundred, group = location, color = location)) +\n                geom_line() +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"Percent vaccinated\")\n            \n            output$vaccinePlot &lt;- renderPlot({p4})\n\n\n\n5.3.3 Downloading\nNow let us look into the last part of the app, which is to download these plots together in a PDF document. For this we use the function downloadHandler().\n\nserver=function(input,output){\n        \n        observeEvent(input$click, {\n            output$error_country &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$countries != '', 'You must select at-least one country'\n                    )\n                )\n            })\n            output$error_duration &lt;- renderText({\n                shiny::validate(\n                    shiny::need(input$in_duration_date_start &gt; as.Date('2020-02-14') & input$in_duration_date_end &gt; as.Date('2020-02-14') & input$in_duration_date_start &lt; as.Date('2021-07-26') & input$in_duration_date_end &lt; as.Date('2021-07-26'), \n                                'You must select the duration between 2020-02-15 and 2021-07-25'\n                    )\n                )\n            })\n            shiny::req(input$countries)\n            \n            subset_covdata &lt;- cov_data %&gt;%\n                filter(location %in% input$countries) %&gt;%\n                filter(date &gt;= input$in_duration_date_start) %&gt;%\n                filter(date &lt;= input$in_duration_date_end)\n            \n            p1 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_cases_per_million, group = location, color = location)) +\n                geom_line(show.legend = F) +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), axis.title.x = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"New cases per million\")\n            \n            \n            output$casesPlot &lt;- renderPlot({p1})\n            \n            p2 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=icu_patients_per_million, group = location, color = location)) +\n                geom_line() +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), axis.title.x = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"ICU admissions per million\")\n            \n            output$hospitalPlot &lt;- renderPlot({p2})\n            \n            p3 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=new_deaths_per_million, group = location, color = location)) +\n                geom_line(show.legend = F) +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"Fatalities per million\")\n            \n            output$fatalPlot &lt;- renderPlot({p3})\n            \n            p4 &lt;- subset_covdata %&gt;%\n                ggplot(aes(x= date, y=people_vaccinated_per_hundred, group = location, color = location)) +\n                geom_line() +\n                theme_bw(base_size = 16) +\n                scale_x_date(date_labels = \"%b-%Y\") +\n                xlab(label = \"Time-Line\") +\n                theme(axis.title.y = element_blank(), legend.title = element_blank()) +\n                ggtitle(label = \"Percent vaccinated\")\n            \n            output$vaccinePlot &lt;- renderPlot({p4})\n            \n            output$download &lt;- downloadHandler(\n                filename =\"Personal_covdata.pdf\",\n                content = function(file){\n                    pdf(NULL)\n                    #plot_grid(p1, p2, p3, p4, nrow = 2)\n                    ggsave(file, plot=plot_grid(p1, p2, p3, p4, nrow = 2), dpi = 300, width = 10, height = 8, units = \"in\")\n                }\n            )\n            \n        })\n}\n\n Notice that the downloadHandler() is inside the observeEvent(), so that the values and the plots can be accessed smoothly! Here, I also show an example of how you can use ggsave() and plot_grid() within the download handler."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#contents",
    "href": "topics/ggplot/slide_gg2.html#contents",
    "title": "Advanced ggplot",
    "section": "Contents",
    "text": "Contents\n\nAxis\nStats\nTheme\nLegends\nCombining-plots\nSaving plots\nExtensions\nHelp"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#axis",
    "href": "topics/ggplot/slide_gg2.html#axis",
    "title": "Advanced ggplot",
    "section": "Axis",
    "text": "Axis\n\nscales: x, y\nsyntax: scale_&lt;axis&gt;_&lt;type&gt;\narguments: name, limits, breaks, labels"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#axis-scales",
    "href": "topics/ggplot/slide_gg2.html#axis-scales",
    "title": "Advanced ggplot",
    "section": "Axis • Scales",
    "text": "Axis • Scales\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#coordinate-systems",
    "href": "topics/ggplot/slide_gg2.html#coordinate-systems",
    "title": "Advanced ggplot",
    "section": "Coordinate Systems",
    "text": "Coordinate Systems\n\n\n\n\n\n\ncoord_cartesian(xlim=c(2,8)) for zooming in\ncoord_map for controlling limits on maps\ncoord_polar"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#coordinate-systems-1",
    "href": "topics/ggplot/slide_gg2.html#coordinate-systems-1",
    "title": "Advanced ggplot",
    "section": "Coordinate Systems",
    "text": "Coordinate Systems\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#stats",
    "href": "topics/ggplot/slide_gg2.html#stats",
    "title": "Advanced ggplot",
    "section": "Stats",
    "text": "Stats\n\nStats compute new variables from input data.\n\n\n\nGeoms have default stats.\n\n\nx &lt;- ggplot(penguins) + geom_bar(aes(x=flipper_length_mm),stat=\"bin\")\ny &lt;- ggplot(penguins) + geom_bar(aes(x=species),stat=\"count\")\nz &lt;- ggplot(penguins) + geom_bar(aes(x=species,y=flipper_length_mm),stat=\"identity\")\nwrap_plots(x,y,z,nrow=1)"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#stats-1",
    "href": "topics/ggplot/slide_gg2.html#stats-1",
    "title": "Advanced ggplot",
    "section": "Stats",
    "text": "Stats\n\nPlots can be built with stats.\n\n\nx &lt;- ggplot(penguins) + stat_bin(aes(x=flipper_length_mm),geom=\"bar\")\ny &lt;- ggplot(penguins) + stat_count(aes(x=species),geom=\"bar\")\nz &lt;- ggplot(penguins) + stat_identity(aes(x=species,y=flipper_length_mm),geom=\"bar\")\nwrap_plots(x,y,z,nrow=1)\n\n\n\n\nNormally the data is plotted directly from input as it is.\nSome plots require the data to be computed or transformed. Eg. boxplot, histograms, smoothing, predictions, regression etc."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#stats-2",
    "href": "topics/ggplot/slide_gg2.html#stats-2",
    "title": "Advanced ggplot",
    "section": "Stats",
    "text": "Stats\n\nStats have default geoms.\n\n\n\n\n\n\n\nplot\nstat\ngeom\n\n\n\n\nhistogram\nbin\nbar\n\n\nsmooth\nsmooth\nline\n\n\nboxplot\nboxplot\nboxplot\n\n\ndensity\ndensity\nline\n\n\nfreqpoly\nfreqpoly\nline\n\n\n\n\n\n\n\n\nUse args(geom_bar) to check arguments."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#stats-3",
    "href": "topics/ggplot/slide_gg2.html#stats-3",
    "title": "Advanced ggplot",
    "section": "Stats",
    "text": "Stats\n\nstat_compare_means() from the package ggpubr.\n\n\n\nggplot(penguins, aes(x=species,y=flipper_length_mm, fill=species)) + \n  geom_boxplot() + \n  ggpubr::stat_compare_means()"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#stats-4",
    "href": "topics/ggplot/slide_gg2.html#stats-4",
    "title": "Advanced ggplot",
    "section": "Stats",
    "text": "Stats\n\nstat_compare_means() from the package ggpubr.\n\n\n\nmy_comparisons &lt;- list( c(\"Adelie\", \"Chinstrap\"), c(\"Chinstrap\", \"Gentoo\"), c(\"Adelie\", \"Gentoo\") )\nggplot(penguins, aes(x=species,y=flipper_length_mm, fill=species)) + \n  geom_boxplot() + \n  ggpubr::stat_compare_means(comparisons = my_comparisons, method = \"t.test\")"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#theme",
    "href": "topics/ggplot/slide_gg2.html#theme",
    "title": "Advanced ggplot",
    "section": "Theme",
    "text": "Theme\n\nModify non-data plot elements/appearance\nAxis labels, panel colors, legend appearance etc\nSave a particular appearance for reuse\n?theme"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#theme-1",
    "href": "topics/ggplot/slide_gg2.html#theme-1",
    "title": "Advanced ggplot",
    "section": "Theme",
    "text": "Theme\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page.\n\n\n\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#theme-text",
    "href": "topics/ggplot/slide_gg2.html#theme-text",
    "title": "Advanced ggplot",
    "section": "Theme • Text",
    "text": "Theme • Text\n\n\nelement_text(family=NULL,face=NULL,color=NULL,size=NULL,hjust=NULL,\n             vjust=NULL, angle=NULL,lineheight=NULL,margin = NULL)\n\n\n\n\n\np &lt;- p + theme(\n    axis.title=element_text(color=\"#e41a1c\"),\n    axis.text=element_text(color=\"#377eb8\"),\n    plot.title=element_text(color=\"#4daf4a\"),\n    plot.subtitle=element_text(color=\"#984ea3\"),\n    legend.text=element_text(color=\"#ff7f00\"),\n    legend.title=element_text(color=\"#ffff33\"),\n    strip.text=element_text(color=\"#a65628\")\n)"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#theme-rect",
    "href": "topics/ggplot/slide_gg2.html#theme-rect",
    "title": "Advanced ggplot",
    "section": "Theme • Rect",
    "text": "Theme • Rect\n\n\nelement_rect(fill=NULL,color=NULL,size=NULL,linetype=NULL)\n\n\n\n\n\np &lt;- p + theme(\n    plot.background=element_rect(fill=\"#b3e2cd\"),\n    panel.background=element_rect(fill=\"#fdcdac\"),\n    panel.border=element_rect(fill=NA,color=\"#cbd5e8\",size=3),\n    legend.background=element_rect(fill=\"#f4cae4\"),\n    legend.box.background=element_rect(fill=\"#e6f5c9\"),\n    strip.background=element_rect(fill=\"#fff2ae\")\n)"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#theme-reuse",
    "href": "topics/ggplot/slide_gg2.html#theme-reuse",
    "title": "Advanced ggplot",
    "section": "Theme • Reuse",
    "text": "Theme • Reuse\n\n\nnewtheme &lt;- theme_bw() + theme(\n  axis.ticks=element_blank(),\n  panel.background=element_rect(fill=\"white\"),\n  panel.grid.minor=element_blank(),\n  panel.grid.major.x=element_blank(),\n  panel.grid.major.y=element_line(size=0.3,color=\"grey90\"),\n  panel.border=element_blank(),\n  legend.position=\"top\",\n  legend.justification=\"right\"\n)\n\n\n\n\n\n\np\n\n\n\n\n\n\n\n\n\n\n\n\np + newtheme"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#legend-theme",
    "href": "topics/ggplot/slide_gg2.html#legend-theme",
    "title": "Advanced ggplot",
    "section": "Legend • Theme",
    "text": "Legend • Theme\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#legend-geom",
    "href": "topics/ggplot/slide_gg2.html#legend-geom",
    "title": "Advanced ggplot",
    "section": "Legend • Geom",
    "text": "Legend • Geom\n\nPlease enable JavaScript to experience the dynamic code cell content on this page."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#combining-plots",
    "href": "topics/ggplot/slide_gg2.html#combining-plots",
    "title": "Advanced ggplot",
    "section": "Combining Plots",
    "text": "Combining Plots\n\np &lt;- ggplot(penguins,aes(x=species,y=bill_length_mm,color=island))+geom_point()\nq &lt;- ggplot(penguins,aes(x=species,y=body_mass_g,fill=island))+geom_bar(stat=\"identity\")\npatchwork::wrap_plots(p,q)\n\n\nRefer to patchwork documentation. Some notable alternatives are ggpubr and cowplot.\n\nCombining two or more ggplot2 plots is often required and several packages exist to help with this situation. Some functions allow plots to be placed adjacently, also allowing varying heights or widths of each plot. Some functions allow one plot to be plotted on another plot like a subset plot. Here are alternative options.\n\ngridExtra::grid.arrange(p,q,ncol=2)\nggpubr::ggarrange(p,q,ncol=2,widths=c(1.5,1),common.legend=T)\ncowplot::plot_grid()"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#saving-plots",
    "href": "topics/ggplot/slide_gg2.html#saving-plots",
    "title": "Advanced ggplot",
    "section": "Saving plots",
    "text": "Saving plots\n\np &lt;- ggplot(iris,aes(Petal.Length,Sepal.Length,color=Species))+\n  geom_point()\n\n\nggplot2 plots can be saved just like base plots\n\n\npng(\"plot.png\",height=5,width=7,units=\"cm\",res=200)\nprint(p)\ndev.off()\n\n\nggplot2 package offers a convenient function\n\n\nggsave(\"plot.png\",p,height=5,width=7,units=\"cm\",dpi=200,type=\"cairo\")\n\n\nNote that default units in png is pixels while in ggsave it’s inches"
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#extensions",
    "href": "topics/ggplot/slide_gg2.html#extensions",
    "title": "Advanced ggplot",
    "section": "Extensions",
    "text": "Extensions\n\nggrepel: Text labels including overlap control\nggforce: Circles, splines, hulls, voronoi etc\nggpmisc: Miscellaneaous features\nggthemes: Set of extra themes\n\nggthemr: More themes\n\nggsci: Color palettes for scales\n\nggmap: Dedicated to mapping\n\nggraph: Network graphs\n\nggiraph: Converting ggplot2 to interactive graphics\n\nA collection of ggplot extension packages: https://exts.ggplot2.tidyverse.org/.\nCurated list of ggplot2 links: https://github.com/erikgahner/awesome-ggplot2."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#learning-help",
    "href": "topics/ggplot/slide_gg2.html#learning-help",
    "title": "Advanced ggplot",
    "section": "Learning & Help",
    "text": "Learning & Help\n\n\n\nggplot2 book\n\n\nThe R cookbook\n\n\n\n\nggplot2 official reference\n\nRStudio cheatsheet\n\nr-statistics ggplot2 cheatsheet\n\nStackOverflow\n\nBlogs, R-Bloggers, Cedric Scherer etc."
  },
  {
    "objectID": "topics/ggplot/slide_gg2.html#section",
    "href": "topics/ggplot/slide_gg2.html#section",
    "title": "Advanced ggplot",
    "section": "",
    "text": "Thank you. Questions?"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html",
    "href": "topics/ggplot/lab_gg2.html",
    "title": "Advanced ggplot",
    "section": "",
    "text": "Now that we have covered the important aspects of ggplot, meaning getting the actual plot you wanted, let us now look into secondary elements of the plot."
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#breaks",
    "href": "topics/ggplot/lab_gg2.html#breaks",
    "title": "Advanced ggplot",
    "section": "1.1 Breaks",
    "text": "1.1 Breaks\nIf we look at the iris data plot that we made before:\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Sepal.Width))+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\nThe continuous x axis breaks are with 2,4,6 and so on. If we would like to have 1,2,3… We change this using scale_x_continuous() and breaks.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\") +\n  scale_x_continuous(breaks = 1:7)\n\n\n\n\n\n\n\n\nYou can do the same with y-axis.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\") +\n  scale_x_continuous(breaks = 1:7) +\n  scale_y_continuous(breaks = seq(0,3,0.5))"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#limits",
    "href": "topics/ggplot/lab_gg2.html#limits",
    "title": "Advanced ggplot",
    "section": "1.2 Limits",
    "text": "1.2 Limits\nBy using limits, we can also decide on the parts to plot to be shown:\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species)) +\n  geom_smooth(method=\"lm\") +\n  scale_x_continuous(limits=c(3, 7))\n\n\n\n\n\n\n\n\nWe can do the same with discrete x values like in the case of our gene counts dataset.\n\ngc_long %&gt;% \n  group_by(Time, Replicate) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%\n  ggplot(aes(x=Time, y=mean, fill = Replicate)) + \n  geom_col() + \n  scale_x_discrete(limits=c(\"t0\",\"t24\"))\n\n\n\n\n\n\n\n\nOne can also use xlim() and ylim() functions that function the same as limits with scale_x_continous() or scale_x_discrete()"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#names",
    "href": "topics/ggplot/lab_gg2.html#names",
    "title": "Advanced ggplot",
    "section": "1.3 Names",
    "text": "1.3 Names\nYou can also customize the axis labels using the name option within scale_x_continous and scale_y_continous.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\") +\n  scale_x_continuous(name = \"Length\", breaks = 1:7) +\n  scale_y_continuous(name = \"Width\", breaks = seq(0,3,0.5))\n\n\n\n\n\n\n\n\nwith labels in combination with the scales package, one can change or make the unit of the axis look more comprehensible, when needed. Like using percentage option or scientific option.\n\nlibrary(scales)\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\") +\n  scale_y_continuous(name = \"Width\", breaks = seq(0,3,0.5), labels = scientific)"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#editing-legends",
    "href": "topics/ggplot/lab_gg2.html#editing-legends",
    "title": "Advanced ggplot",
    "section": "2.1 Editing legends",
    "text": "2.1 Editing legends\nThe legends can be edited by scale_&lt;aesthetic&gt;_&lt;discrete or continous&gt; function that we have been using. Take the below figure for example, we have the Sepal.Width and the Species with the size and color aesthetics respectively.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\")\n\n\n\n\n\n\n\n\nLet’s try to edit the legends here like mentioned before:\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(size=Sepal.Width, color=Species))+\n  geom_smooth(method=\"lm\") +\n  scale_size_continuous(name = \"Width of Sepal\") +\n  scale_color_discrete(name = \"Organism\", labels = c(\"Iris setosa\", \"Iris versicolor\", \"Iris virginica\"))"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#moving-legends",
    "href": "topics/ggplot/lab_gg2.html#moving-legends",
    "title": "Advanced ggplot",
    "section": "2.2 Moving legends",
    "text": "2.2 Moving legends\nLegends can be moved around using theme.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species,size=Sepal.Width)) +\n  theme(legend.position=\"top\",\n        legend.justification=\"right\")\n\n\n\n\n\n\n\n\nLegend rows can be controlled in a finer manner.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+\n  geom_point(aes(color=Species,size=Sepal.Width))+\n  guides(size=guide_legend(nrow=2,byrow=TRUE),\n         color=guide_legend(nrow=3,byrow=T))+\n  theme(legend.position=\"top\",\n        legend.justification=\"right\")"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#axis-style",
    "href": "topics/ggplot/lab_gg2.html#axis-style",
    "title": "Advanced ggplot",
    "section": "3.1 Axis style",
    "text": "3.1 Axis style\nYou can change the style of the axis texts in the following way:\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width)) +\n  geom_point(aes(color=Species,size=Sepal.Width)) +\n  scale_x_continuous(name = \"Length\", breaks = 1:7) +\n  scale_y_continuous(name = \"Width\", breaks = seq(0,3,0.5)) +\n  theme(axis.text.x = element_text(face=\"bold\", color=\"#993333\", size=14, angle=45), \n        axis.text.y = element_text(face=\"bold\", color=\"#993333\", size=14, angle=45))\n\n\n\n\n\n\n\n\nIt is also possible hide the ticks.\n\nggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width)) +\n  geom_point(aes(color=Species,size=Sepal.Width)) +\n  scale_x_continuous(name = \"Length\", breaks = 1:7) +\n  scale_y_continuous(name = \"Width\", breaks = seq(0,3,0.5)) +\n  theme(axis.text.x = element_text(face=\"bold\", color=\"#993333\", size=14, angle=45), \n        axis.text.y = element_text(face=\"bold\", color=\"#993333\", size=14, angle=45), \n        axis.ticks = element_blank())\n\n\n\n\n\n\n\n\nThere are many things one can use to style the axis and/or axis labels. Just use ?theme() to look for all the different one can use to stylize the plots."
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#different-themes",
    "href": "topics/ggplot/lab_gg2.html#different-themes",
    "title": "Advanced ggplot",
    "section": "3.2 Different themes",
    "text": "3.2 Different themes\nLet’s consider the plot below and save it as an object P for the sake of simplicity.\n\nP &lt;- gc_long %&gt;% \n  group_by(Time, Replicate) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%\n  ggplot(aes(x= Time, y= mean, fill = Replicate)) + \n  geom_col(position = position_dodge2()) +\n  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), position = position_dodge2(.9, padding = .6)) +\n  theme(axis.ticks = element_blank())\nP\n\n\n\n\n\n\n\n\n\n3.2.1 Lighter themes\ntheme_light(), theme_minimal(), theme_classic() and theme_bw() are a couple of themes that are used very often in publications.\n\nP + theme_bw(base_size = 16)\n\n\n\n\n\n\n\n\n\nP + theme_minimal(base_size = 16)\n\n\n\n\n\n\n\n\n\n\n3.2.2 ggthemes package\nLet’s look into some of the fancier themes that comes in this package\n\nQ &lt;- ggplot(data = gc_long, mapping = aes(x = Sample_Name, y = log10(count + 1), fill = Time)) + geom_boxplot()\nQ  \n\n\n\n\n\n\n\n\nUsing the theme_tufte()\n\nlibrary(ggthemes)\nQ + theme_tufte()\n\n\n\n\n\n\n\n\n\nQ + theme_economist() + \n  scale_fill_economist()\n\n\n\n\n\n\n\n\n\nQ + theme_stata() +\n  scale_fill_stata()"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#cowplot",
    "href": "topics/ggplot/lab_gg2.html#cowplot",
    "title": "Advanced ggplot",
    "section": "5.1 Cowplot",
    "text": "5.1 Cowplot\nOne can use the simple plot_grid() function from the cowplot.\n\nlibrary(cowplot)\nplot_grid(p1, p2)\n\n\n\n\n\n\n\n\nYou can also do some simple customizations using nrow or ncol to specify the number of rows and columns and provide labels to those plots as well.\n\nplot_grid(p1, p2, nrow = 2, labels = c(\"A\", \"B\"))"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#ggdraw-and-draw_plot",
    "href": "topics/ggplot/lab_gg2.html#ggdraw-and-draw_plot",
    "title": "Advanced ggplot",
    "section": "5.2 ggdraw and draw_plot",
    "text": "5.2 ggdraw and draw_plot\nIn cowplot, you can also customize the dimensions of the plots in a much more controlled fashion. For this one starts with ggdraw() which initiates the drawing “canvas” followed by draw_plot() that you use to draw the different plots on to the canvas.\nHere is how the dimensions of the empty canvas looks like: \nFrom here, you can draw your plots in the way you want using these dimensions. AN example is shown below, where we plot C and D similar to the plot above:\n\nggdraw() +\n  draw_plot(p3, x = 0, y = 0, width = 1, height = .5) +\n  draw_plot(p4, x = 0, y = .5, width = 1, height = .5) \n\n\n\n\n\n\n\n\nYou can also add “labels” to these figures using draw_plot_label() with the same dimensions.\n\nggdraw() +\n  draw_plot(p3, x = 0, y = 0.5, width = 1, height = .5) +\n  draw_plot(p4, x = 0, y = 0, width = 1, height = .5) +\n  draw_plot_label(label = c(\"A\", \"B\"), size = 15, x = c(0,0), y = c(1, 0.5))\n\n\n\n\n\n\n\n\nIt is easier to draw three (or any odd number) plots in a neat way using this function compared to plot_grid()\n\nggdraw() +\n  draw_plot(p3, x = 0, y = 0.5, width = 0.5, height = 0.5) +\n  draw_plot(p4, x = 0.5, y = 0.5, width = 0.5, height = 0.5) +\n  draw_plot(p2, x = 0, y = 0, width = 1, height = 0.5) +\n  draw_plot_label(label = c(\"A\", \"B\", \"C\"), size = 15, x = c(0,0.5,0), y = c(1, 1,0.5))"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#ggpubr",
    "href": "topics/ggplot/lab_gg2.html#ggpubr",
    "title": "Advanced ggplot",
    "section": "5.3 ggpubr",
    "text": "5.3 ggpubr\nThe package ggpubr comes with quite a few functions that can be very useful to make comprehensive figures. To start with the simple function, let’s start with ggarrange() that is used to put plots together.\n\nlibrary(ggpubr)\nggarrange(p3, p4, labels = c(\"A\", \"B\"), nrow = 2)\n\n\n\n\n\n\n\n\nOne of the nicer things with ggarrange() is that you can automatically have common legends that are shared between the figures.\n\nggarrange(p3, p4, labels = c(\"A\", \"B\"), nrow = 2, common.legend = TRUE, legend = \"right\")"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#mixing-text-and-table-with-figures",
    "href": "topics/ggplot/lab_gg2.html#mixing-text-and-table-with-figures",
    "title": "Advanced ggplot",
    "section": "5.4 Mixing text and table with Figures",
    "text": "5.4 Mixing text and table with Figures\nYou can include tables and even normal texts to any figure using ggtexttable() and ggparagraph(). Let us look into adding a table that we saw in the previous exercise with the gene counts dataset.\n\ngc_table &lt;- gc_long %&gt;% \n  group_by(Time) %&gt;% \n  summarise(mean=mean(log10(count +1)),se=se(log10(count +1)))\n\ntab1 &lt;- ggtexttable(gc_table, rows = NULL, \n                        theme = ttheme(\"mOrange\"))\ngc_text &lt;- paste(\"In the experiment, RNA was extracted at four time points:\", \n                 \"before the gefinitib treatment (t=0), and two, six and twenty-four hours\",\n                 \"after treatment (t=2, t=6, t=24, respectively).\", sep = \" \")\n\ntex1 &lt;- ggparagraph(text = gc_text, face = \"italic\", size = 11, color = \"black\")\n\n\n\n\n\n\n\nNote\n\n\n\nHere, for the text part, paste() has been used just to make it a bit easier to show here in the code. It could be used without the paste() command as well.\n\n\n\nggarrange(ggarrange(p1, p2, nrow = 2, labels = c(\"A\", \"B\"), common.legend = TRUE, legend = \"top\"),\n          ggarrange(tab1, tex1, nrow = 2),\n          ncol = 2,\n          widths = c(2, 1))"
  },
  {
    "objectID": "topics/ggplot/lab_gg2.html#multiple-page",
    "href": "topics/ggplot/lab_gg2.html#multiple-page",
    "title": "Advanced ggplot",
    "section": "5.5 Multiple-page",
    "text": "5.5 Multiple-page\nWith ggarrange() it is also possible to make multiple-page plots. If you are for example making a report of many different figures this can come quite handy. Then you can use ggexport() to export these figures in a multi-page pdf.\n\nmulti.page &lt;- ggarrange(p1, p2, p3, p4,\n                        nrow = 1, ncol = 1)\nggexport(multi.page, filename = \"multi.page.ggplot2.pdf\")\n\n Note   From this multi.page R object (which is of class list) , you can get the indivdual plots by multi.page[[1]], multi.page[[2]] and so on."
  }
]