<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lokesh Mano • 19-Oct-2022" />


<title>ggplot: Part II</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link id="font-awesome-1-attachment" rel="attachment" href="site_libs/font-awesome-5.1.0/fonts/fontawesome-webfont.ttf"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="assets/lab.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
#TOC {
  display: none !important;
}
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div id="header">





<h4 class="author"><b>Lokesh Mano</b> • 19-Oct-2022</h4>

</div>


<!-- rmd lab header -->
<p><br></p>
<p>Now that we have covered the important aspects of <code>ggplot</code>, meaning getting the actual plot you wanted, let us now look into secondary elements of the plot.</p>
<div id="modifying-axes" class="section level1">
<h1><span class="header-section-number">1</span> Modifying Axes</h1>
<div id="breaks" class="section level2">
<h2><span class="header-section-number">1.1</span> Breaks</h2>
<p>If we look at the <code>iris</code> data plot that we made before:</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(color=Sepal.Width))+
  geom_smooth(method=&quot;lm&quot;)</code></pre>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-4-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>The continuous x axis breaks are with 2,4,6 and so on. If we would like to have 1,2,3… We change this using <code>scale_x_continuous()</code> and <code>breaks</code>.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;) +
  scale_x_continuous(breaks = 1:7)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-5-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>You can do the same with <code>y-axis</code>.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;) +
  scale_x_continuous(breaks = 1:7) +
  scale_y_continuous(breaks = seq(0,3,0.5))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-6-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="limits" class="section level2">
<h2><span class="header-section-number">1.2</span> Limits</h2>
<p>By using <code>limits</code>, we can also decide on the parts to plot to be shown:</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species)) +
  geom_smooth(method=&quot;lm&quot;) +
  scale_x_continuous(limits=c(3, 7))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-7-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>We can do the same with discrete x values like in the case of our <code>gene counts</code> dataset.</p>
<pre class="r"><code>gc_long %&gt;% 
  group_by(Time, Replicate) %&gt;% 
  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%
  ggplot(aes(x=Time, y=mean, fill = Replicate)) + 
  geom_col() + 
  scale_x_discrete(limits=c(&quot;t0&quot;,&quot;t24&quot;))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-8-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>One can also use <code>xlim()</code> and <code>ylim()</code> functions that function the same as <code>limits</code> with <code>scale_x_continous()</code> or <code>scale_x_discrete()</code></p>
</div>
<div id="names" class="section level2">
<h2><span class="header-section-number">1.3</span> Names</h2>
<p>You can also customize the axis labels using the <code>name</code> option within <code>scale_x_continous</code> and <code>scale_y_continous</code>.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;) +
  scale_x_continuous(name = &quot;Length&quot;, breaks = 1:7) +
  scale_y_continuous(name = &quot;Width&quot;, breaks = seq(0,3,0.5))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-9-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>with <code>labels</code> in combination with the <code>scales</code> package, one can change or make the unit of the axis look more comprehensible, when needed. Like using <code>percentage</code> option or <code>scientific</code> option.</p>
<pre class="r"><code>library(scales)
ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;) +
  scale_y_continuous(name = &quot;Width&quot;, breaks = seq(0,3,0.5), labels = scientific)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-10-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
</div>
<div id="legends" class="section level1">
<h1><span class="header-section-number">2</span> Legends</h1>
<p>There are many ways to control the legends, below are some of the examples:
First by using <code>guides()</code> function.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(color=Species,size=Sepal.Width))+
  guides(size=&quot;none&quot;)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-11-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>We can also turn off legends by geom.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(color=Species,size=Sepal.Width),show.legend=FALSE)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-12-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<div id="editing-legends" class="section level2">
<h2><span class="header-section-number">2.1</span> Editing legends</h2>
<p>The legends can be edited by <code>scale_&lt;aesthetic&gt;_&lt;discrete or continous&gt;</code> function that we have been using. Take the below figure for example, we have the <code>Sepal.Width</code> and the <code>Species</code> with the <code>size</code> and <code>color</code> aestheitcs respectively.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;)</code></pre>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-13-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Let’s try to edit the legends here like mentioned before:</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(size=Sepal.Width, color=Species))+
  geom_smooth(method=&quot;lm&quot;) +
  scale_size_continuous(name = &quot;Width of Sepal&quot;) +
  scale_color_discrete(name = &quot;Organism&quot;, labels = c(&quot;Iris setosa&quot;, &quot;Iris versicolor&quot;, &quot;Iris virginica&quot;))</code></pre>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-14-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</div>
<div id="moving-legends" class="section level2">
<h2><span class="header-section-number">2.2</span> Moving legends</h2>
<p>Legends can be moved around using theme.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(color=Species,size=Sepal.Width)) +
  theme(legend.position=&quot;top&quot;,
        legend.justification=&quot;right&quot;)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-15-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>Legend rows can be controlled in a finer manner.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width))+
  geom_point(aes(color=Species,size=Sepal.Width))+
  guides(size=guide_legend(nrow=2,byrow=TRUE),
         color=guide_legend(nrow=3,byrow=T))+
  theme(legend.position=&quot;top&quot;,
        legend.justification=&quot;right&quot;)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-16-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
</div>
<div id="themes" class="section level1">
<h1><span class="header-section-number">3</span> Themes</h1>
<p>Now that we started into <code>theme()</code>, it is possible to much more editing of the plot with this function. Let us look into some of the parameters that would be very helpful to work with.</p>
<div id="axis-style" class="section level2">
<h2><span class="header-section-number">3.1</span> Axis style</h2>
<p>You can change the style of the axis texts in the following way:</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width)) +
  geom_point(aes(color=Species,size=Sepal.Width)) +
  scale_x_continuous(name = &quot;Length&quot;, breaks = 1:7) +
  scale_y_continuous(name = &quot;Width&quot;, breaks = seq(0,3,0.5)) +
  theme(axis.text.x = element_text(face=&quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle=45), 
        axis.text.y = element_text(face=&quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle=45))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-17-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>It is also possible hide the <code>ticks</code>.</p>
<pre class="r"><code>ggplot(data=iris,mapping=aes(x=Petal.Length,y=Petal.Width)) +
  geom_point(aes(color=Species,size=Sepal.Width)) +
  scale_x_continuous(name = &quot;Length&quot;, breaks = 1:7) +
  scale_y_continuous(name = &quot;Width&quot;, breaks = seq(0,3,0.5)) +
  theme(axis.text.x = element_text(face=&quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle=45), 
        axis.text.y = element_text(face=&quot;bold&quot;, color=&quot;#993333&quot;, size=14, angle=45), 
        axis.ticks = element_blank())</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-18-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>There are many things one can use to style the axis and/or axis labels. Just use <code>?theme()</code> to look for all the different one can use to stylize the plots.</p>
</div>
<div id="different-themes" class="section level2">
<h2><span class="header-section-number">3.2</span> Different themes</h2>
<p>Let’s consider the plot below and save it as an object <code>P</code> for the sake of simplicity.</p>
<pre class="r"><code>P &lt;- gc_long %&gt;% 
  group_by(Time, Replicate) %&gt;% 
  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%
  ggplot(aes(x= Time, y= mean, fill = Replicate)) + 
  geom_col(position = position_dodge2()) +
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), position = position_dodge2(.9, padding = .6)) +
  theme(axis.ticks = element_blank())
P</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-19-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<div id="lighter-themes" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Lighter themes</h3>
<p><code>theme_light()</code>, <code>theme_minimal()</code>, <code>theme_classic()</code> and <code>theme_bw()</code> are a couple of themes that are used very often in publications.</p>
<pre class="r"><code>P + theme_bw(base_size = 16)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-20-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<pre class="r"><code>P + theme_minimal(base_size = 16)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-21-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="ggthemes-package" class="section level3">
<h3><span class="header-section-number">3.2.2</span> ggthemes package</h3>
<p>Let’s look into some of the fancier themes that comes in this package</p>
<pre class="r"><code>Q &lt;- ggplot(data = gc_long, mapping = aes(x = Sample_Name, y = log10(count + 1), fill = Time)) + geom_boxplot()
Q  </code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-22-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>Using the <code>theme_tufte()</code></p>
<pre class="r"><code>library(ggthemes)
Q + theme_tufte()</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-23-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<pre class="r"><code>Q + theme_economist() + 
  scale_color_economist()</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-24-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<pre class="r"><code>Q + theme_stata() +
  scale_color_stata()</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-25-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
</div>
</div>
<div id="exercise-i" class="section level1">
<h1><span class="header-section-number">4</span> Exercise I</h1>
<p><i class="fas fa-clipboard-list"></i> Task   Try to replicate the plot below if you have enough time.</p>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-26-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p><i class="fas fa-lightbulb"></i> Tip: 1   <code>geom_line()</code> is a bit tricky when you use it together with <code>groups</code>. It tries to draw lines within the group. In this case, if you would like to draw lines between the groups (like in the above plot, between <code>t0</code> through <code>t2</code> to <code>t24</code>), you initate the ggplot with aesthetics for the line and add <code>geom_line(aes(group=1))</code> this way.</p>
<p><i class="fas fa-lightbulb"></i> Tip: 2   This figure has <code>theme_light()</code></p>
</div>
<div id="cowplot" class="section level1">
<h1><span class="header-section-number">5</span> Cowplot</h1>
<p>In this chapter, we will mainly focus on making a “publication-type” figure, with sub-plots and such using different tools in R. There are many different ways/packages to do this, but we will mainly focus on 2 packages: <code>cowplot</code> and <code>ggpubr</code>.</p>
<p>Now let us consider some of the plots we have made so far in the previous exercises. From the picture below, <strong>A</strong> and <strong>B</strong> are the figures that was made from the <code>gene counts</code> dataset and the figures <strong>C</strong> and <strong>D</strong> are using the <code>Sepal.Length</code> and <code>Sepal.Width</code> from the <code>iris</code> data. Now let us look into how we can combine each of the figures like it is shown here.</p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-27-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>Now, let us go step by step. First let us make these plots into R objects. This will make things a lot easier.</p>
<pre class="r"><code>p1 &lt;- gc_long %&gt;% 
  group_by(Time, Replicate) %&gt;% 
  summarise(mean=mean(log10(count +1)),se=se(log10(count +1))) %&gt;%
  ggplot(aes(x= Time, y= mean, fill = Replicate)) + 
  geom_col(position = position_dodge2()) +
  geom_errorbar(aes(ymin=mean-se, ymax=mean+se), position = position_dodge2(.9, padding = .6)) +
  ylab(&quot;mean(log10(count+1))&quot;) +
  theme(axis.ticks = element_blank()) +
  theme_bw(base_size = 10)

p2 &lt;- ggplot(data = gc_long) +
  geom_boxplot(mapping = aes(x = Sample_Name, y = log10(count + 1), fill = Replicate)) +
  facet_grid(~Time , scales = &quot;free&quot;, space = &quot;free&quot;) +
  xlab(&quot;Time&quot;) +
  theme_bw(base_size = 10) +
  theme(axis.ticks.x = element_blank(), axis.text.x = element_blank())

p3 &lt;- ggplot(data=iris,mapping=aes(x=Sepal.Length))+
  geom_density(aes(fill = Species), alpha = 0.6) +
  theme_light(base_size = 10)

p4 &lt;- ggplot(data=iris,mapping=aes(x=Sepal.Length, y = Sepal.Width, color = Species)) +
  geom_point(size = 3, alpha = 0.6) +
  theme_light(base_size = 10)</code></pre>
<p>The objects <code>p1</code>, <code>p2</code>, <code>p3</code> and <code>p4</code> as intuitively represent the plots <strong>A</strong>, <strong>B</strong>, <strong>C</strong> and <strong>D</strong> repectively.</p>
<div id="plot_grid" class="section level2">
<h2><span class="header-section-number">5.1</span> plot_grid</h2>
<p>One can use the simple <code>plot_grid()</code> function from the <code>cowplot</code>.</p>
<pre class="r"><code>library(cowplot)
plot_grid(p1, p2)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-29-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>You can also do some simple customizations using <code>nrow</code> or <code>ncol</code> to specify the number of rows and columns and provide <code>labels</code> to those plots as well.</p>
<pre class="r"><code>plot_grid(p1, p2, nrow = 2, labels = c(&quot;A&quot;, &quot;B&quot;))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-30-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="ggdraw-and-draw_plot" class="section level2">
<h2><span class="header-section-number">5.2</span> ggdraw and draw_plot</h2>
<p>In <code>cowplot</code>, you can also customize the dimentions of the plots in a much more controlled fashion. For this one starts with <code>ggdraw()</code> which initiates the drawing “canvas” followed by <code>draw_plot()</code> that you use to draw the different plots on to the canvas.</p>
<p>Here is how the dimentions of the empty canvas looks like:
<img src="assets/images/canva.png" /></p>
<p>From here, you can draw your plots in the way you want using these dimensions. AN example is shown below, where we plot <strong>C</strong> and <strong>D</strong> similar to the plot above:</p>
<pre class="r"><code>ggdraw() +
  draw_plot(p3, x = 0, y = 0, width = 1, height = .5) +
  draw_plot(p4, x = 0, y = .5, width = 1, height = .5) </code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-31-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>You can also add “labels” to these figures using <code>draw_plot_label()</code> with the same dimensions.</p>
<pre class="r"><code>ggdraw() +
  draw_plot(p3, x = 0, y = 0.5, width = 1, height = .5) +
  draw_plot(p4, x = 0, y = 0, width = 1, height = .5) +
  draw_plot_label(label = c(&quot;A&quot;, &quot;B&quot;), size = 15, x = c(0,0), y = c(1, 0.5))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-32-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>It is easier to draw three (or any odd number) plots in a neat way using this function compared to <code>plot_grid()</code></p>
<pre class="r"><code>ggdraw() +
  draw_plot(p3, x = 0, y = 0.5, width = 0.5, height = 0.5) +
  draw_plot(p4, x = 0.5, y = 0.5, width = 0.5, height = 0.5) +
  draw_plot(p2, x = 0, y = 0, width = 1, height = 0.5) +
  draw_plot_label(label = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), size = 15, x = c(0,0.5,0), y = c(1, 1,0.5))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-33-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
</div>
<div id="ggpubr" class="section level1">
<h1><span class="header-section-number">6</span> ggpubr</h1>
<div id="ggarrange" class="section level2">
<h2><span class="header-section-number">6.1</span> ggarrange</h2>
<p>The package <code>ggpubr</code> comes with quite a few functions that can be very useful to make comprehensive figures. To start with the simple function, let’s start with <code>ggarrange()</code> that is used to put plots together.</p>
<pre class="r"><code>library(ggpubr)
ggarrange(p3, p4, labels = c(&quot;A&quot;, &quot;B&quot;), nrow = 2)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-34-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>One of the nicer things with <code>ggarrange()</code> is that you can automatically have common legends that are shared between the figures.</p>
<pre class="r"><code>ggarrange(p3, p4, labels = c(&quot;A&quot;, &quot;B&quot;), nrow = 2, common.legend = TRUE, legend = &quot;right&quot;)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-35-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="mixing-text-and-table-with-figures" class="section level2">
<h2><span class="header-section-number">6.2</span> Mixing text and table with Figures</h2>
<p>You can include tables and even normal texts to any figure using <code>ggtexttable()</code> and <code>ggparagraph()</code>. Let us look into adding a table that we saw in the previous exercise with the <code>gene counts</code> dataset.</p>
<pre class="r"><code>gc_table &lt;- gc_long %&gt;% 
  group_by(Time) %&gt;% 
  summarise(mean=mean(log10(count +1)),se=se(log10(count +1)))

tab1 &lt;- ggtexttable(gc_table, rows = NULL, 
                        theme = ttheme(&quot;mOrange&quot;))
gc_text &lt;- paste(&quot;In the experiment, RNA was extracted at four time points:&quot;, 
                 &quot;before the gefinitib treatment (t=0), and two, six and twenty-four hours&quot;,
                 &quot;after treatment (t=2, t=6, t=24, respectively).&quot;, sep = &quot; &quot;)

tex1 &lt;- ggparagraph(text = gc_text, face = &quot;italic&quot;, size = 11, color = &quot;black&quot;)</code></pre>
<p><i class="fas fa-exclamation-circle"></i> Note   Here, for the <code>text</code> part, <code>paste()</code> has been used just to make it a bit easier to show here in the code. It could be used without the <code>paste()</code> command as well.</p>
<pre class="r"><code>ggarrange(ggarrange(p1, p2, nrow = 2, labels = c(&quot;A&quot;, &quot;B&quot;), common.legend = TRUE, legend = &quot;top&quot;),
          ggarrange(tab1, tex1, nrow = 2),
          ncol = 2,
          widths = c(2, 1))</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-37-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="multiple-page" class="section level2">
<h2><span class="header-section-number">6.3</span> Multiple-page</h2>
<p>With <code>ggarrange()</code> it is also possible to make multiple-page plots. If you are for example making a report of many different figures this can come quite handy. Then you can use <code>ggexport()</code> to export these figures in a multi-page <code>pdf</code>.</p>
<pre class="r"><code>multi.page &lt;- ggarrange(p1, p2, p3, p4,
                        nrow = 1, ncol = 1)
ggexport(multi.page, filename = &quot;multi.page.ggplot2.pdf&quot;)</code></pre>
<p><i class="fas fa-exclamation-circle"></i> Note   From this <code>multi.page</code> R object (which is of class list) , you can get the indivdual plots by <code>multi.page[[1]]</code>, <code>multi.page[[2]]</code> and so on.</p>
</div>
</div>
<div id="adding-images-to-plots" class="section level1">
<h1><span class="header-section-number">7</span> Adding images to plots</h1>
<p>Let us you have a microscopic image in <code>jpeg</code> or <code>png</code> that you want to add to a normal <code>ggplot</code> plot that you have made from the data.</p>
<p>Let’s take for example the RBC cluster from a SEM that is in <code>data/Blood_Cells_Image.jpeg</code>:</p>
<p><img src="data/Blood_Cells_Image.jpeg" /></p>
<p>Let us take the following plot that you want to add the image to:</p>
<pre class="r"><code>x &lt;- 1:10
y &lt;- x*abs(rnorm(10))
p1 &lt;- ggplot(data.frame(x,y), mapping=aes(x=x,y=y)) + geom_point() + geom_smooth() + ggtitle(&quot;The Title&quot;) + theme(title=element_text(size=14, hjust=0.5), axis.title=element_text(size=10), axis.text = element_text(size=6))
p1</code></pre>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-39-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p>For this first you need to convert the image into a grid object (<code>grob</code>). For this we need a couple of packages <code>grid</code> and <code>jpeg</code> to be able to convert the image into a grid object! We will use the functions <code>readJPEG</code> and <code>rasterGrob</code> from these packages.</p>
<pre class="r"><code>library(grid)
library(jpeg)
cells_jpg=readJPEG(&quot;data/Blood_Cells_Image.jpeg&quot;)
p2 &lt;- rasterGrob(cells_jpg)</code></pre>
<p>Now, we can use the <code>grid.arrange()</code> function to plot the grob objects and the ggplot objects.</p>
<pre class="r"><code>library(gridExtra)
grid.arrange(p1,p2,nrow=1)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-41-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p>We can also use the <code>annotation_custom</code> to place the image in a particular position of the plot!</p>
<pre class="r"><code>p3 &lt;- p1 + annotation_custom(rasterGrob(cells_jpg, width = 0.2),
                    ymin = 10)
p3</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-42-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="exercise-ii" class="section level1">
<h1><span class="header-section-number">8</span> Exercise II</h1>
<p><i class="fas fa-clipboard-list"></i> Task   For the exercise in this session, let us look into way of using the tools available for combining plots to make one plot that could be very comprehensive. Try to code the figure below:</p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-43-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
<p><i class="fas fa-lightbulb"></i> Tip: 1   Within <code>ggarrange()</code>, it is possible to adjust the dimension of each plot with <code>widths</code> and <code>heights</code> options.</p>
<p><i class="fas fa-lightbulb"></i> Tip: 2   You can plot an empty plot with <code>NULL</code>.</p>
</div>
<div id="pca" class="section level1">
<h1><span class="header-section-number">9</span> PCA</h1>
<p>Let us first make a PCA object. For this, we will use the <code>VST</code> data, because it makes sense to use the normalized data for building the PCA. To run PCA, we use the R function <code>prcomp()</code>. It takes in a matrix where samples are rows and variables are columns. Therefore, we transpose our count matrix using the function <code>t()</code>. If we do not transpose, then PCA is run on the genes rather than the samples.</p>
<pre class="r"><code>gc_vst &lt;- read.table(&quot;data/counts_vst.txt&quot;, header = T, row.names = 1, sep = &quot;\t&quot;)
vst_pca &lt;- prcomp(t(gc_vst))</code></pre>
<p>After you computer the PCA, if you type the object <code>vst_pca$</code> and press <code>TAB</code>, you will notice that this R object has multiple vecors and data.frames within it. Some of the important ones are</p>
<ul>
<li><code>sdev:</code> the standard deviations of the principal components</li>
<li><code>x:</code> the coordinates of the samples (observations) on the principal components.</li>
<li><code>rotation:</code> the matrix of variable loadings (columns are eigenvectors).</li>
</ul>
<p><i class="fas fa-exclamation-circle"></i> Note   There are quite a few functions in R from different packages that can run PCA. So, one should look into the structure of the PCA object and import it into <code>ggplot</code> accordingly!</p>
<div id="variance-of-components-scree-plot" class="section level2">
<h2><span class="header-section-number">9.1</span> Variance of components (Scree plot)</h2>
<p>First, let us look into plotting the variance explained by the top PCs.</p>
<pre class="r"><code>frac_var &lt;- function(x) x^2/sum(x^2)
library(scales)

vst_pca$sdev %&gt;% 
  as_tibble() %&gt;% 
  frac_var() %&gt;% 
  mutate(Comp = colnames(vst_pca$x)) %&gt;% 
  slice(1:9) %&gt;% 
  ggplot(aes(x=Comp, y = value)) + 
  geom_bar(stat = &quot;identity&quot;, fill = &quot;#4DC5F9&quot;) +
  geom_hline(yintercept = 0.03, linetype=2) +
  xlab(&quot;Principal Components&quot;) +
  scale_y_continuous(name = &quot;Variance Explained&quot;, breaks = seq(0,0.8,0.1), labels = percent_format(accuracy = 5L)) +
  theme_classic(base_size = 14)</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-45-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="pca-plot" class="section level2">
<h2><span class="header-section-number">9.2</span> PCA plot</h2>
<p>So, looks like the first two components explain almost 85% of the data. Now, let us look into building a plot out of these components. From the above object, to get the scatter plot for the samples, we need to look into <code>vst_pca$x</code>. Then, we combine this data (as shown below) with the metadata to use different aesthetics and colors on the plot.</p>
<pre class="r"><code>vst_pca$x</code></pre>
<details>
<p><summary>output</summary></p>
<pre><code>##                  PC1        PC2        PC3         PC4       PC5         PC6
## Sample_1  -34.641623 -13.435531   6.486032  -0.2742477 -6.406502   5.6703279
## Sample_2  -35.431333 -13.277983   5.171377  -0.3540945 -3.953216   6.9974341
## Sample_3  -35.938795 -14.544994   2.885351 -11.3414829  5.950082 -10.8497916
## Sample_4  -20.672358   3.962013  -1.414301  10.4819194 -0.195882  -2.8003847
## Sample_5  -21.155503   1.390981  -6.644132   7.4002617  6.505502   0.9771040
## Sample_6  -22.662075   1.115504  -9.801356   6.3107519  7.431833   0.6592987
## Sample_7    1.862762  24.449057  12.865650  -4.4029501  5.822040   4.1873901
## Sample_8   -5.909698  13.992629 -14.775686 -10.9789567 -8.967097   2.2612207
## Sample_9   -3.233544  17.321871   5.196746   2.5142966 -6.983077  -7.2580550
## Sample_10  60.630406  -5.930071   6.993097   5.7393184 -4.254238  -2.6905179
## Sample_11  56.669696 -10.638879  -5.860598   0.4646609 -5.216763  -1.3748865
## Sample_12  60.482067  -4.404596  -1.102179  -5.5594769 10.267317   4.2208603
##                  PC7        PC8        PC9       PC10       PC11         PC12
## Sample_1  -7.6896364  7.5508580 -1.1936551 -0.2382806 -0.7901002 6.418477e-15
## Sample_2   5.8962070 -9.0662471 -1.0449651  0.2284545  1.3982703 1.526557e-15
## Sample_3   1.4353811  0.7461021  1.4769949  0.2114041 -0.5247079 4.045375e-15
## Sample_4   1.2992058  2.3863551  6.1089574 -0.1510797  9.1851796 3.588969e-14
## Sample_5  -2.7487548 -2.7353990  4.5686381 -6.6024251 -6.9911571 5.848273e-14
## Sample_6   2.1391551  2.3567136 -7.7925047  6.9400619 -1.3499685 4.436035e-14
## Sample_7   5.2166866  4.0805978  0.2292610 -1.4574679 -1.2200771 4.266032e-14
## Sample_8  -0.1684735 -0.1448735  3.9822133  2.5610601 -0.5182664 5.483808e-14
## Sample_9  -5.4663572 -5.2056738 -6.4295279 -1.6062665  0.5133496 4.941880e-14
## Sample_10  0.8277618 -0.5767198  4.9156730  6.8596253 -4.8748004 4.991840e-14
## Sample_11  5.8886122  3.9566331 -4.4374522 -6.9835771  0.4457707 1.114872e-13
## Sample_12 -6.6297877 -3.3483466 -0.3836326  0.2384911  4.7265074 9.376180e-14</code></pre>
</details>
<p>And, if you check the <code>class()</code> of this object, you will realize that this is a <code>matrix</code>. To be able to comfortably use <code>tidyverse</code> on this object, we must first convert this to a <code>data.frame</code>.</p>
<pre class="r"><code>vst_pca_all &lt;- vst_pca$x %&gt;%
  as.data.frame() %&gt;%
  rownames_to_column(var = &quot;Sample_ID&quot;) %&gt;%
  full_join(md, by = &quot;Sample_ID&quot;)

# Just to keep the order the right way.
vst_pca_all$Sample_Name &lt;- factor(vst_pca_all$Sample_Name, levels = c(&quot;t0_A&quot;,&quot;t0_B&quot;,&quot;t0_C&quot;,&quot;t2_A&quot;,&quot;t2_B&quot;,&quot;t2_C&quot;,&quot;t6_A&quot;,&quot;t6_B&quot;,&quot;t6_C&quot;,&quot;t24_A&quot;,&quot;t24_B&quot;,&quot;t24_C&quot;))
vst_pca_all$Time &lt;- factor(vst_pca_all$Time, levels = c(&quot;t0&quot;,&quot;t2&quot;,&quot;t6&quot;,&quot;t24&quot;))
vst_pca_all$Replicate &lt;- factor(vst_pca_all$Replicate, levels = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;))

ggplot(vst_pca_all, aes(x=PC1, y=PC2, color = Time)) +
  geom_point(size = 3, aes(shape = Replicate)) +
  geom_vline(xintercept = 0, linetype=2) +
  geom_hline(yintercept = 0, linetype=2) +
  theme_bw() +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank()) </code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-47-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
<div id="loading-plot" class="section level2">
<h2><span class="header-section-number">9.3</span> Loading plot</h2>
<p>Now, let us say you want to plot the four genes that contribute the most to the four directions in the PCA plot. We could obtain them by looking at the <code>vst_pca$rotation</code> matrix. We could get those genes and their respective coordinates as follows.</p>
<pre class="r"><code>genes.selected=vst_pca$rotation[c(which.max(vst_pca$rotation[,&quot;PC1&quot;]), which.min(vst_pca$rotation[,&quot;PC1&quot;]), which.max(vst_pca$rotation[,&quot;PC2&quot;]), which.min(vst_pca$rotation[,&quot;PC2&quot;])),c(&quot;PC1&quot;,&quot;PC2&quot;)]
genes.selected &lt;- genes.selected %&gt;%
  as.data.frame() %&gt;%
  rownames_to_column(var = &quot;Gene_ID&quot;)
genes.selected</code></pre>
<details>
<p><summary>output</summary></p>
<pre><code>##           Gene_ID         PC1         PC2
## 1 ENSG00000204941  0.05737805 -0.02981714
## 2 ENSG00000175592 -0.04640560 -0.03986039
## 3 ENSG00000156804  0.01143268  0.03864008
## 4 ENSG00000120738  0.01010573 -0.05681563</code></pre>
</details>
<p>A loading plot shows how strongly each variable (gene) influences a principal component. As an example, we could plot the four genes we selected.</p>
<pre class="r"><code>ggplot(genes.selected, aes(x=PC1, y=PC2)) +
  geom_point() +
  geom_segment(aes(xend=PC1, yend=PC2), x=0, y=0, color=&quot;Grey&quot;) +
  geom_label(aes(x=PC1, y=PC2, label=Gene_ID), size=2, vjust=&quot;outward&quot;) +
  theme_bw() +
  theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank()) </code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-49-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
</div>
</div>
<div id="pca-bi-plot" class="section level1">
<h1><span class="header-section-number">10</span> PCA bi-plot</h1>
<p>By merging the PCA plot with the loadings plot one can create a so-called PCA bi-plot.</p>
<pre class="r"><code>scale=500
ggplot(data=vst_pca_all, mapping=aes(x=PC1, y=PC2)) +
     geom_point(size = 3, aes(shape = Replicate, color = Time)) +
     geom_vline(xintercept = 0, linetype=2) +
     geom_hline(yintercept = 0, linetype=2) +
     geom_segment(data=genes.selected, mapping=aes(xend=scale*PC1,yend=scale*PC2), x=0, y=0, arrow=arrow(), color=&quot;grey&quot;) +
     geom_label(data=genes.selected, mapping=aes(x=scale*PC1,y=scale*PC2, label=Gene_ID), size=2, hjust=&quot;outward&quot;, vjust=&quot;outward&quot;) +
     theme_bw() +
     theme(panel.grid.major = element_blank(),  panel.grid.minor = element_blank())</code></pre>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-50-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p><i class="fas fa-exclamation-circle"></i> Note   Similarly, let us say, you have environmental variables (continous variables like pH and so on) from the same samples and you would like to see how they would fit this bi-plot. One can use <code>envfit()</code> function from the <code>vegan</code> package, this function would return both the <code>p-value</code> and the <code>coordinates</code> of each of the variables in your environmental matrix. Then you could subset the significant variables and plot them in the same way as above.</p>
</div>
<div id="exercise-iii" class="section level1">
<h1><span class="header-section-number">11</span> Exercise III</h1>
<p>Now, as I have mentioned earlier, building a plot similar to PCA really depends on how the object looks like. Now, let us try to make a <code>MDS</code> or <code>PCoA</code> plot from the same data as we have used. Here is how you get the MDS object in R.</p>
<pre class="r"><code>gc_dist &lt;- dist(t(gc_vst))
gc_mds &lt;- cmdscale(gc_dist,eig=TRUE, k=2) </code></pre>
<p><i class="fas fa-clipboard-list"></i> Task   Now, try to replicate the example <code>MDS</code> plot below if you have enough time.</p>
<details>
<p><summary>plot</summary></p>
<p><img src="lab_gg_p2_files/figure-html/unnamed-chunk-52-1.svg" width="672" style="display: block; margin: auto auto auto 0;" /></p>
</details>
<p><i class="fas fa-clipboard-list"></i> Hint   The mds object <code>gc_mds</code> has “eigenvalues”. You can calculate the variance by <code>Variance &lt;- Eigenvalues / sum(Eigenvalues)</code></p>
</div>
<div id="session-info" class="section level1">
<h1><span class="header-section-number">12</span> Session info</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>## R version 4.1.3 (2022-03-10)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.6 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas/libblas.so.3
## LAPACK: /usr/lib/x86_64-linux-gnu/libopenblasp-r0.2.20.so
## 
## locale:
##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] gridExtra_2.3          jpeg_0.1-9             ggpubr_0.4.0          
##  [4] cowplot_1.1.1          ggthemes_4.2.4         scales_1.2.1          
##  [7] forcats_0.5.2          stringr_1.4.1          purrr_0.3.5           
## [10] readr_2.1.3            tidyr_1.2.1            tibble_3.1.8          
## [13] tidyverse_1.3.2        reshape2_1.4.4         ggplot2_3.3.6         
## [16] formattable_0.2.1      kableExtra_1.3.4       dplyr_1.0.10          
## [19] lubridate_1.8.0        leaflet_2.1.1          yaml_2.3.5            
## [22] fontawesome_0.3.0.9000 captioner_2.2.3        bookdown_0.29         
## [25] knitr_1.40            
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-155        fs_1.5.2            webshot_0.5.4      
##  [4] httr_1.4.4          tools_4.1.3         backports_1.4.1    
##  [7] bslib_0.4.0         utf8_1.2.2          R6_2.5.1           
## [10] DBI_1.1.3           mgcv_1.8-39         colorspace_2.0-3   
## [13] withr_2.5.0         tidyselect_1.2.0    compiler_4.1.3     
## [16] cli_3.4.1           rvest_1.0.3         xml2_1.3.3         
## [19] labeling_0.4.2      sass_0.4.2          systemfonts_1.0.4  
## [22] digest_0.6.29       rmarkdown_2.17      svglite_2.1.0      
## [25] pkgconfig_2.0.3     htmltools_0.5.3     dbplyr_2.2.1       
## [28] fastmap_1.1.0       highr_0.9           htmlwidgets_1.5.4  
## [31] rlang_1.0.6         readxl_1.4.1        rstudioapi_0.14    
## [34] jquerylib_0.1.4     generics_0.1.3      farver_2.1.1       
## [37] jsonlite_1.8.2      crosstalk_1.2.0     car_3.1-0          
## [40] googlesheets4_1.0.1 magrittr_2.0.3      Matrix_1.5-1       
## [43] Rcpp_1.0.9          munsell_0.5.0       fansi_1.0.3        
## [46] abind_1.4-5         lifecycle_1.0.3     stringi_1.7.8      
## [49] carData_3.0-5       plyr_1.8.7          crayon_1.5.2       
## [52] lattice_0.20-45     haven_2.5.1         splines_4.1.3      
## [55] hms_1.1.2           pillar_1.8.1        ggsignif_0.6.3     
## [58] reprex_2.0.2        glue_1.6.2          evaluate_0.17      
## [61] modelr_0.1.9        vctrs_0.4.2         tzdb_0.3.0         
## [64] cellranger_1.1.0    gtable_0.3.1        assertthat_0.2.1   
## [67] cachem_1.0.6        xfun_0.33           broom_1.0.1        
## [70] rstatix_0.7.0       googledrive_2.0.0   viridisLite_0.4.1  
## [73] gargle_1.2.1        ellipsis_0.3.2</code></pre>
<hr />
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
